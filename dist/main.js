var PIOPIY = function ( e ) { var t = {}; function n ( r ) { if ( t[r] ) return t[r].exports; var i = t[r] = { i: r, l: !1, exports: {} }; return e[r].call( i.exports, i, i.exports, n ), i.l = !0, i.exports } return n.m = e, n.c = t, n.d = function ( e, t, r ) { n.o( e, t ) || Object.defineProperty( e, t, { enumerable: !0, get: r } ) }, n.r = function ( e ) { "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty( e, Symbol.toStringTag, { value: "Module" } ), Object.defineProperty( e, "__esModule", { value: !0 } ) }, n.t = function ( e, t ) { if ( 1 & t && ( e = n( e ) ), 8 & t ) return e; if ( 4 & t && "object" == typeof e && e && e.__esModule ) return e; var r = Object.create( null ); if ( n.r( r ), Object.defineProperty( r, "default", { enumerable: !0, value: e } ), 2 & t && "string" != typeof e ) for ( var i in e ) n.d( r, i, function ( t ) { return e[t] }.bind( null, i ) ); return r }, n.n = function ( e ) { var t = e && e.__esModule ? function () { return e.default } : function () { return e }; return n.d( t, "a", t ), t }, n.o = function ( e, t ) { return Object.prototype.hasOwnProperty.call( e, t ) }, n.p = "", n( n.s = 3 ) }( [function ( e, t, n ) {
    ( function ( e, r ) {
        var i;
        ( function () { var o = "Expected a function", s = "__lodash_placeholder__", u = [["ary", 128], ["bind", 1], ["bindKey", 2], ["curry", 8], ["curryRight", 16], ["flip", 512], ["partial", 32], ["partialRight", 64], ["rearg", 256]], l = "[object Arguments]", a = "[object Array]", c = "[object Boolean]", f = "[object Date]", h = "[object Error]", d = "[object Function]", _ = "[object GeneratorFunction]", p = "[object Map]", v = "[object Number]", m = "[object Object]", g = "[object RegExp]", y = "[object Set]", T = "[object String]", C = "[object Symbol]", b = "[object WeakMap]", E = "[object ArrayBuffer]", S = "[object DataView]", A = "[object Float32Array]", w = "[object Float64Array]", R = "[object Int8Array]", I = "[object Int16Array]", O = "[object Int32Array]", k = "[object Uint8Array]", x = "[object Uint16Array]", N = "[object Uint32Array]", P = /\b__p \+= '';/g, U = /\b(__p \+=) '' \+/g, D = /(__e\(.*?\)|\b__t\)) \+\n'';/g, L = /&(?:amp|lt|gt|quot|#39);/g, M = /[&<>"']/g, q = RegExp( L.source ), H = RegExp( M.source ), F = /<%-([\s\S]+?)%>/g, j = /<%([\s\S]+?)%>/g, G = /<%=([\s\S]+?)%>/g, W = /\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/, B = /^\w*$/, Y = /[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g, z = /[\\^$.*+?()[\]{}|]/g, V = RegExp( z.source ), K = /^\s+|\s+$/g, $ = /^\s+/, J = /\s+$/, X = /\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/, Q = /\{\n\/\* \[wrapped with (.+)\] \*/, Z = /,? & /, ee = /[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g, te = /\\(\\)?/g, ne = /\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g, re = /\w*$/, ie = /^[-+]0x[0-9a-f]+$/i, oe = /^0b[01]+$/i, se = /^\[object .+?Constructor\]$/, ue = /^0o[0-7]+$/i, le = /^(?:0|[1-9]\d*)$/, ae = /[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g, ce = /($^)/, fe = /['\n\r\u2028\u2029\\]/g, he = "\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff", de = "\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000", _e = "[\\ud800-\\udfff]", pe = "[" + de + "]", ve = "[" + he + "]", me = "\\d+", ge = "[\\u2700-\\u27bf]", ye = "[a-z\\xdf-\\xf6\\xf8-\\xff]", Te = "[^\\ud800-\\udfff" + de + me + "\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]", Ce = "\\ud83c[\\udffb-\\udfff]", be = "[^\\ud800-\\udfff]", Ee = "(?:\\ud83c[\\udde6-\\uddff]){2}", Se = "[\\ud800-\\udbff][\\udc00-\\udfff]", Ae = "[A-Z\\xc0-\\xd6\\xd8-\\xde]", we = "(?:" + ye + "|" + Te + ")", Re = "(?:" + Ae + "|" + Te + ")", Ie = "(?:" + ve + "|" + Ce + ")" + "?", Oe = "[\\ufe0e\\ufe0f]?" + Ie + ( "(?:\\u200d(?:" + [be, Ee, Se].join( "|" ) + ")[\\ufe0e\\ufe0f]?" + Ie + ")*" ), ke = "(?:" + [ge, Ee, Se].join( "|" ) + ")" + Oe, xe = "(?:" + [be + ve + "?", ve, Ee, Se, _e].join( "|" ) + ")", Ne = RegExp( "['’]", "g" ), Pe = RegExp( ve, "g" ), Ue = RegExp( Ce + "(?=" + Ce + ")|" + xe + Oe, "g" ), De = RegExp( [Ae + "?" + ye + "+(?:['’](?:d|ll|m|re|s|t|ve))?(?=" + [pe, Ae, "$"].join( "|" ) + ")", Re + "+(?:['’](?:D|LL|M|RE|S|T|VE))?(?=" + [pe, Ae + we, "$"].join( "|" ) + ")", Ae + "?" + we + "+(?:['’](?:d|ll|m|re|s|t|ve))?", Ae + "+(?:['’](?:D|LL|M|RE|S|T|VE))?", "\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])", "\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])", me, ke].join( "|" ), "g" ), Le = RegExp( "[\\u200d\\ud800-\\udfff" + he + "\\ufe0e\\ufe0f]" ), Me = /[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/, qe = ["Array", "Buffer", "DataView", "Date", "Error", "Float32Array", "Float64Array", "Function", "Int8Array", "Int16Array", "Int32Array", "Map", "Math", "Object", "Promise", "RegExp", "Set", "String", "Symbol", "TypeError", "Uint8Array", "Uint8ClampedArray", "Uint16Array", "Uint32Array", "WeakMap", "_", "clearTimeout", "isFinite", "parseInt", "setTimeout"], He = -1, Fe = {}; Fe[A] = Fe[w] = Fe[R] = Fe[I] = Fe[O] = Fe[k] = Fe["[object Uint8ClampedArray]"] = Fe[x] = Fe[N] = !0, Fe[l] = Fe[a] = Fe[E] = Fe[c] = Fe[S] = Fe[f] = Fe[h] = Fe[d] = Fe[p] = Fe[v] = Fe[m] = Fe[g] = Fe[y] = Fe[T] = Fe[b] = !1; var je = {}; je[l] = je[a] = je[E] = je[S] = je[c] = je[f] = je[A] = je[w] = je[R] = je[I] = je[O] = je[p] = je[v] = je[m] = je[g] = je[y] = je[T] = je[C] = je[k] = je["[object Uint8ClampedArray]"] = je[x] = je[N] = !0, je[h] = je[d] = je[b] = !1; var Ge = { "\\": "\\", "'": "'", "\n": "n", "\r": "r", "\u2028": "u2028", "\u2029": "u2029" }, We = parseFloat, Be = parseInt, Ye = "object" == typeof e && e && e.Object === Object && e, ze = "object" == typeof self && self && self.Object === Object && self, Ve = Ye || ze || Function( "return this" )(), Ke = t && !t.nodeType && t, $e = Ke && "object" == typeof r && r && !r.nodeType && r, Je = $e && $e.exports === Ke, Xe = Je && Ye.process, Qe = function () { try { var e = $e && $e.require && $e.require( "util" ).types; return e || Xe && Xe.binding && Xe.binding( "util" ) } catch ( e ) { } }(), Ze = Qe && Qe.isArrayBuffer, et = Qe && Qe.isDate, tt = Qe && Qe.isMap, nt = Qe && Qe.isRegExp, rt = Qe && Qe.isSet, it = Qe && Qe.isTypedArray; function ot ( e, t, n ) { switch ( n.length ) { case 0: return e.call( t ); case 1: return e.call( t, n[0] ); case 2: return e.call( t, n[0], n[1] ); case 3: return e.call( t, n[0], n[1], n[2] ) }return e.apply( t, n ) } function st ( e, t, n, r ) { for ( var i = -1, o = null == e ? 0 : e.length; ++i < o; ) { var s = e[i]; t( r, s, n( s ), e ) } return r } function ut ( e, t ) { for ( var n = -1, r = null == e ? 0 : e.length; ++n < r && !1 !== t( e[n], n, e ); ); return e } function lt ( e, t ) { for ( var n = null == e ? 0 : e.length; n-- && !1 !== t( e[n], n, e ); ); return e } function at ( e, t ) { for ( var n = -1, r = null == e ? 0 : e.length; ++n < r; )if ( !t( e[n], n, e ) ) return !1; return !0 } function ct ( e, t ) { for ( var n = -1, r = null == e ? 0 : e.length, i = 0, o = []; ++n < r; ) { var s = e[n]; t( s, n, e ) && ( o[i++] = s ) } return o } function ft ( e, t ) { return !!( null == e ? 0 : e.length ) && Ct( e, t, 0 ) > -1 } function ht ( e, t, n ) { for ( var r = -1, i = null == e ? 0 : e.length; ++r < i; )if ( n( t, e[r] ) ) return !0; return !1 } function dt ( e, t ) { for ( var n = -1, r = null == e ? 0 : e.length, i = Array( r ); ++n < r; )i[n] = t( e[n], n, e ); return i } function _t ( e, t ) { for ( var n = -1, r = t.length, i = e.length; ++n < r; )e[i + n] = t[n]; return e } function pt ( e, t, n, r ) { var i = -1, o = null == e ? 0 : e.length; for ( r && o && ( n = e[++i] ); ++i < o; )n = t( n, e[i], i, e ); return n } function vt ( e, t, n, r ) { var i = null == e ? 0 : e.length; for ( r && i && ( n = e[--i] ); i--; )n = t( n, e[i], i, e ); return n } function mt ( e, t ) { for ( var n = -1, r = null == e ? 0 : e.length; ++n < r; )if ( t( e[n], n, e ) ) return !0; return !1 } var gt = At( "length" ); function yt ( e, t, n ) { var r; return n( e, ( function ( e, n, i ) { if ( t( e, n, i ) ) return r = n, !1 } ) ), r } function Tt ( e, t, n, r ) { for ( var i = e.length, o = n + ( r ? 1 : -1 ); r ? o-- : ++o < i; )if ( t( e[o], o, e ) ) return o; return -1 } function Ct ( e, t, n ) { return t == t ? function ( e, t, n ) { var r = n - 1, i = e.length; for ( ; ++r < i; )if ( e[r] === t ) return r; return -1 }( e, t, n ) : Tt( e, Et, n ) } function bt ( e, t, n, r ) { for ( var i = n - 1, o = e.length; ++i < o; )if ( r( e[i], t ) ) return i; return -1 } function Et ( e ) { return e != e } function St ( e, t ) { var n = null == e ? 0 : e.length; return n ? It( e, t ) / n : NaN } function At ( e ) { return function ( t ) { return null == t ? void 0 : t[e] } } function wt ( e ) { return function ( t ) { return null == e ? void 0 : e[t] } } function Rt ( e, t, n, r, i ) { return i( e, ( function ( e, i, o ) { n = r ? ( r = !1, e ) : t( n, e, i, o ) } ) ), n } function It ( e, t ) { for ( var n, r = -1, i = e.length; ++r < i; ) { var o = t( e[r] ); void 0 !== o && ( n = void 0 === n ? o : n + o ) } return n } function Ot ( e, t ) { for ( var n = -1, r = Array( e ); ++n < e; )r[n] = t( n ); return r } function kt ( e ) { return function ( t ) { return e( t ) } } function xt ( e, t ) { return dt( t, ( function ( t ) { return e[t] } ) ) } function Nt ( e, t ) { return e.has( t ) } function Pt ( e, t ) { for ( var n = -1, r = e.length; ++n < r && Ct( t, e[n], 0 ) > -1; ); return n } function Ut ( e, t ) { for ( var n = e.length; n-- && Ct( t, e[n], 0 ) > -1; ); return n } function Dt ( e, t ) { for ( var n = e.length, r = 0; n--; )e[n] === t && ++r; return r } var Lt = wt( { "À": "A", "Á": "A", "Â": "A", "Ã": "A", "Ä": "A", "Å": "A", "à": "a", "á": "a", "â": "a", "ã": "a", "ä": "a", "å": "a", "Ç": "C", "ç": "c", "Ð": "D", "ð": "d", "È": "E", "É": "E", "Ê": "E", "Ë": "E", "è": "e", "é": "e", "ê": "e", "ë": "e", "Ì": "I", "Í": "I", "Î": "I", "Ï": "I", "ì": "i", "í": "i", "î": "i", "ï": "i", "Ñ": "N", "ñ": "n", "Ò": "O", "Ó": "O", "Ô": "O", "Õ": "O", "Ö": "O", "Ø": "O", "ò": "o", "ó": "o", "ô": "o", "õ": "o", "ö": "o", "ø": "o", "Ù": "U", "Ú": "U", "Û": "U", "Ü": "U", "ù": "u", "ú": "u", "û": "u", "ü": "u", "Ý": "Y", "ý": "y", "ÿ": "y", "Æ": "Ae", "æ": "ae", "Þ": "Th", "þ": "th", "ß": "ss", "Ā": "A", "Ă": "A", "Ą": "A", "ā": "a", "ă": "a", "ą": "a", "Ć": "C", "Ĉ": "C", "Ċ": "C", "Č": "C", "ć": "c", "ĉ": "c", "ċ": "c", "č": "c", "Ď": "D", "Đ": "D", "ď": "d", "đ": "d", "Ē": "E", "Ĕ": "E", "Ė": "E", "Ę": "E", "Ě": "E", "ē": "e", "ĕ": "e", "ė": "e", "ę": "e", "ě": "e", "Ĝ": "G", "Ğ": "G", "Ġ": "G", "Ģ": "G", "ĝ": "g", "ğ": "g", "ġ": "g", "ģ": "g", "Ĥ": "H", "Ħ": "H", "ĥ": "h", "ħ": "h", "Ĩ": "I", "Ī": "I", "Ĭ": "I", "Į": "I", "İ": "I", "ĩ": "i", "ī": "i", "ĭ": "i", "į": "i", "ı": "i", "Ĵ": "J", "ĵ": "j", "Ķ": "K", "ķ": "k", "ĸ": "k", "Ĺ": "L", "Ļ": "L", "Ľ": "L", "Ŀ": "L", "Ł": "L", "ĺ": "l", "ļ": "l", "ľ": "l", "ŀ": "l", "ł": "l", "Ń": "N", "Ņ": "N", "Ň": "N", "Ŋ": "N", "ń": "n", "ņ": "n", "ň": "n", "ŋ": "n", "Ō": "O", "Ŏ": "O", "Ő": "O", "ō": "o", "ŏ": "o", "ő": "o", "Ŕ": "R", "Ŗ": "R", "Ř": "R", "ŕ": "r", "ŗ": "r", "ř": "r", "Ś": "S", "Ŝ": "S", "Ş": "S", "Š": "S", "ś": "s", "ŝ": "s", "ş": "s", "š": "s", "Ţ": "T", "Ť": "T", "Ŧ": "T", "ţ": "t", "ť": "t", "ŧ": "t", "Ũ": "U", "Ū": "U", "Ŭ": "U", "Ů": "U", "Ű": "U", "Ų": "U", "ũ": "u", "ū": "u", "ŭ": "u", "ů": "u", "ű": "u", "ų": "u", "Ŵ": "W", "ŵ": "w", "Ŷ": "Y", "ŷ": "y", "Ÿ": "Y", "Ź": "Z", "Ż": "Z", "Ž": "Z", "ź": "z", "ż": "z", "ž": "z", "Ĳ": "IJ", "ĳ": "ij", "Œ": "Oe", "œ": "oe", "ŉ": "'n", "ſ": "s" } ), Mt = wt( { "&": "&amp;", "<": "&lt;", ">": "&gt;", '"': "&quot;", "'": "&#39;" } ); function qt ( e ) { return "\\" + Ge[e] } function Ht ( e ) { return Le.test( e ) } function Ft ( e ) { var t = -1, n = Array( e.size ); return e.forEach( ( function ( e, r ) { n[++t] = [r, e] } ) ), n } function jt ( e, t ) { return function ( n ) { return e( t( n ) ) } } function Gt ( e, t ) { for ( var n = -1, r = e.length, i = 0, o = []; ++n < r; ) { var u = e[n]; u !== t && u !== s || ( e[n] = s, o[i++] = n ) } return o } function Wt ( e ) { var t = -1, n = Array( e.size ); return e.forEach( ( function ( e ) { n[++t] = e } ) ), n } function Bt ( e ) { var t = -1, n = Array( e.size ); return e.forEach( ( function ( e ) { n[++t] = [e, e] } ) ), n } function Yt ( e ) { return Ht( e ) ? function ( e ) { var t = Ue.lastIndex = 0; for ( ; Ue.test( e ); )++t; return t }( e ) : gt( e ) } function zt ( e ) { return Ht( e ) ? function ( e ) { return e.match( Ue ) || [] }( e ) : function ( e ) { return e.split( "" ) }( e ) } var Vt = wt( { "&amp;": "&", "&lt;": "<", "&gt;": ">", "&quot;": '"', "&#39;": "'" } ); var Kt = function e ( t ) { var n, r = ( t = null == t ? Ve : Kt.defaults( Ve.Object(), t, Kt.pick( Ve, qe ) ) ).Array, i = t.Date, he = t.Error, de = t.Function, _e = t.Math, pe = t.Object, ve = t.RegExp, me = t.String, ge = t.TypeError, ye = r.prototype, Te = de.prototype, Ce = pe.prototype, be = t["__core-js_shared__"], Ee = Te.toString, Se = Ce.hasOwnProperty, Ae = 0, we = ( n = /[^.]+$/.exec( be && be.keys && be.keys.IE_PROTO || "" ) ) ? "Symbol(src)_1." + n : "", Re = Ce.toString, Ie = Ee.call( pe ), Oe = Ve._, ke = ve( "^" + Ee.call( Se ).replace( z, "\\$&" ).replace( /hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g, "$1.*?" ) + "$" ), xe = Je ? t.Buffer : void 0, Ue = t.Symbol, Le = t.Uint8Array, Ge = xe ? xe.allocUnsafe : void 0, Ye = jt( pe.getPrototypeOf, pe ), ze = pe.create, Ke = Ce.propertyIsEnumerable, $e = ye.splice, Xe = Ue ? Ue.isConcatSpreadable : void 0, Qe = Ue ? Ue.iterator : void 0, gt = Ue ? Ue.toStringTag : void 0, wt = function () { try { var e = Zi( pe, "defineProperty" ); return e( {}, "", {} ), e } catch ( e ) { } }(), $t = t.clearTimeout !== Ve.clearTimeout && t.clearTimeout, Jt = i && i.now !== Ve.Date.now && i.now, Xt = t.setTimeout !== Ve.setTimeout && t.setTimeout, Qt = _e.ceil, Zt = _e.floor, en = pe.getOwnPropertySymbols, tn = xe ? xe.isBuffer : void 0, nn = t.isFinite, rn = ye.join, on = jt( pe.keys, pe ), sn = _e.max, un = _e.min, ln = i.now, an = t.parseInt, cn = _e.random, fn = ye.reverse, hn = Zi( t, "DataView" ), dn = Zi( t, "Map" ), _n = Zi( t, "Promise" ), pn = Zi( t, "Set" ), vn = Zi( t, "WeakMap" ), mn = Zi( pe, "create" ), gn = vn && new vn, yn = {}, Tn = Ro( hn ), Cn = Ro( dn ), bn = Ro( _n ), En = Ro( pn ), Sn = Ro( vn ), An = Ue ? Ue.prototype : void 0, wn = An ? An.valueOf : void 0, Rn = An ? An.toString : void 0; function In ( e ) { if ( Bs( e ) && !Ps( e ) && !( e instanceof Nn ) ) { if ( e instanceof xn ) return e; if ( Se.call( e, "__wrapped__" ) ) return Io( e ) } return new xn( e ) } var On = function () { function e () { } return function ( t ) { if ( !Ws( t ) ) return {}; if ( ze ) return ze( t ); e.prototype = t; var n = new e; return e.prototype = void 0, n } }(); function kn () { } function xn ( e, t ) { this.__wrapped__ = e, this.__actions__ = [], this.__chain__ = !!t, this.__index__ = 0, this.__values__ = void 0 } function Nn ( e ) { this.__wrapped__ = e, this.__actions__ = [], this.__dir__ = 1, this.__filtered__ = !1, this.__iteratees__ = [], this.__takeCount__ = 4294967295, this.__views__ = [] } function Pn ( e ) { var t = -1, n = null == e ? 0 : e.length; for ( this.clear(); ++t < n; ) { var r = e[t]; this.set( r[0], r[1] ) } } function Un ( e ) { var t = -1, n = null == e ? 0 : e.length; for ( this.clear(); ++t < n; ) { var r = e[t]; this.set( r[0], r[1] ) } } function Dn ( e ) { var t = -1, n = null == e ? 0 : e.length; for ( this.clear(); ++t < n; ) { var r = e[t]; this.set( r[0], r[1] ) } } function Ln ( e ) { var t = -1, n = null == e ? 0 : e.length; for ( this.__data__ = new Dn; ++t < n; )this.add( e[t] ) } function Mn ( e ) { var t = this.__data__ = new Un( e ); this.size = t.size } function qn ( e, t ) { var n = Ps( e ), r = !n && Ns( e ), i = !n && !r && Ms( e ), o = !n && !r && !i && Qs( e ), s = n || r || i || o, u = s ? Ot( e.length, me ) : [], l = u.length; for ( var a in e ) !t && !Se.call( e, a ) || s && ( "length" == a || i && ( "offset" == a || "parent" == a ) || o && ( "buffer" == a || "byteLength" == a || "byteOffset" == a ) || so( a, l ) ) || u.push( a ); return u } function Hn ( e ) { var t = e.length; return t ? e[Lr( 0, t - 1 )] : void 0 } function Fn ( e, t ) { return So( mi( e ), $n( t, 0, e.length ) ) } function jn ( e ) { return So( mi( e ) ) } function Gn ( e, t, n ) { ( void 0 === n || Os( e[t], n ) ) && ( void 0 !== n || t in e ) || Vn( e, t, n ) } function Wn ( e, t, n ) { var r = e[t]; Se.call( e, t ) && Os( r, n ) && ( void 0 !== n || t in e ) || Vn( e, t, n ) } function Bn ( e, t ) { for ( var n = e.length; n--; )if ( Os( e[n][0], t ) ) return n; return -1 } function Yn ( e, t, n, r ) { return er( e, ( function ( e, i, o ) { t( r, e, n( e ), o ) } ) ), r } function zn ( e, t ) { return e && gi( t, Tu( t ), e ) } function Vn ( e, t, n ) { "__proto__" == t && wt ? wt( e, t, { configurable: !0, enumerable: !0, value: n, writable: !0 } ) : e[t] = n } function Kn ( e, t ) { for ( var n = -1, i = t.length, o = r( i ), s = null == e; ++n < i; )o[n] = s ? void 0 : pu( e, t[n] ); return o } function $n ( e, t, n ) { return e == e && ( void 0 !== n && ( e = e <= n ? e : n ), void 0 !== t && ( e = e >= t ? e : t ) ), e } function Jn ( e, t, n, r, i, o ) { var s, u = 1 & t, a = 2 & t, h = 4 & t; if ( n && ( s = i ? n( e, r, i, o ) : n( e ) ), void 0 !== s ) return s; if ( !Ws( e ) ) return e; var b = Ps( e ); if ( b ) { if ( s = function ( e ) { var t = e.length, n = new e.constructor( t ); t && "string" == typeof e[0] && Se.call( e, "index" ) && ( n.index = e.index, n.input = e.input ); return n }( e ), !u ) return mi( e, s ) } else { var P = no( e ), U = P == d || P == _; if ( Ms( e ) ) return fi( e, u ); if ( P == m || P == l || U && !i ) { if ( s = a || U ? {} : io( e ), !u ) return a ? function ( e, t ) { return gi( e, to( e ), t ) }( e, function ( e, t ) { return e && gi( t, Cu( t ), e ) }( s, e ) ) : function ( e, t ) { return gi( e, eo( e ), t ) }( e, zn( s, e ) ) } else { if ( !je[P] ) return i ? e : {}; s = function ( e, t, n ) { var r = e.constructor; switch ( t ) { case E: return hi( e ); case c: case f: return new r( +e ); case S: return function ( e, t ) { var n = t ? hi( e.buffer ) : e.buffer; return new e.constructor( n, e.byteOffset, e.byteLength ) }( e, n ); case A: case w: case R: case I: case O: case k: case "[object Uint8ClampedArray]": case x: case N: return di( e, n ); case p: return new r; case v: case T: return new r( e ); case g: return function ( e ) { var t = new e.constructor( e.source, re.exec( e ) ); return t.lastIndex = e.lastIndex, t }( e ); case y: return new r; case C: return i = e, wn ? pe( wn.call( i ) ) : {} }var i }( e, P, u ) } } o || ( o = new Mn ); var D = o.get( e ); if ( D ) return D; o.set( e, s ), $s( e ) ? e.forEach( ( function ( r ) { s.add( Jn( r, t, n, r, e, o ) ) } ) ) : Ys( e ) && e.forEach( ( function ( r, i ) { s.set( i, Jn( r, t, n, i, e, o ) ) } ) ); var L = b ? void 0 : ( h ? a ? zi : Yi : a ? Cu : Tu )( e ); return ut( L || e, ( function ( r, i ) { L && ( r = e[i = r] ), Wn( s, i, Jn( r, t, n, i, e, o ) ) } ) ), s } function Xn ( e, t, n ) { var r = n.length; if ( null == e ) return !r; for ( e = pe( e ); r--; ) { var i = n[r], o = t[i], s = e[i]; if ( void 0 === s && !( i in e ) || !o( s ) ) return !1 } return !0 } function Qn ( e, t, n ) { if ( "function" != typeof e ) throw new ge( o ); return To( ( function () { e.apply( void 0, n ) } ), t ) } function Zn ( e, t, n, r ) { var i = -1, o = ft, s = !0, u = e.length, l = [], a = t.length; if ( !u ) return l; n && ( t = dt( t, kt( n ) ) ), r ? ( o = ht, s = !1 ) : t.length >= 200 && ( o = Nt, s = !1, t = new Ln( t ) ); e: for ( ; ++i < u; ) { var c = e[i], f = null == n ? c : n( c ); if ( c = r || 0 !== c ? c : 0, s && f == f ) { for ( var h = a; h--; )if ( t[h] === f ) continue e; l.push( c ) } else o( t, f, r ) || l.push( c ) } return l } In.templateSettings = { escape: F, evaluate: j, interpolate: G, variable: "", imports: { _: In } }, In.prototype = kn.prototype, In.prototype.constructor = In, xn.prototype = On( kn.prototype ), xn.prototype.constructor = xn, Nn.prototype = On( kn.prototype ), Nn.prototype.constructor = Nn, Pn.prototype.clear = function () { this.__data__ = mn ? mn( null ) : {}, this.size = 0 }, Pn.prototype.delete = function ( e ) { var t = this.has( e ) && delete this.__data__[e]; return this.size -= t ? 1 : 0, t }, Pn.prototype.get = function ( e ) { var t = this.__data__; if ( mn ) { var n = t[e]; return "__lodash_hash_undefined__" === n ? void 0 : n } return Se.call( t, e ) ? t[e] : void 0 }, Pn.prototype.has = function ( e ) { var t = this.__data__; return mn ? void 0 !== t[e] : Se.call( t, e ) }, Pn.prototype.set = function ( e, t ) { var n = this.__data__; return this.size += this.has( e ) ? 0 : 1, n[e] = mn && void 0 === t ? "__lodash_hash_undefined__" : t, this }, Un.prototype.clear = function () { this.__data__ = [], this.size = 0 }, Un.prototype.delete = function ( e ) { var t = this.__data__, n = Bn( t, e ); return !( n < 0 ) && ( n == t.length - 1 ? t.pop() : $e.call( t, n, 1 ), --this.size, !0 ) }, Un.prototype.get = function ( e ) { var t = this.__data__, n = Bn( t, e ); return n < 0 ? void 0 : t[n][1] }, Un.prototype.has = function ( e ) { return Bn( this.__data__, e ) > -1 }, Un.prototype.set = function ( e, t ) { var n = this.__data__, r = Bn( n, e ); return r < 0 ? ( ++this.size, n.push( [e, t] ) ) : n[r][1] = t, this }, Dn.prototype.clear = function () { this.size = 0, this.__data__ = { hash: new Pn, map: new ( dn || Un ), string: new Pn } }, Dn.prototype.delete = function ( e ) { var t = Xi( this, e ).delete( e ); return this.size -= t ? 1 : 0, t }, Dn.prototype.get = function ( e ) { return Xi( this, e ).get( e ) }, Dn.prototype.has = function ( e ) { return Xi( this, e ).has( e ) }, Dn.prototype.set = function ( e, t ) { var n = Xi( this, e ), r = n.size; return n.set( e, t ), this.size += n.size == r ? 0 : 1, this }, Ln.prototype.add = Ln.prototype.push = function ( e ) { return this.__data__.set( e, "__lodash_hash_undefined__" ), this }, Ln.prototype.has = function ( e ) { return this.__data__.has( e ) }, Mn.prototype.clear = function () { this.__data__ = new Un, this.size = 0 }, Mn.prototype.delete = function ( e ) { var t = this.__data__, n = t.delete( e ); return this.size = t.size, n }, Mn.prototype.get = function ( e ) { return this.__data__.get( e ) }, Mn.prototype.has = function ( e ) { return this.__data__.has( e ) }, Mn.prototype.set = function ( e, t ) { var n = this.__data__; if ( n instanceof Un ) { var r = n.__data__; if ( !dn || r.length < 199 ) return r.push( [e, t] ), this.size = ++n.size, this; n = this.__data__ = new Dn( r ) } return n.set( e, t ), this.size = n.size, this }; var er = Ci( lr ), tr = Ci( ar, !0 ); function nr ( e, t ) { var n = !0; return er( e, ( function ( e, r, i ) { return n = !!t( e, r, i ) } ) ), n } function rr ( e, t, n ) { for ( var r = -1, i = e.length; ++r < i; ) { var o = e[r], s = t( o ); if ( null != s && ( void 0 === u ? s == s && !Xs( s ) : n( s, u ) ) ) var u = s, l = o } return l } function ir ( e, t ) { var n = []; return er( e, ( function ( e, r, i ) { t( e, r, i ) && n.push( e ) } ) ), n } function or ( e, t, n, r, i ) { var o = -1, s = e.length; for ( n || ( n = oo ), i || ( i = [] ); ++o < s; ) { var u = e[o]; t > 0 && n( u ) ? t > 1 ? or( u, t - 1, n, r, i ) : _t( i, u ) : r || ( i[i.length] = u ) } return i } var sr = bi(), ur = bi( !0 ); function lr ( e, t ) { return e && sr( e, t, Tu ) } function ar ( e, t ) { return e && ur( e, t, Tu ) } function cr ( e, t ) { return ct( t, ( function ( t ) { return Fs( e[t] ) } ) ) } function fr ( e, t ) { for ( var n = 0, r = ( t = ui( t, e ) ).length; null != e && n < r; )e = e[wo( t[n++] )]; return n && n == r ? e : void 0 } function hr ( e, t, n ) { var r = t( e ); return Ps( e ) ? r : _t( r, n( e ) ) } function dr ( e ) { return null == e ? void 0 === e ? "[object Undefined]" : "[object Null]" : gt && gt in pe( e ) ? function ( e ) { var t = Se.call( e, gt ), n = e[gt]; try { e[gt] = void 0; var r = !0 } catch ( e ) { } var i = Re.call( e ); r && ( t ? e[gt] = n : delete e[gt] ); return i }( e ) : function ( e ) { return Re.call( e ) }( e ) } function _r ( e, t ) { return e > t } function pr ( e, t ) { return null != e && Se.call( e, t ) } function vr ( e, t ) { return null != e && t in pe( e ) } function mr ( e, t, n ) { for ( var i = n ? ht : ft, o = e[0].length, s = e.length, u = s, l = r( s ), a = 1 / 0, c = []; u--; ) { var f = e[u]; u && t && ( f = dt( f, kt( t ) ) ), a = un( f.length, a ), l[u] = !n && ( t || o >= 120 && f.length >= 120 ) ? new Ln( u && f ) : void 0 } f = e[0]; var h = -1, d = l[0]; e: for ( ; ++h < o && c.length < a; ) { var _ = f[h], p = t ? t( _ ) : _; if ( _ = n || 0 !== _ ? _ : 0, !( d ? Nt( d, p ) : i( c, p, n ) ) ) { for ( u = s; --u; ) { var v = l[u]; if ( !( v ? Nt( v, p ) : i( e[u], p, n ) ) ) continue e } d && d.push( p ), c.push( _ ) } } return c } function gr ( e, t, n ) { var r = null == ( e = vo( e, t = ui( t, e ) ) ) ? e : e[wo( Ho( t ) )]; return null == r ? void 0 : ot( r, e, n ) } function yr ( e ) { return Bs( e ) && dr( e ) == l } function Tr ( e, t, n, r, i ) { return e === t || ( null == e || null == t || !Bs( e ) && !Bs( t ) ? e != e && t != t : function ( e, t, n, r, i, o ) { var s = Ps( e ), u = Ps( t ), d = s ? a : no( e ), _ = u ? a : no( t ), b = ( d = d == l ? m : d ) == m, A = ( _ = _ == l ? m : _ ) == m, w = d == _; if ( w && Ms( e ) ) { if ( !Ms( t ) ) return !1; s = !0, b = !1 } if ( w && !b ) return o || ( o = new Mn ), s || Qs( e ) ? Wi( e, t, n, r, i, o ) : function ( e, t, n, r, i, o, s ) { switch ( n ) { case S: if ( e.byteLength != t.byteLength || e.byteOffset != t.byteOffset ) return !1; e = e.buffer, t = t.buffer; case E: return !( e.byteLength != t.byteLength || !o( new Le( e ), new Le( t ) ) ); case c: case f: case v: return Os( +e, +t ); case h: return e.name == t.name && e.message == t.message; case g: case T: return e == t + ""; case p: var u = Ft; case y: var l = 1 & r; if ( u || ( u = Wt ), e.size != t.size && !l ) return !1; var a = s.get( e ); if ( a ) return a == t; r |= 2, s.set( e, t ); var d = Wi( u( e ), u( t ), r, i, o, s ); return s.delete( e ), d; case C: if ( wn ) return wn.call( e ) == wn.call( t ) }return !1 }( e, t, d, n, r, i, o ); if ( !( 1 & n ) ) { var R = b && Se.call( e, "__wrapped__" ), I = A && Se.call( t, "__wrapped__" ); if ( R || I ) { var O = R ? e.value() : e, k = I ? t.value() : t; return o || ( o = new Mn ), i( O, k, n, r, o ) } } if ( !w ) return !1; return o || ( o = new Mn ), function ( e, t, n, r, i, o ) { var s = 1 & n, u = Yi( e ), l = u.length, a = Yi( t ).length; if ( l != a && !s ) return !1; var c = l; for ( ; c--; ) { var f = u[c]; if ( !( s ? f in t : Se.call( t, f ) ) ) return !1 } var h = o.get( e ); if ( h && o.get( t ) ) return h == t; var d = !0; o.set( e, t ), o.set( t, e ); var _ = s; for ( ; ++c < l; ) { f = u[c]; var p = e[f], v = t[f]; if ( r ) var m = s ? r( v, p, f, t, e, o ) : r( p, v, f, e, t, o ); if ( !( void 0 === m ? p === v || i( p, v, n, r, o ) : m ) ) { d = !1; break } _ || ( _ = "constructor" == f ) } if ( d && !_ ) { var g = e.constructor, y = t.constructor; g != y && "constructor" in e && "constructor" in t && !( "function" == typeof g && g instanceof g && "function" == typeof y && y instanceof y ) && ( d = !1 ) } return o.delete( e ), o.delete( t ), d }( e, t, n, r, i, o ) }( e, t, n, r, Tr, i ) ) } function Cr ( e, t, n, r ) { var i = n.length, o = i, s = !r; if ( null == e ) return !o; for ( e = pe( e ); i--; ) { var u = n[i]; if ( s && u[2] ? u[1] !== e[u[0]] : !( u[0] in e ) ) return !1 } for ( ; ++i < o; ) { var l = ( u = n[i] )[0], a = e[l], c = u[1]; if ( s && u[2] ) { if ( void 0 === a && !( l in e ) ) return !1 } else { var f = new Mn; if ( r ) var h = r( a, c, l, e, t, f ); if ( !( void 0 === h ? Tr( c, a, 3, r, f ) : h ) ) return !1 } } return !0 } function br ( e ) { return !( !Ws( e ) || ( t = e, we && we in t ) ) && ( Fs( e ) ? ke : se ).test( Ro( e ) ); var t } function Er ( e ) { return "function" == typeof e ? e : null == e ? zu : "object" == typeof e ? Ps( e ) ? Or( e[0], e[1] ) : Ir( e ) : tl( e ) } function Sr ( e ) { if ( !fo( e ) ) return on( e ); var t = []; for ( var n in pe( e ) ) Se.call( e, n ) && "constructor" != n && t.push( n ); return t } function Ar ( e ) { if ( !Ws( e ) ) return function ( e ) { var t = []; if ( null != e ) for ( var n in pe( e ) ) t.push( n ); return t }( e ); var t = fo( e ), n = []; for ( var r in e ) ( "constructor" != r || !t && Se.call( e, r ) ) && n.push( r ); return n } function wr ( e, t ) { return e < t } function Rr ( e, t ) { var n = -1, i = Ds( e ) ? r( e.length ) : []; return er( e, ( function ( e, r, o ) { i[++n] = t( e, r, o ) } ) ), i } function Ir ( e ) { var t = Qi( e ); return 1 == t.length && t[0][2] ? _o( t[0][0], t[0][1] ) : function ( n ) { return n === e || Cr( n, e, t ) } } function Or ( e, t ) { return lo( e ) && ho( t ) ? _o( wo( e ), t ) : function ( n ) { var r = pu( n, e ); return void 0 === r && r === t ? vu( n, e ) : Tr( t, r, 3 ) } } function kr ( e, t, n, r, i ) { e !== t && sr( t, ( function ( o, s ) { if ( i || ( i = new Mn ), Ws( o ) ) !function ( e, t, n, r, i, o, s ) { var u = go( e, n ), l = go( t, n ), a = s.get( l ); if ( a ) return void Gn( e, n, a ); var c = o ? o( u, l, n + "", e, t, s ) : void 0, f = void 0 === c; if ( f ) { var h = Ps( l ), d = !h && Ms( l ), _ = !h && !d && Qs( l ); c = l, h || d || _ ? Ps( u ) ? c = u : Ls( u ) ? c = mi( u ) : d ? ( f = !1, c = fi( l, !0 ) ) : _ ? ( f = !1, c = di( l, !0 ) ) : c = [] : Vs( l ) || Ns( l ) ? ( c = u, Ns( u ) ? c = su( u ) : Ws( u ) && !Fs( u ) || ( c = io( l ) ) ) : f = !1 } f && ( s.set( l, c ), i( c, l, r, o, s ), s.delete( l ) ); Gn( e, n, c ) }( e, t, s, n, kr, r, i ); else { var u = r ? r( go( e, s ), o, s + "", e, t, i ) : void 0; void 0 === u && ( u = o ), Gn( e, s, u ) } } ), Cu ) } function xr ( e, t ) { var n = e.length; if ( n ) return so( t += t < 0 ? n : 0, n ) ? e[t] : void 0 } function Nr ( e, t, n ) { var r = -1; return t = dt( t.length ? t : [zu], kt( Ji() ) ), function ( e, t ) { var n = e.length; for ( e.sort( t ); n--; )e[n] = e[n].value; return e }( Rr( e, ( function ( e, n, i ) { return { criteria: dt( t, ( function ( t ) { return t( e ) } ) ), index: ++r, value: e } } ) ), ( function ( e, t ) { return function ( e, t, n ) { var r = -1, i = e.criteria, o = t.criteria, s = i.length, u = n.length; for ( ; ++r < s; ) { var l = _i( i[r], o[r] ); if ( l ) { if ( r >= u ) return l; var a = n[r]; return l * ( "desc" == a ? -1 : 1 ) } } return e.index - t.index }( e, t, n ) } ) ) } function Pr ( e, t, n ) { for ( var r = -1, i = t.length, o = {}; ++r < i; ) { var s = t[r], u = fr( e, s ); n( u, s ) && jr( o, ui( s, e ), u ) } return o } function Ur ( e, t, n, r ) { var i = r ? bt : Ct, o = -1, s = t.length, u = e; for ( e === t && ( t = mi( t ) ), n && ( u = dt( e, kt( n ) ) ); ++o < s; )for ( var l = 0, a = t[o], c = n ? n( a ) : a; ( l = i( u, c, l, r ) ) > -1; )u !== e && $e.call( u, l, 1 ), $e.call( e, l, 1 ); return e } function Dr ( e, t ) { for ( var n = e ? t.length : 0, r = n - 1; n--; ) { var i = t[n]; if ( n == r || i !== o ) { var o = i; so( i ) ? $e.call( e, i, 1 ) : Zr( e, i ) } } return e } function Lr ( e, t ) { return e + Zt( cn() * ( t - e + 1 ) ) } function Mr ( e, t ) { var n = ""; if ( !e || t < 1 || t > 9007199254740991 ) return n; do { t % 2 && ( n += e ), ( t = Zt( t / 2 ) ) && ( e += e ) } while ( t ); return n } function qr ( e, t ) { return Co( po( e, t, zu ), e + "" ) } function Hr ( e ) { return Hn( Ou( e ) ) } function Fr ( e, t ) { var n = Ou( e ); return So( n, $n( t, 0, n.length ) ) } function jr ( e, t, n, r ) { if ( !Ws( e ) ) return e; for ( var i = -1, o = ( t = ui( t, e ) ).length, s = o - 1, u = e; null != u && ++i < o; ) { var l = wo( t[i] ), a = n; if ( i != s ) { var c = u[l]; void 0 === ( a = r ? r( c, l, u ) : void 0 ) && ( a = Ws( c ) ? c : so( t[i + 1] ) ? [] : {} ) } Wn( u, l, a ), u = u[l] } return e } var Gr = gn ? function ( e, t ) { return gn.set( e, t ), e } : zu, Wr = wt ? function ( e, t ) { return wt( e, "toString", { configurable: !0, enumerable: !1, value: Wu( t ), writable: !0 } ) } : zu; function Br ( e ) { return So( Ou( e ) ) } function Yr ( e, t, n ) { var i = -1, o = e.length; t < 0 && ( t = -t > o ? 0 : o + t ), ( n = n > o ? o : n ) < 0 && ( n += o ), o = t > n ? 0 : n - t >>> 0, t >>>= 0; for ( var s = r( o ); ++i < o; )s[i] = e[i + t]; return s } function zr ( e, t ) { var n; return er( e, ( function ( e, r, i ) { return !( n = t( e, r, i ) ) } ) ), !!n } function Vr ( e, t, n ) { var r = 0, i = null == e ? r : e.length; if ( "number" == typeof t && t == t && i <= 2147483647 ) { for ( ; r < i; ) { var o = r + i >>> 1, s = e[o]; null !== s && !Xs( s ) && ( n ? s <= t : s < t ) ? r = o + 1 : i = o } return i } return Kr( e, t, zu, n ) } function Kr ( e, t, n, r ) { t = n( t ); for ( var i = 0, o = null == e ? 0 : e.length, s = t != t, u = null === t, l = Xs( t ), a = void 0 === t; i < o; ) { var c = Zt( ( i + o ) / 2 ), f = n( e[c] ), h = void 0 !== f, d = null === f, _ = f == f, p = Xs( f ); if ( s ) var v = r || _; else v = a ? _ && ( r || h ) : u ? _ && h && ( r || !d ) : l ? _ && h && !d && ( r || !p ) : !d && !p && ( r ? f <= t : f < t ); v ? i = c + 1 : o = c } return un( o, 4294967294 ) } function $r ( e, t ) { for ( var n = -1, r = e.length, i = 0, o = []; ++n < r; ) { var s = e[n], u = t ? t( s ) : s; if ( !n || !Os( u, l ) ) { var l = u; o[i++] = 0 === s ? 0 : s } } return o } function Jr ( e ) { return "number" == typeof e ? e : Xs( e ) ? NaN : +e } function Xr ( e ) { if ( "string" == typeof e ) return e; if ( Ps( e ) ) return dt( e, Xr ) + ""; if ( Xs( e ) ) return Rn ? Rn.call( e ) : ""; var t = e + ""; return "0" == t && 1 / e == -1 / 0 ? "-0" : t } function Qr ( e, t, n ) { var r = -1, i = ft, o = e.length, s = !0, u = [], l = u; if ( n ) s = !1, i = ht; else if ( o >= 200 ) { var a = t ? null : Mi( e ); if ( a ) return Wt( a ); s = !1, i = Nt, l = new Ln } else l = t ? [] : u; e: for ( ; ++r < o; ) { var c = e[r], f = t ? t( c ) : c; if ( c = n || 0 !== c ? c : 0, s && f == f ) { for ( var h = l.length; h--; )if ( l[h] === f ) continue e; t && l.push( f ), u.push( c ) } else i( l, f, n ) || ( l !== u && l.push( f ), u.push( c ) ) } return u } function Zr ( e, t ) { return null == ( e = vo( e, t = ui( t, e ) ) ) || delete e[wo( Ho( t ) )] } function ei ( e, t, n, r ) { return jr( e, t, n( fr( e, t ) ), r ) } function ti ( e, t, n, r ) { for ( var i = e.length, o = r ? i : -1; ( r ? o-- : ++o < i ) && t( e[o], o, e ); ); return n ? Yr( e, r ? 0 : o, r ? o + 1 : i ) : Yr( e, r ? o + 1 : 0, r ? i : o ) } function ni ( e, t ) { var n = e; return n instanceof Nn && ( n = n.value() ), pt( t, ( function ( e, t ) { return t.func.apply( t.thisArg, _t( [e], t.args ) ) } ), n ) } function ri ( e, t, n ) { var i = e.length; if ( i < 2 ) return i ? Qr( e[0] ) : []; for ( var o = -1, s = r( i ); ++o < i; )for ( var u = e[o], l = -1; ++l < i; )l != o && ( s[o] = Zn( s[o] || u, e[l], t, n ) ); return Qr( or( s, 1 ), t, n ) } function ii ( e, t, n ) { for ( var r = -1, i = e.length, o = t.length, s = {}; ++r < i; ) { var u = r < o ? t[r] : void 0; n( s, e[r], u ) } return s } function oi ( e ) { return Ls( e ) ? e : [] } function si ( e ) { return "function" == typeof e ? e : zu } function ui ( e, t ) { return Ps( e ) ? e : lo( e, t ) ? [e] : Ao( uu( e ) ) } var li = qr; function ai ( e, t, n ) { var r = e.length; return n = void 0 === n ? r : n, !t && n >= r ? e : Yr( e, t, n ) } var ci = $t || function ( e ) { return Ve.clearTimeout( e ) }; function fi ( e, t ) { if ( t ) return e.slice(); var n = e.length, r = Ge ? Ge( n ) : new e.constructor( n ); return e.copy( r ), r } function hi ( e ) { var t = new e.constructor( e.byteLength ); return new Le( t ).set( new Le( e ) ), t } function di ( e, t ) { var n = t ? hi( e.buffer ) : e.buffer; return new e.constructor( n, e.byteOffset, e.length ) } function _i ( e, t ) { if ( e !== t ) { var n = void 0 !== e, r = null === e, i = e == e, o = Xs( e ), s = void 0 !== t, u = null === t, l = t == t, a = Xs( t ); if ( !u && !a && !o && e > t || o && s && l && !u && !a || r && s && l || !n && l || !i ) return 1; if ( !r && !o && !a && e < t || a && n && i && !r && !o || u && n && i || !s && i || !l ) return -1 } return 0 } function pi ( e, t, n, i ) { for ( var o = -1, s = e.length, u = n.length, l = -1, a = t.length, c = sn( s - u, 0 ), f = r( a + c ), h = !i; ++l < a; )f[l] = t[l]; for ( ; ++o < u; )( h || o < s ) && ( f[n[o]] = e[o] ); for ( ; c--; )f[l++] = e[o++]; return f } function vi ( e, t, n, i ) { for ( var o = -1, s = e.length, u = -1, l = n.length, a = -1, c = t.length, f = sn( s - l, 0 ), h = r( f + c ), d = !i; ++o < f; )h[o] = e[o]; for ( var _ = o; ++a < c; )h[_ + a] = t[a]; for ( ; ++u < l; )( d || o < s ) && ( h[_ + n[u]] = e[o++] ); return h } function mi ( e, t ) { var n = -1, i = e.length; for ( t || ( t = r( i ) ); ++n < i; )t[n] = e[n]; return t } function gi ( e, t, n, r ) { var i = !n; n || ( n = {} ); for ( var o = -1, s = t.length; ++o < s; ) { var u = t[o], l = r ? r( n[u], e[u], u, n, e ) : void 0; void 0 === l && ( l = e[u] ), i ? Vn( n, u, l ) : Wn( n, u, l ) } return n } function yi ( e, t ) { return function ( n, r ) { var i = Ps( n ) ? st : Yn, o = t ? t() : {}; return i( n, e, Ji( r, 2 ), o ) } } function Ti ( e ) { return qr( ( function ( t, n ) { var r = -1, i = n.length, o = i > 1 ? n[i - 1] : void 0, s = i > 2 ? n[2] : void 0; for ( o = e.length > 3 && "function" == typeof o ? ( i--, o ) : void 0, s && uo( n[0], n[1], s ) && ( o = i < 3 ? void 0 : o, i = 1 ), t = pe( t ); ++r < i; ) { var u = n[r]; u && e( t, u, r, o ) } return t } ) ) } function Ci ( e, t ) { return function ( n, r ) { if ( null == n ) return n; if ( !Ds( n ) ) return e( n, r ); for ( var i = n.length, o = t ? i : -1, s = pe( n ); ( t ? o-- : ++o < i ) && !1 !== r( s[o], o, s ); ); return n } } function bi ( e ) { return function ( t, n, r ) { for ( var i = -1, o = pe( t ), s = r( t ), u = s.length; u--; ) { var l = s[e ? u : ++i]; if ( !1 === n( o[l], l, o ) ) break } return t } } function Ei ( e ) { return function ( t ) { var n = Ht( t = uu( t ) ) ? zt( t ) : void 0, r = n ? n[0] : t.charAt( 0 ), i = n ? ai( n, 1 ).join( "" ) : t.slice( 1 ); return r[e]() + i } } function Si ( e ) { return function ( t ) { return pt( Fu( Nu( t ).replace( Ne, "" ) ), e, "" ) } } function Ai ( e ) { return function () { var t = arguments; switch ( t.length ) { case 0: return new e; case 1: return new e( t[0] ); case 2: return new e( t[0], t[1] ); case 3: return new e( t[0], t[1], t[2] ); case 4: return new e( t[0], t[1], t[2], t[3] ); case 5: return new e( t[0], t[1], t[2], t[3], t[4] ); case 6: return new e( t[0], t[1], t[2], t[3], t[4], t[5] ); case 7: return new e( t[0], t[1], t[2], t[3], t[4], t[5], t[6] ) }var n = On( e.prototype ), r = e.apply( n, t ); return Ws( r ) ? r : n } } function wi ( e ) { return function ( t, n, r ) { var i = pe( t ); if ( !Ds( t ) ) { var o = Ji( n, 3 ); t = Tu( t ), n = function ( e ) { return o( i[e], e, i ) } } var s = e( t, n, r ); return s > -1 ? i[o ? t[s] : s] : void 0 } } function Ri ( e ) { return Bi( ( function ( t ) { var n = t.length, r = n, i = xn.prototype.thru; for ( e && t.reverse(); r--; ) { var s = t[r]; if ( "function" != typeof s ) throw new ge( o ); if ( i && !u && "wrapper" == Ki( s ) ) var u = new xn( [], !0 ) } for ( r = u ? r : n; ++r < n; ) { var l = Ki( s = t[r] ), a = "wrapper" == l ? Vi( s ) : void 0; u = a && ao( a[0] ) && 424 == a[1] && !a[4].length && 1 == a[9] ? u[Ki( a[0] )].apply( u, a[3] ) : 1 == s.length && ao( s ) ? u[l]() : u.thru( s ) } return function () { var e = arguments, r = e[0]; if ( u && 1 == e.length && Ps( r ) ) return u.plant( r ).value(); for ( var i = 0, o = n ? t[i].apply( this, e ) : r; ++i < n; )o = t[i].call( this, o ); return o } } ) ) } function Ii ( e, t, n, i, o, s, u, l, a, c ) { var f = 128 & t, h = 1 & t, d = 2 & t, _ = 24 & t, p = 512 & t, v = d ? void 0 : Ai( e ); return function m () { for ( var g = arguments.length, y = r( g ), T = g; T--; )y[T] = arguments[T]; if ( _ ) var C = $i( m ), b = Dt( y, C ); if ( i && ( y = pi( y, i, o, _ ) ), s && ( y = vi( y, s, u, _ ) ), g -= b, _ && g < c ) { var E = Gt( y, C ); return Di( e, t, Ii, m.placeholder, n, y, E, l, a, c - g ) } var S = h ? n : this, A = d ? S[e] : e; return g = y.length, l ? y = mo( y, l ) : p && g > 1 && y.reverse(), f && a < g && ( y.length = a ), this && this !== Ve && this instanceof m && ( A = v || Ai( A ) ), A.apply( S, y ) } } function Oi ( e, t ) { return function ( n, r ) { return function ( e, t, n, r ) { return lr( e, ( function ( e, i, o ) { t( r, n( e ), i, o ) } ) ), r }( n, e, t( r ), {} ) } } function ki ( e, t ) { return function ( n, r ) { var i; if ( void 0 === n && void 0 === r ) return t; if ( void 0 !== n && ( i = n ), void 0 !== r ) { if ( void 0 === i ) return r; "string" == typeof n || "string" == typeof r ? ( n = Xr( n ), r = Xr( r ) ) : ( n = Jr( n ), r = Jr( r ) ), i = e( n, r ) } return i } } function xi ( e ) { return Bi( ( function ( t ) { return t = dt( t, kt( Ji() ) ), qr( ( function ( n ) { var r = this; return e( t, ( function ( e ) { return ot( e, r, n ) } ) ) } ) ) } ) ) } function Ni ( e, t ) { var n = ( t = void 0 === t ? " " : Xr( t ) ).length; if ( n < 2 ) return n ? Mr( t, e ) : t; var r = Mr( t, Qt( e / Yt( t ) ) ); return Ht( t ) ? ai( zt( r ), 0, e ).join( "" ) : r.slice( 0, e ) } function Pi ( e ) { return function ( t, n, i ) { return i && "number" != typeof i && uo( t, n, i ) && ( n = i = void 0 ), t = nu( t ), void 0 === n ? ( n = t, t = 0 ) : n = nu( n ), function ( e, t, n, i ) { for ( var o = -1, s = sn( Qt( ( t - e ) / ( n || 1 ) ), 0 ), u = r( s ); s--; )u[i ? s : ++o] = e, e += n; return u }( t, n, i = void 0 === i ? t < n ? 1 : -1 : nu( i ), e ) } } function Ui ( e ) { return function ( t, n ) { return "string" == typeof t && "string" == typeof n || ( t = ou( t ), n = ou( n ) ), e( t, n ) } } function Di ( e, t, n, r, i, o, s, u, l, a ) { var c = 8 & t; t |= c ? 32 : 64, 4 & ( t &= ~( c ? 64 : 32 ) ) || ( t &= -4 ); var f = [e, t, i, c ? o : void 0, c ? s : void 0, c ? void 0 : o, c ? void 0 : s, u, l, a], h = n.apply( void 0, f ); return ao( e ) && yo( h, f ), h.placeholder = r, bo( h, e, t ) } function Li ( e ) { var t = _e[e]; return function ( e, n ) { if ( e = ou( e ), ( n = null == n ? 0 : un( ru( n ), 292 ) ) && nn( e ) ) { var r = ( uu( e ) + "e" ).split( "e" ); return +( ( r = ( uu( t( r[0] + "e" + ( +r[1] + n ) ) ) + "e" ).split( "e" ) )[0] + "e" + ( +r[1] - n ) ) } return t( e ) } } var Mi = pn && 1 / Wt( new pn( [, -0] ) )[1] == 1 / 0 ? function ( e ) { return new pn( e ) } : Xu; function qi ( e ) { return function ( t ) { var n = no( t ); return n == p ? Ft( t ) : n == y ? Bt( t ) : function ( e, t ) { return dt( t, ( function ( t ) { return [t, e[t]] } ) ) }( t, e( t ) ) } } function Hi ( e, t, n, i, u, l, a, c ) { var f = 2 & t; if ( !f && "function" != typeof e ) throw new ge( o ); var h = i ? i.length : 0; if ( h || ( t &= -97, i = u = void 0 ), a = void 0 === a ? a : sn( ru( a ), 0 ), c = void 0 === c ? c : ru( c ), h -= u ? u.length : 0, 64 & t ) { var d = i, _ = u; i = u = void 0 } var p = f ? void 0 : Vi( e ), v = [e, t, n, i, u, d, _, l, a, c]; if ( p && function ( e, t ) { var n = e[1], r = t[1], i = n | r, o = i < 131, u = 128 == r && 8 == n || 128 == r && 256 == n && e[7].length <= t[8] || 384 == r && t[7].length <= t[8] && 8 == n; if ( !o && !u ) return e; 1 & r && ( e[2] = t[2], i |= 1 & n ? 0 : 4 ); var l = t[3]; if ( l ) { var a = e[3]; e[3] = a ? pi( a, l, t[4] ) : l, e[4] = a ? Gt( e[3], s ) : t[4] } ( l = t[5] ) && ( a = e[5], e[5] = a ? vi( a, l, t[6] ) : l, e[6] = a ? Gt( e[5], s ) : t[6] ); ( l = t[7] ) && ( e[7] = l ); 128 & r && ( e[8] = null == e[8] ? t[8] : un( e[8], t[8] ) ); null == e[9] && ( e[9] = t[9] ); e[0] = t[0], e[1] = i }( v, p ), e = v[0], t = v[1], n = v[2], i = v[3], u = v[4], !( c = v[9] = void 0 === v[9] ? f ? 0 : e.length : sn( v[9] - h, 0 ) ) && 24 & t && ( t &= -25 ), t && 1 != t ) m = 8 == t || 16 == t ? function ( e, t, n ) { var i = Ai( e ); return function o () { for ( var s = arguments.length, u = r( s ), l = s, a = $i( o ); l--; )u[l] = arguments[l]; var c = s < 3 && u[0] !== a && u[s - 1] !== a ? [] : Gt( u, a ); if ( ( s -= c.length ) < n ) return Di( e, t, Ii, o.placeholder, void 0, u, c, void 0, void 0, n - s ); var f = this && this !== Ve && this instanceof o ? i : e; return ot( f, this, u ) } }( e, t, c ) : 32 != t && 33 != t || u.length ? Ii.apply( void 0, v ) : function ( e, t, n, i ) { var o = 1 & t, s = Ai( e ); return function t () { for ( var u = -1, l = arguments.length, a = -1, c = i.length, f = r( c + l ), h = this && this !== Ve && this instanceof t ? s : e; ++a < c; )f[a] = i[a]; for ( ; l--; )f[a++] = arguments[++u]; return ot( h, o ? n : this, f ) } }( e, t, n, i ); else var m = function ( e, t, n ) { var r = 1 & t, i = Ai( e ); return function t () { var o = this && this !== Ve && this instanceof t ? i : e; return o.apply( r ? n : this, arguments ) } }( e, t, n ); return bo( ( p ? Gr : yo )( m, v ), e, t ) } function Fi ( e, t, n, r ) { return void 0 === e || Os( e, Ce[n] ) && !Se.call( r, n ) ? t : e } function ji ( e, t, n, r, i, o ) { return Ws( e ) && Ws( t ) && ( o.set( t, e ), kr( e, t, void 0, ji, o ), o.delete( t ) ), e } function Gi ( e ) { return Vs( e ) ? void 0 : e } function Wi ( e, t, n, r, i, o ) { var s = 1 & n, u = e.length, l = t.length; if ( u != l && !( s && l > u ) ) return !1; var a = o.get( e ); if ( a && o.get( t ) ) return a == t; var c = -1, f = !0, h = 2 & n ? new Ln : void 0; for ( o.set( e, t ), o.set( t, e ); ++c < u; ) { var d = e[c], _ = t[c]; if ( r ) var p = s ? r( _, d, c, t, e, o ) : r( d, _, c, e, t, o ); if ( void 0 !== p ) { if ( p ) continue; f = !1; break } if ( h ) { if ( !mt( t, ( function ( e, t ) { if ( !Nt( h, t ) && ( d === e || i( d, e, n, r, o ) ) ) return h.push( t ) } ) ) ) { f = !1; break } } else if ( d !== _ && !i( d, _, n, r, o ) ) { f = !1; break } } return o.delete( e ), o.delete( t ), f } function Bi ( e ) { return Co( po( e, void 0, Uo ), e + "" ) } function Yi ( e ) { return hr( e, Tu, eo ) } function zi ( e ) { return hr( e, Cu, to ) } var Vi = gn ? function ( e ) { return gn.get( e ) } : Xu; function Ki ( e ) { for ( var t = e.name + "", n = yn[t], r = Se.call( yn, t ) ? n.length : 0; r--; ) { var i = n[r], o = i.func; if ( null == o || o == e ) return i.name } return t } function $i ( e ) { return ( Se.call( In, "placeholder" ) ? In : e ).placeholder } function Ji () { var e = In.iteratee || Vu; return e = e === Vu ? Er : e, arguments.length ? e( arguments[0], arguments[1] ) : e } function Xi ( e, t ) { var n, r, i = e.__data__; return ( "string" == ( r = typeof ( n = t ) ) || "number" == r || "symbol" == r || "boolean" == r ? "__proto__" !== n : null === n ) ? i["string" == typeof t ? "string" : "hash"] : i.map } function Qi ( e ) { for ( var t = Tu( e ), n = t.length; n--; ) { var r = t[n], i = e[r]; t[n] = [r, i, ho( i )] } return t } function Zi ( e, t ) { var n = function ( e, t ) { return null == e ? void 0 : e[t] }( e, t ); return br( n ) ? n : void 0 } var eo = en ? function ( e ) { return null == e ? [] : ( e = pe( e ), ct( en( e ), ( function ( t ) { return Ke.call( e, t ) } ) ) ) } : il, to = en ? function ( e ) { for ( var t = []; e; )_t( t, eo( e ) ), e = Ye( e ); return t } : il, no = dr; function ro ( e, t, n ) { for ( var r = -1, i = ( t = ui( t, e ) ).length, o = !1; ++r < i; ) { var s = wo( t[r] ); if ( !( o = null != e && n( e, s ) ) ) break; e = e[s] } return o || ++r != i ? o : !!( i = null == e ? 0 : e.length ) && Gs( i ) && so( s, i ) && ( Ps( e ) || Ns( e ) ) } function io ( e ) { return "function" != typeof e.constructor || fo( e ) ? {} : On( Ye( e ) ) } function oo ( e ) { return Ps( e ) || Ns( e ) || !!( Xe && e && e[Xe] ) } function so ( e, t ) { var n = typeof e; return !!( t = null == t ? 9007199254740991 : t ) && ( "number" == n || "symbol" != n && le.test( e ) ) && e > -1 && e % 1 == 0 && e < t } function uo ( e, t, n ) { if ( !Ws( n ) ) return !1; var r = typeof t; return !!( "number" == r ? Ds( n ) && so( t, n.length ) : "string" == r && t in n ) && Os( n[t], e ) } function lo ( e, t ) { if ( Ps( e ) ) return !1; var n = typeof e; return !( "number" != n && "symbol" != n && "boolean" != n && null != e && !Xs( e ) ) || ( B.test( e ) || !W.test( e ) || null != t && e in pe( t ) ) } function ao ( e ) { var t = Ki( e ), n = In[t]; if ( "function" != typeof n || !( t in Nn.prototype ) ) return !1; if ( e === n ) return !0; var r = Vi( n ); return !!r && e === r[0] } ( hn && no( new hn( new ArrayBuffer( 1 ) ) ) != S || dn && no( new dn ) != p || _n && "[object Promise]" != no( _n.resolve() ) || pn && no( new pn ) != y || vn && no( new vn ) != b ) && ( no = function ( e ) { var t = dr( e ), n = t == m ? e.constructor : void 0, r = n ? Ro( n ) : ""; if ( r ) switch ( r ) { case Tn: return S; case Cn: return p; case bn: return "[object Promise]"; case En: return y; case Sn: return b }return t } ); var co = be ? Fs : ol; function fo ( e ) { var t = e && e.constructor; return e === ( "function" == typeof t && t.prototype || Ce ) } function ho ( e ) { return e == e && !Ws( e ) } function _o ( e, t ) { return function ( n ) { return null != n && ( n[e] === t && ( void 0 !== t || e in pe( n ) ) ) } } function po ( e, t, n ) { return t = sn( void 0 === t ? e.length - 1 : t, 0 ), function () { for ( var i = arguments, o = -1, s = sn( i.length - t, 0 ), u = r( s ); ++o < s; )u[o] = i[t + o]; o = -1; for ( var l = r( t + 1 ); ++o < t; )l[o] = i[o]; return l[t] = n( u ), ot( e, this, l ) } } function vo ( e, t ) { return t.length < 2 ? e : fr( e, Yr( t, 0, -1 ) ) } function mo ( e, t ) { for ( var n = e.length, r = un( t.length, n ), i = mi( e ); r--; ) { var o = t[r]; e[r] = so( o, n ) ? i[o] : void 0 } return e } function go ( e, t ) { if ( ( "constructor" !== t || "function" != typeof e[t] ) && "__proto__" != t ) return e[t] } var yo = Eo( Gr ), To = Xt || function ( e, t ) { return Ve.setTimeout( e, t ) }, Co = Eo( Wr ); function bo ( e, t, n ) { var r = t + ""; return Co( e, function ( e, t ) { var n = t.length; if ( !n ) return e; var r = n - 1; return t[r] = ( n > 1 ? "& " : "" ) + t[r], t = t.join( n > 2 ? ", " : " " ), e.replace( X, "{\n/* [wrapped with " + t + "] */\n" ) }( r, function ( e, t ) { return ut( u, ( function ( n ) { var r = "_." + n[0]; t & n[1] && !ft( e, r ) && e.push( r ) } ) ), e.sort() }( function ( e ) { var t = e.match( Q ); return t ? t[1].split( Z ) : [] }( r ), n ) ) ) } function Eo ( e ) { var t = 0, n = 0; return function () { var r = ln(), i = 16 - ( r - n ); if ( n = r, i > 0 ) { if ( ++t >= 800 ) return arguments[0] } else t = 0; return e.apply( void 0, arguments ) } } function So ( e, t ) { var n = -1, r = e.length, i = r - 1; for ( t = void 0 === t ? r : t; ++n < t; ) { var o = Lr( n, i ), s = e[o]; e[o] = e[n], e[n] = s } return e.length = t, e } var Ao = function ( e ) { var t = Es( e, ( function ( e ) { return 500 === n.size && n.clear(), e } ) ), n = t.cache; return t }( ( function ( e ) { var t = []; return 46 === e.charCodeAt( 0 ) && t.push( "" ), e.replace( Y, ( function ( e, n, r, i ) { t.push( r ? i.replace( te, "$1" ) : n || e ) } ) ), t } ) ); function wo ( e ) { if ( "string" == typeof e || Xs( e ) ) return e; var t = e + ""; return "0" == t && 1 / e == -1 / 0 ? "-0" : t } function Ro ( e ) { if ( null != e ) { try { return Ee.call( e ) } catch ( e ) { } try { return e + "" } catch ( e ) { } } return "" } function Io ( e ) { if ( e instanceof Nn ) return e.clone(); var t = new xn( e.__wrapped__, e.__chain__ ); return t.__actions__ = mi( e.__actions__ ), t.__index__ = e.__index__, t.__values__ = e.__values__, t } var Oo = qr( ( function ( e, t ) { return Ls( e ) ? Zn( e, or( t, 1, Ls, !0 ) ) : [] } ) ), ko = qr( ( function ( e, t ) { var n = Ho( t ); return Ls( n ) && ( n = void 0 ), Ls( e ) ? Zn( e, or( t, 1, Ls, !0 ), Ji( n, 2 ) ) : [] } ) ), xo = qr( ( function ( e, t ) { var n = Ho( t ); return Ls( n ) && ( n = void 0 ), Ls( e ) ? Zn( e, or( t, 1, Ls, !0 ), void 0, n ) : [] } ) ); function No ( e, t, n ) { var r = null == e ? 0 : e.length; if ( !r ) return -1; var i = null == n ? 0 : ru( n ); return i < 0 && ( i = sn( r + i, 0 ) ), Tt( e, Ji( t, 3 ), i ) } function Po ( e, t, n ) { var r = null == e ? 0 : e.length; if ( !r ) return -1; var i = r - 1; return void 0 !== n && ( i = ru( n ), i = n < 0 ? sn( r + i, 0 ) : un( i, r - 1 ) ), Tt( e, Ji( t, 3 ), i, !0 ) } function Uo ( e ) { return ( null == e ? 0 : e.length ) ? or( e, 1 ) : [] } function Do ( e ) { return e && e.length ? e[0] : void 0 } var Lo = qr( ( function ( e ) { var t = dt( e, oi ); return t.length && t[0] === e[0] ? mr( t ) : [] } ) ), Mo = qr( ( function ( e ) { var t = Ho( e ), n = dt( e, oi ); return t === Ho( n ) ? t = void 0 : n.pop(), n.length && n[0] === e[0] ? mr( n, Ji( t, 2 ) ) : [] } ) ), qo = qr( ( function ( e ) { var t = Ho( e ), n = dt( e, oi ); return ( t = "function" == typeof t ? t : void 0 ) && n.pop(), n.length && n[0] === e[0] ? mr( n, void 0, t ) : [] } ) ); function Ho ( e ) { var t = null == e ? 0 : e.length; return t ? e[t - 1] : void 0 } var Fo = qr( jo ); function jo ( e, t ) { return e && e.length && t && t.length ? Ur( e, t ) : e } var Go = Bi( ( function ( e, t ) { var n = null == e ? 0 : e.length, r = Kn( e, t ); return Dr( e, dt( t, ( function ( e ) { return so( e, n ) ? +e : e } ) ).sort( _i ) ), r } ) ); function Wo ( e ) { return null == e ? e : fn.call( e ) } var Bo = qr( ( function ( e ) { return Qr( or( e, 1, Ls, !0 ) ) } ) ), Yo = qr( ( function ( e ) { var t = Ho( e ); return Ls( t ) && ( t = void 0 ), Qr( or( e, 1, Ls, !0 ), Ji( t, 2 ) ) } ) ), zo = qr( ( function ( e ) { var t = Ho( e ); return t = "function" == typeof t ? t : void 0, Qr( or( e, 1, Ls, !0 ), void 0, t ) } ) ); function Vo ( e ) { if ( !e || !e.length ) return []; var t = 0; return e = ct( e, ( function ( e ) { if ( Ls( e ) ) return t = sn( e.length, t ), !0 } ) ), Ot( t, ( function ( t ) { return dt( e, At( t ) ) } ) ) } function Ko ( e, t ) { if ( !e || !e.length ) return []; var n = Vo( e ); return null == t ? n : dt( n, ( function ( e ) { return ot( t, void 0, e ) } ) ) } var $o = qr( ( function ( e, t ) { return Ls( e ) ? Zn( e, t ) : [] } ) ), Jo = qr( ( function ( e ) { return ri( ct( e, Ls ) ) } ) ), Xo = qr( ( function ( e ) { var t = Ho( e ); return Ls( t ) && ( t = void 0 ), ri( ct( e, Ls ), Ji( t, 2 ) ) } ) ), Qo = qr( ( function ( e ) { var t = Ho( e ); return t = "function" == typeof t ? t : void 0, ri( ct( e, Ls ), void 0, t ) } ) ), Zo = qr( Vo ); var es = qr( ( function ( e ) { var t = e.length, n = t > 1 ? e[t - 1] : void 0; return n = "function" == typeof n ? ( e.pop(), n ) : void 0, Ko( e, n ) } ) ); function ts ( e ) { var t = In( e ); return t.__chain__ = !0, t } function ns ( e, t ) { return t( e ) } var rs = Bi( ( function ( e ) { var t = e.length, n = t ? e[0] : 0, r = this.__wrapped__, i = function ( t ) { return Kn( t, e ) }; return !( t > 1 || this.__actions__.length ) && r instanceof Nn && so( n ) ? ( ( r = r.slice( n, +n + ( t ? 1 : 0 ) ) ).__actions__.push( { func: ns, args: [i], thisArg: void 0 } ), new xn( r, this.__chain__ ).thru( ( function ( e ) { return t && !e.length && e.push( void 0 ), e } ) ) ) : this.thru( i ) } ) ); var is = yi( ( function ( e, t, n ) { Se.call( e, n ) ? ++e[n] : Vn( e, n, 1 ) } ) ); var os = wi( No ), ss = wi( Po ); function us ( e, t ) { return ( Ps( e ) ? ut : er )( e, Ji( t, 3 ) ) } function ls ( e, t ) { return ( Ps( e ) ? lt : tr )( e, Ji( t, 3 ) ) } var as = yi( ( function ( e, t, n ) { Se.call( e, n ) ? e[n].push( t ) : Vn( e, n, [t] ) } ) ); var cs = qr( ( function ( e, t, n ) { var i = -1, o = "function" == typeof t, s = Ds( e ) ? r( e.length ) : []; return er( e, ( function ( e ) { s[++i] = o ? ot( t, e, n ) : gr( e, t, n ) } ) ), s } ) ), fs = yi( ( function ( e, t, n ) { Vn( e, n, t ) } ) ); function hs ( e, t ) { return ( Ps( e ) ? dt : Rr )( e, Ji( t, 3 ) ) } var ds = yi( ( function ( e, t, n ) { e[n ? 0 : 1].push( t ) } ), ( function () { return [[], []] } ) ); var _s = qr( ( function ( e, t ) { if ( null == e ) return []; var n = t.length; return n > 1 && uo( e, t[0], t[1] ) ? t = [] : n > 2 && uo( t[0], t[1], t[2] ) && ( t = [t[0]] ), Nr( e, or( t, 1 ), [] ) } ) ), ps = Jt || function () { return Ve.Date.now() }; function vs ( e, t, n ) { return t = n ? void 0 : t, Hi( e, 128, void 0, void 0, void 0, void 0, t = e && null == t ? e.length : t ) } function ms ( e, t ) { var n; if ( "function" != typeof t ) throw new ge( o ); return e = ru( e ), function () { return --e > 0 && ( n = t.apply( this, arguments ) ), e <= 1 && ( t = void 0 ), n } } var gs = qr( ( function ( e, t, n ) { var r = 1; if ( n.length ) { var i = Gt( n, $i( gs ) ); r |= 32 } return Hi( e, r, t, n, i ) } ) ), ys = qr( ( function ( e, t, n ) { var r = 3; if ( n.length ) { var i = Gt( n, $i( ys ) ); r |= 32 } return Hi( t, r, e, n, i ) } ) ); function Ts ( e, t, n ) { var r, i, s, u, l, a, c = 0, f = !1, h = !1, d = !0; if ( "function" != typeof e ) throw new ge( o ); function _ ( t ) { var n = r, o = i; return r = i = void 0, c = t, u = e.apply( o, n ) } function p ( e ) { return c = e, l = To( m, t ), f ? _( e ) : u } function v ( e ) { var n = e - a; return void 0 === a || n >= t || n < 0 || h && e - c >= s } function m () { var e = ps(); if ( v( e ) ) return g( e ); l = To( m, function ( e ) { var n = t - ( e - a ); return h ? un( n, s - ( e - c ) ) : n }( e ) ) } function g ( e ) { return l = void 0, d && r ? _( e ) : ( r = i = void 0, u ) } function y () { var e = ps(), n = v( e ); if ( r = arguments, i = this, a = e, n ) { if ( void 0 === l ) return p( a ); if ( h ) return ci( l ), l = To( m, t ), _( a ) } return void 0 === l && ( l = To( m, t ) ), u } return t = ou( t ) || 0, Ws( n ) && ( f = !!n.leading, s = ( h = "maxWait" in n ) ? sn( ou( n.maxWait ) || 0, t ) : s, d = "trailing" in n ? !!n.trailing : d ), y.cancel = function () { void 0 !== l && ci( l ), c = 0, r = a = i = l = void 0 }, y.flush = function () { return void 0 === l ? u : g( ps() ) }, y } var Cs = qr( ( function ( e, t ) { return Qn( e, 1, t ) } ) ), bs = qr( ( function ( e, t, n ) { return Qn( e, ou( t ) || 0, n ) } ) ); function Es ( e, t ) { if ( "function" != typeof e || null != t && "function" != typeof t ) throw new ge( o ); var n = function () { var r = arguments, i = t ? t.apply( this, r ) : r[0], o = n.cache; if ( o.has( i ) ) return o.get( i ); var s = e.apply( this, r ); return n.cache = o.set( i, s ) || o, s }; return n.cache = new ( Es.Cache || Dn ), n } function Ss ( e ) { if ( "function" != typeof e ) throw new ge( o ); return function () { var t = arguments; switch ( t.length ) { case 0: return !e.call( this ); case 1: return !e.call( this, t[0] ); case 2: return !e.call( this, t[0], t[1] ); case 3: return !e.call( this, t[0], t[1], t[2] ) }return !e.apply( this, t ) } } Es.Cache = Dn; var As = li( ( function ( e, t ) { var n = ( t = 1 == t.length && Ps( t[0] ) ? dt( t[0], kt( Ji() ) ) : dt( or( t, 1 ), kt( Ji() ) ) ).length; return qr( ( function ( r ) { for ( var i = -1, o = un( r.length, n ); ++i < o; )r[i] = t[i].call( this, r[i] ); return ot( e, this, r ) } ) ) } ) ), ws = qr( ( function ( e, t ) { return Hi( e, 32, void 0, t, Gt( t, $i( ws ) ) ) } ) ), Rs = qr( ( function ( e, t ) { return Hi( e, 64, void 0, t, Gt( t, $i( Rs ) ) ) } ) ), Is = Bi( ( function ( e, t ) { return Hi( e, 256, void 0, void 0, void 0, t ) } ) ); function Os ( e, t ) { return e === t || e != e && t != t } var ks = Ui( _r ), xs = Ui( ( function ( e, t ) { return e >= t } ) ), Ns = yr( function () { return arguments }() ) ? yr : function ( e ) { return Bs( e ) && Se.call( e, "callee" ) && !Ke.call( e, "callee" ) }, Ps = r.isArray, Us = Ze ? kt( Ze ) : function ( e ) { return Bs( e ) && dr( e ) == E }; function Ds ( e ) { return null != e && Gs( e.length ) && !Fs( e ) } function Ls ( e ) { return Bs( e ) && Ds( e ) } var Ms = tn || ol, qs = et ? kt( et ) : function ( e ) { return Bs( e ) && dr( e ) == f }; function Hs ( e ) { if ( !Bs( e ) ) return !1; var t = dr( e ); return t == h || "[object DOMException]" == t || "string" == typeof e.message && "string" == typeof e.name && !Vs( e ) } function Fs ( e ) { if ( !Ws( e ) ) return !1; var t = dr( e ); return t == d || t == _ || "[object AsyncFunction]" == t || "[object Proxy]" == t } function js ( e ) { return "number" == typeof e && e == ru( e ) } function Gs ( e ) { return "number" == typeof e && e > -1 && e % 1 == 0 && e <= 9007199254740991 } function Ws ( e ) { var t = typeof e; return null != e && ( "object" == t || "function" == t ) } function Bs ( e ) { return null != e && "object" == typeof e } var Ys = tt ? kt( tt ) : function ( e ) { return Bs( e ) && no( e ) == p }; function zs ( e ) { return "number" == typeof e || Bs( e ) && dr( e ) == v } function Vs ( e ) { if ( !Bs( e ) || dr( e ) != m ) return !1; var t = Ye( e ); if ( null === t ) return !0; var n = Se.call( t, "constructor" ) && t.constructor; return "function" == typeof n && n instanceof n && Ee.call( n ) == Ie } var Ks = nt ? kt( nt ) : function ( e ) { return Bs( e ) && dr( e ) == g }; var $s = rt ? kt( rt ) : function ( e ) { return Bs( e ) && no( e ) == y }; function Js ( e ) { return "string" == typeof e || !Ps( e ) && Bs( e ) && dr( e ) == T } function Xs ( e ) { return "symbol" == typeof e || Bs( e ) && dr( e ) == C } var Qs = it ? kt( it ) : function ( e ) { return Bs( e ) && Gs( e.length ) && !!Fe[dr( e )] }; var Zs = Ui( wr ), eu = Ui( ( function ( e, t ) { return e <= t } ) ); function tu ( e ) { if ( !e ) return []; if ( Ds( e ) ) return Js( e ) ? zt( e ) : mi( e ); if ( Qe && e[Qe] ) return function ( e ) { for ( var t, n = []; !( t = e.next() ).done; )n.push( t.value ); return n }( e[Qe]() ); var t = no( e ); return ( t == p ? Ft : t == y ? Wt : Ou )( e ) } function nu ( e ) { return e ? ( e = ou( e ) ) === 1 / 0 || e === -1 / 0 ? 17976931348623157e292 * ( e < 0 ? -1 : 1 ) : e == e ? e : 0 : 0 === e ? e : 0 } function ru ( e ) { var t = nu( e ), n = t % 1; return t == t ? n ? t - n : t : 0 } function iu ( e ) { return e ? $n( ru( e ), 0, 4294967295 ) : 0 } function ou ( e ) { if ( "number" == typeof e ) return e; if ( Xs( e ) ) return NaN; if ( Ws( e ) ) { var t = "function" == typeof e.valueOf ? e.valueOf() : e; e = Ws( t ) ? t + "" : t } if ( "string" != typeof e ) return 0 === e ? e : +e; e = e.replace( K, "" ); var n = oe.test( e ); return n || ue.test( e ) ? Be( e.slice( 2 ), n ? 2 : 8 ) : ie.test( e ) ? NaN : +e } function su ( e ) { return gi( e, Cu( e ) ) } function uu ( e ) { return null == e ? "" : Xr( e ) } var lu = Ti( ( function ( e, t ) { if ( fo( t ) || Ds( t ) ) gi( t, Tu( t ), e ); else for ( var n in t ) Se.call( t, n ) && Wn( e, n, t[n] ) } ) ), au = Ti( ( function ( e, t ) { gi( t, Cu( t ), e ) } ) ), cu = Ti( ( function ( e, t, n, r ) { gi( t, Cu( t ), e, r ) } ) ), fu = Ti( ( function ( e, t, n, r ) { gi( t, Tu( t ), e, r ) } ) ), hu = Bi( Kn ); var du = qr( ( function ( e, t ) { e = pe( e ); var n = -1, r = t.length, i = r > 2 ? t[2] : void 0; for ( i && uo( t[0], t[1], i ) && ( r = 1 ); ++n < r; )for ( var o = t[n], s = Cu( o ), u = -1, l = s.length; ++u < l; ) { var a = s[u], c = e[a]; ( void 0 === c || Os( c, Ce[a] ) && !Se.call( e, a ) ) && ( e[a] = o[a] ) } return e } ) ), _u = qr( ( function ( e ) { return e.push( void 0, ji ), ot( Eu, void 0, e ) } ) ); function pu ( e, t, n ) { var r = null == e ? void 0 : fr( e, t ); return void 0 === r ? n : r } function vu ( e, t ) { return null != e && ro( e, t, vr ) } var mu = Oi( ( function ( e, t, n ) { null != t && "function" != typeof t.toString && ( t = Re.call( t ) ), e[t] = n } ), Wu( zu ) ), gu = Oi( ( function ( e, t, n ) { null != t && "function" != typeof t.toString && ( t = Re.call( t ) ), Se.call( e, t ) ? e[t].push( n ) : e[t] = [n] } ), Ji ), yu = qr( gr ); function Tu ( e ) { return Ds( e ) ? qn( e ) : Sr( e ) } function Cu ( e ) { return Ds( e ) ? qn( e, !0 ) : Ar( e ) } var bu = Ti( ( function ( e, t, n ) { kr( e, t, n ) } ) ), Eu = Ti( ( function ( e, t, n, r ) { kr( e, t, n, r ) } ) ), Su = Bi( ( function ( e, t ) { var n = {}; if ( null == e ) return n; var r = !1; t = dt( t, ( function ( t ) { return t = ui( t, e ), r || ( r = t.length > 1 ), t } ) ), gi( e, zi( e ), n ), r && ( n = Jn( n, 7, Gi ) ); for ( var i = t.length; i--; )Zr( n, t[i] ); return n } ) ); var Au = Bi( ( function ( e, t ) { return null == e ? {} : function ( e, t ) { return Pr( e, t, ( function ( t, n ) { return vu( e, n ) } ) ) }( e, t ) } ) ); function wu ( e, t ) { if ( null == e ) return {}; var n = dt( zi( e ), ( function ( e ) { return [e] } ) ); return t = Ji( t ), Pr( e, n, ( function ( e, n ) { return t( e, n[0] ) } ) ) } var Ru = qi( Tu ), Iu = qi( Cu ); function Ou ( e ) { return null == e ? [] : xt( e, Tu( e ) ) } var ku = Si( ( function ( e, t, n ) { return t = t.toLowerCase(), e + ( n ? xu( t ) : t ) } ) ); function xu ( e ) { return Hu( uu( e ).toLowerCase() ) } function Nu ( e ) { return ( e = uu( e ) ) && e.replace( ae, Lt ).replace( Pe, "" ) } var Pu = Si( ( function ( e, t, n ) { return e + ( n ? "-" : "" ) + t.toLowerCase() } ) ), Uu = Si( ( function ( e, t, n ) { return e + ( n ? " " : "" ) + t.toLowerCase() } ) ), Du = Ei( "toLowerCase" ); var Lu = Si( ( function ( e, t, n ) { return e + ( n ? "_" : "" ) + t.toLowerCase() } ) ); var Mu = Si( ( function ( e, t, n ) { return e + ( n ? " " : "" ) + Hu( t ) } ) ); var qu = Si( ( function ( e, t, n ) { return e + ( n ? " " : "" ) + t.toUpperCase() } ) ), Hu = Ei( "toUpperCase" ); function Fu ( e, t, n ) { return e = uu( e ), void 0 === ( t = n ? void 0 : t ) ? function ( e ) { return Me.test( e ) }( e ) ? function ( e ) { return e.match( De ) || [] }( e ) : function ( e ) { return e.match( ee ) || [] }( e ) : e.match( t ) || [] } var ju = qr( ( function ( e, t ) { try { return ot( e, void 0, t ) } catch ( e ) { return Hs( e ) ? e : new he( e ) } } ) ), Gu = Bi( ( function ( e, t ) { return ut( t, ( function ( t ) { t = wo( t ), Vn( e, t, gs( e[t], e ) ) } ) ), e } ) ); function Wu ( e ) { return function () { return e } } var Bu = Ri(), Yu = Ri( !0 ); function zu ( e ) { return e } function Vu ( e ) { return Er( "function" == typeof e ? e : Jn( e, 1 ) ) } var Ku = qr( ( function ( e, t ) { return function ( n ) { return gr( n, e, t ) } } ) ), $u = qr( ( function ( e, t ) { return function ( n ) { return gr( e, n, t ) } } ) ); function Ju ( e, t, n ) { var r = Tu( t ), i = cr( t, r ); null != n || Ws( t ) && ( i.length || !r.length ) || ( n = t, t = e, e = this, i = cr( t, Tu( t ) ) ); var o = !( Ws( n ) && "chain" in n && !n.chain ), s = Fs( e ); return ut( i, ( function ( n ) { var r = t[n]; e[n] = r, s && ( e.prototype[n] = function () { var t = this.__chain__; if ( o || t ) { var n = e( this.__wrapped__ ), i = n.__actions__ = mi( this.__actions__ ); return i.push( { func: r, args: arguments, thisArg: e } ), n.__chain__ = t, n } return r.apply( e, _t( [this.value()], arguments ) ) } ) } ) ), e } function Xu () { } var Qu = xi( dt ), Zu = xi( at ), el = xi( mt ); function tl ( e ) { return lo( e ) ? At( wo( e ) ) : function ( e ) { return function ( t ) { return fr( t, e ) } }( e ) } var nl = Pi(), rl = Pi( !0 ); function il () { return [] } function ol () { return !1 } var sl = ki( ( function ( e, t ) { return e + t } ), 0 ), ul = Li( "ceil" ), ll = ki( ( function ( e, t ) { return e / t } ), 1 ), al = Li( "floor" ); var cl, fl = ki( ( function ( e, t ) { return e * t } ), 1 ), hl = Li( "round" ), dl = ki( ( function ( e, t ) { return e - t } ), 0 ); return In.after = function ( e, t ) { if ( "function" != typeof t ) throw new ge( o ); return e = ru( e ), function () { if ( --e < 1 ) return t.apply( this, arguments ) } }, In.ary = vs, In.assign = lu, In.assignIn = au, In.assignInWith = cu, In.assignWith = fu, In.at = hu, In.before = ms, In.bind = gs, In.bindAll = Gu, In.bindKey = ys, In.castArray = function () { if ( !arguments.length ) return []; var e = arguments[0]; return Ps( e ) ? e : [e] }, In.chain = ts, In.chunk = function ( e, t, n ) { t = ( n ? uo( e, t, n ) : void 0 === t ) ? 1 : sn( ru( t ), 0 ); var i = null == e ? 0 : e.length; if ( !i || t < 1 ) return []; for ( var o = 0, s = 0, u = r( Qt( i / t ) ); o < i; )u[s++] = Yr( e, o, o += t ); return u }, In.compact = function ( e ) { for ( var t = -1, n = null == e ? 0 : e.length, r = 0, i = []; ++t < n; ) { var o = e[t]; o && ( i[r++] = o ) } return i }, In.concat = function () { var e = arguments.length; if ( !e ) return []; for ( var t = r( e - 1 ), n = arguments[0], i = e; i--; )t[i - 1] = arguments[i]; return _t( Ps( n ) ? mi( n ) : [n], or( t, 1 ) ) }, In.cond = function ( e ) { var t = null == e ? 0 : e.length, n = Ji(); return e = t ? dt( e, ( function ( e ) { if ( "function" != typeof e[1] ) throw new ge( o ); return [n( e[0] ), e[1]] } ) ) : [], qr( ( function ( n ) { for ( var r = -1; ++r < t; ) { var i = e[r]; if ( ot( i[0], this, n ) ) return ot( i[1], this, n ) } } ) ) }, In.conforms = function ( e ) { return function ( e ) { var t = Tu( e ); return function ( n ) { return Xn( n, e, t ) } }( Jn( e, 1 ) ) }, In.constant = Wu, In.countBy = is, In.create = function ( e, t ) { var n = On( e ); return null == t ? n : zn( n, t ) }, In.curry = function e ( t, n, r ) { var i = Hi( t, 8, void 0, void 0, void 0, void 0, void 0, n = r ? void 0 : n ); return i.placeholder = e.placeholder, i }, In.curryRight = function e ( t, n, r ) { var i = Hi( t, 16, void 0, void 0, void 0, void 0, void 0, n = r ? void 0 : n ); return i.placeholder = e.placeholder, i }, In.debounce = Ts, In.defaults = du, In.defaultsDeep = _u, In.defer = Cs, In.delay = bs, In.difference = Oo, In.differenceBy = ko, In.differenceWith = xo, In.drop = function ( e, t, n ) { var r = null == e ? 0 : e.length; return r ? Yr( e, ( t = n || void 0 === t ? 1 : ru( t ) ) < 0 ? 0 : t, r ) : [] }, In.dropRight = function ( e, t, n ) { var r = null == e ? 0 : e.length; return r ? Yr( e, 0, ( t = r - ( t = n || void 0 === t ? 1 : ru( t ) ) ) < 0 ? 0 : t ) : [] }, In.dropRightWhile = function ( e, t ) { return e && e.length ? ti( e, Ji( t, 3 ), !0, !0 ) : [] }, In.dropWhile = function ( e, t ) { return e && e.length ? ti( e, Ji( t, 3 ), !0 ) : [] }, In.fill = function ( e, t, n, r ) { var i = null == e ? 0 : e.length; return i ? ( n && "number" != typeof n && uo( e, t, n ) && ( n = 0, r = i ), function ( e, t, n, r ) { var i = e.length; for ( ( n = ru( n ) ) < 0 && ( n = -n > i ? 0 : i + n ), ( r = void 0 === r || r > i ? i : ru( r ) ) < 0 && ( r += i ), r = n > r ? 0 : iu( r ); n < r; )e[n++] = t; return e }( e, t, n, r ) ) : [] }, In.filter = function ( e, t ) { return ( Ps( e ) ? ct : ir )( e, Ji( t, 3 ) ) }, In.flatMap = function ( e, t ) { return or( hs( e, t ), 1 ) }, In.flatMapDeep = function ( e, t ) { return or( hs( e, t ), 1 / 0 ) }, In.flatMapDepth = function ( e, t, n ) { return n = void 0 === n ? 1 : ru( n ), or( hs( e, t ), n ) }, In.flatten = Uo, In.flattenDeep = function ( e ) { return ( null == e ? 0 : e.length ) ? or( e, 1 / 0 ) : [] }, In.flattenDepth = function ( e, t ) { return ( null == e ? 0 : e.length ) ? or( e, t = void 0 === t ? 1 : ru( t ) ) : [] }, In.flip = function ( e ) { return Hi( e, 512 ) }, In.flow = Bu, In.flowRight = Yu, In.fromPairs = function ( e ) { for ( var t = -1, n = null == e ? 0 : e.length, r = {}; ++t < n; ) { var i = e[t]; r[i[0]] = i[1] } return r }, In.functions = function ( e ) { return null == e ? [] : cr( e, Tu( e ) ) }, In.functionsIn = function ( e ) { return null == e ? [] : cr( e, Cu( e ) ) }, In.groupBy = as, In.initial = function ( e ) { return ( null == e ? 0 : e.length ) ? Yr( e, 0, -1 ) : [] }, In.intersection = Lo, In.intersectionBy = Mo, In.intersectionWith = qo, In.invert = mu, In.invertBy = gu, In.invokeMap = cs, In.iteratee = Vu, In.keyBy = fs, In.keys = Tu, In.keysIn = Cu, In.map = hs, In.mapKeys = function ( e, t ) { var n = {}; return t = Ji( t, 3 ), lr( e, ( function ( e, r, i ) { Vn( n, t( e, r, i ), e ) } ) ), n }, In.mapValues = function ( e, t ) { var n = {}; return t = Ji( t, 3 ), lr( e, ( function ( e, r, i ) { Vn( n, r, t( e, r, i ) ) } ) ), n }, In.matches = function ( e ) { return Ir( Jn( e, 1 ) ) }, In.matchesProperty = function ( e, t ) { return Or( e, Jn( t, 1 ) ) }, In.memoize = Es, In.merge = bu, In.mergeWith = Eu, In.method = Ku, In.methodOf = $u, In.mixin = Ju, In.negate = Ss, In.nthArg = function ( e ) { return e = ru( e ), qr( ( function ( t ) { return xr( t, e ) } ) ) }, In.omit = Su, In.omitBy = function ( e, t ) { return wu( e, Ss( Ji( t ) ) ) }, In.once = function ( e ) { return ms( 2, e ) }, In.orderBy = function ( e, t, n, r ) { return null == e ? [] : ( Ps( t ) || ( t = null == t ? [] : [t] ), Ps( n = r ? void 0 : n ) || ( n = null == n ? [] : [n] ), Nr( e, t, n ) ) }, In.over = Qu, In.overArgs = As, In.overEvery = Zu, In.overSome = el, In.partial = ws, In.partialRight = Rs, In.partition = ds, In.pick = Au, In.pickBy = wu, In.property = tl, In.propertyOf = function ( e ) { return function ( t ) { return null == e ? void 0 : fr( e, t ) } }, In.pull = Fo, In.pullAll = jo, In.pullAllBy = function ( e, t, n ) { return e && e.length && t && t.length ? Ur( e, t, Ji( n, 2 ) ) : e }, In.pullAllWith = function ( e, t, n ) { return e && e.length && t && t.length ? Ur( e, t, void 0, n ) : e }, In.pullAt = Go, In.range = nl, In.rangeRight = rl, In.rearg = Is, In.reject = function ( e, t ) { return ( Ps( e ) ? ct : ir )( e, Ss( Ji( t, 3 ) ) ) }, In.remove = function ( e, t ) { var n = []; if ( !e || !e.length ) return n; var r = -1, i = [], o = e.length; for ( t = Ji( t, 3 ); ++r < o; ) { var s = e[r]; t( s, r, e ) && ( n.push( s ), i.push( r ) ) } return Dr( e, i ), n }, In.rest = function ( e, t ) { if ( "function" != typeof e ) throw new ge( o ); return qr( e, t = void 0 === t ? t : ru( t ) ) }, In.reverse = Wo, In.sampleSize = function ( e, t, n ) { return t = ( n ? uo( e, t, n ) : void 0 === t ) ? 1 : ru( t ), ( Ps( e ) ? Fn : Fr )( e, t ) }, In.set = function ( e, t, n ) { return null == e ? e : jr( e, t, n ) }, In.setWith = function ( e, t, n, r ) { return r = "function" == typeof r ? r : void 0, null == e ? e : jr( e, t, n, r ) }, In.shuffle = function ( e ) { return ( Ps( e ) ? jn : Br )( e ) }, In.slice = function ( e, t, n ) { var r = null == e ? 0 : e.length; return r ? ( n && "number" != typeof n && uo( e, t, n ) ? ( t = 0, n = r ) : ( t = null == t ? 0 : ru( t ), n = void 0 === n ? r : ru( n ) ), Yr( e, t, n ) ) : [] }, In.sortBy = _s, In.sortedUniq = function ( e ) { return e && e.length ? $r( e ) : [] }, In.sortedUniqBy = function ( e, t ) { return e && e.length ? $r( e, Ji( t, 2 ) ) : [] }, In.split = function ( e, t, n ) { return n && "number" != typeof n && uo( e, t, n ) && ( t = n = void 0 ), ( n = void 0 === n ? 4294967295 : n >>> 0 ) ? ( e = uu( e ) ) && ( "string" == typeof t || null != t && !Ks( t ) ) && !( t = Xr( t ) ) && Ht( e ) ? ai( zt( e ), 0, n ) : e.split( t, n ) : [] }, In.spread = function ( e, t ) { if ( "function" != typeof e ) throw new ge( o ); return t = null == t ? 0 : sn( ru( t ), 0 ), qr( ( function ( n ) { var r = n[t], i = ai( n, 0, t ); return r && _t( i, r ), ot( e, this, i ) } ) ) }, In.tail = function ( e ) { var t = null == e ? 0 : e.length; return t ? Yr( e, 1, t ) : [] }, In.take = function ( e, t, n ) { return e && e.length ? Yr( e, 0, ( t = n || void 0 === t ? 1 : ru( t ) ) < 0 ? 0 : t ) : [] }, In.takeRight = function ( e, t, n ) { var r = null == e ? 0 : e.length; return r ? Yr( e, ( t = r - ( t = n || void 0 === t ? 1 : ru( t ) ) ) < 0 ? 0 : t, r ) : [] }, In.takeRightWhile = function ( e, t ) { return e && e.length ? ti( e, Ji( t, 3 ), !1, !0 ) : [] }, In.takeWhile = function ( e, t ) { return e && e.length ? ti( e, Ji( t, 3 ) ) : [] }, In.tap = function ( e, t ) { return t( e ), e }, In.throttle = function ( e, t, n ) { var r = !0, i = !0; if ( "function" != typeof e ) throw new ge( o ); return Ws( n ) && ( r = "leading" in n ? !!n.leading : r, i = "trailing" in n ? !!n.trailing : i ), Ts( e, t, { leading: r, maxWait: t, trailing: i } ) }, In.thru = ns, In.toArray = tu, In.toPairs = Ru, In.toPairsIn = Iu, In.toPath = function ( e ) { return Ps( e ) ? dt( e, wo ) : Xs( e ) ? [e] : mi( Ao( uu( e ) ) ) }, In.toPlainObject = su, In.transform = function ( e, t, n ) { var r = Ps( e ), i = r || Ms( e ) || Qs( e ); if ( t = Ji( t, 4 ), null == n ) { var o = e && e.constructor; n = i ? r ? new o : [] : Ws( e ) && Fs( o ) ? On( Ye( e ) ) : {} } return ( i ? ut : lr )( e, ( function ( e, r, i ) { return t( n, e, r, i ) } ) ), n }, In.unary = function ( e ) { return vs( e, 1 ) }, In.union = Bo, In.unionBy = Yo, In.unionWith = zo, In.uniq = function ( e ) { return e && e.length ? Qr( e ) : [] }, In.uniqBy = function ( e, t ) { return e && e.length ? Qr( e, Ji( t, 2 ) ) : [] }, In.uniqWith = function ( e, t ) { return t = "function" == typeof t ? t : void 0, e && e.length ? Qr( e, void 0, t ) : [] }, In.unset = function ( e, t ) { return null == e || Zr( e, t ) }, In.unzip = Vo, In.unzipWith = Ko, In.update = function ( e, t, n ) { return null == e ? e : ei( e, t, si( n ) ) }, In.updateWith = function ( e, t, n, r ) { return r = "function" == typeof r ? r : void 0, null == e ? e : ei( e, t, si( n ), r ) }, In.values = Ou, In.valuesIn = function ( e ) { return null == e ? [] : xt( e, Cu( e ) ) }, In.without = $o, In.words = Fu, In.wrap = function ( e, t ) { return ws( si( t ), e ) }, In.xor = Jo, In.xorBy = Xo, In.xorWith = Qo, In.zip = Zo, In.zipObject = function ( e, t ) { return ii( e || [], t || [], Wn ) }, In.zipObjectDeep = function ( e, t ) { return ii( e || [], t || [], jr ) }, In.zipWith = es, In.entries = Ru, In.entriesIn = Iu, In.extend = au, In.extendWith = cu, Ju( In, In ), In.add = sl, In.attempt = ju, In.camelCase = ku, In.capitalize = xu, In.ceil = ul, In.clamp = function ( e, t, n ) { return void 0 === n && ( n = t, t = void 0 ), void 0 !== n && ( n = ( n = ou( n ) ) == n ? n : 0 ), void 0 !== t && ( t = ( t = ou( t ) ) == t ? t : 0 ), $n( ou( e ), t, n ) }, In.clone = function ( e ) { return Jn( e, 4 ) }, In.cloneDeep = function ( e ) { return Jn( e, 5 ) }, In.cloneDeepWith = function ( e, t ) { return Jn( e, 5, t = "function" == typeof t ? t : void 0 ) }, In.cloneWith = function ( e, t ) { return Jn( e, 4, t = "function" == typeof t ? t : void 0 ) }, In.conformsTo = function ( e, t ) { return null == t || Xn( e, t, Tu( t ) ) }, In.deburr = Nu, In.defaultTo = function ( e, t ) { return null == e || e != e ? t : e }, In.divide = ll, In.endsWith = function ( e, t, n ) { e = uu( e ), t = Xr( t ); var r = e.length, i = n = void 0 === n ? r : $n( ru( n ), 0, r ); return ( n -= t.length ) >= 0 && e.slice( n, i ) == t }, In.eq = Os, In.escape = function ( e ) { return ( e = uu( e ) ) && H.test( e ) ? e.replace( M, Mt ) : e }, In.escapeRegExp = function ( e ) { return ( e = uu( e ) ) && V.test( e ) ? e.replace( z, "\\$&" ) : e }, In.every = function ( e, t, n ) { var r = Ps( e ) ? at : nr; return n && uo( e, t, n ) && ( t = void 0 ), r( e, Ji( t, 3 ) ) }, In.find = os, In.findIndex = No, In.findKey = function ( e, t ) { return yt( e, Ji( t, 3 ), lr ) }, In.findLast = ss, In.findLastIndex = Po, In.findLastKey = function ( e, t ) { return yt( e, Ji( t, 3 ), ar ) }, In.floor = al, In.forEach = us, In.forEachRight = ls, In.forIn = function ( e, t ) { return null == e ? e : sr( e, Ji( t, 3 ), Cu ) }, In.forInRight = function ( e, t ) { return null == e ? e : ur( e, Ji( t, 3 ), Cu ) }, In.forOwn = function ( e, t ) { return e && lr( e, Ji( t, 3 ) ) }, In.forOwnRight = function ( e, t ) { return e && ar( e, Ji( t, 3 ) ) }, In.get = pu, In.gt = ks, In.gte = xs, In.has = function ( e, t ) { return null != e && ro( e, t, pr ) }, In.hasIn = vu, In.head = Do, In.identity = zu, In.includes = function ( e, t, n, r ) { e = Ds( e ) ? e : Ou( e ), n = n && !r ? ru( n ) : 0; var i = e.length; return n < 0 && ( n = sn( i + n, 0 ) ), Js( e ) ? n <= i && e.indexOf( t, n ) > -1 : !!i && Ct( e, t, n ) > -1 }, In.indexOf = function ( e, t, n ) { var r = null == e ? 0 : e.length; if ( !r ) return -1; var i = null == n ? 0 : ru( n ); return i < 0 && ( i = sn( r + i, 0 ) ), Ct( e, t, i ) }, In.inRange = function ( e, t, n ) { return t = nu( t ), void 0 === n ? ( n = t, t = 0 ) : n = nu( n ), function ( e, t, n ) { return e >= un( t, n ) && e < sn( t, n ) }( e = ou( e ), t, n ) }, In.invoke = yu, In.isArguments = Ns, In.isArray = Ps, In.isArrayBuffer = Us, In.isArrayLike = Ds, In.isArrayLikeObject = Ls, In.isBoolean = function ( e ) { return !0 === e || !1 === e || Bs( e ) && dr( e ) == c }, In.isBuffer = Ms, In.isDate = qs, In.isElement = function ( e ) { return Bs( e ) && 1 === e.nodeType && !Vs( e ) }, In.isEmpty = function ( e ) { if ( null == e ) return !0; if ( Ds( e ) && ( Ps( e ) || "string" == typeof e || "function" == typeof e.splice || Ms( e ) || Qs( e ) || Ns( e ) ) ) return !e.length; var t = no( e ); if ( t == p || t == y ) return !e.size; if ( fo( e ) ) return !Sr( e ).length; for ( var n in e ) if ( Se.call( e, n ) ) return !1; return !0 }, In.isEqual = function ( e, t ) { return Tr( e, t ) }, In.isEqualWith = function ( e, t, n ) { var r = ( n = "function" == typeof n ? n : void 0 ) ? n( e, t ) : void 0; return void 0 === r ? Tr( e, t, void 0, n ) : !!r }, In.isError = Hs, In.isFinite = function ( e ) { return "number" == typeof e && nn( e ) }, In.isFunction = Fs, In.isInteger = js, In.isLength = Gs, In.isMap = Ys, In.isMatch = function ( e, t ) { return e === t || Cr( e, t, Qi( t ) ) }, In.isMatchWith = function ( e, t, n ) { return n = "function" == typeof n ? n : void 0, Cr( e, t, Qi( t ), n ) }, In.isNaN = function ( e ) { return zs( e ) && e != +e }, In.isNative = function ( e ) { if ( co( e ) ) throw new he( "Unsupported core-js use. Try https://npms.io/search?q=ponyfill." ); return br( e ) }, In.isNil = function ( e ) { return null == e }, In.isNull = function ( e ) { return null === e }, In.isNumber = zs, In.isObject = Ws, In.isObjectLike = Bs, In.isPlainObject = Vs, In.isRegExp = Ks, In.isSafeInteger = function ( e ) { return js( e ) && e >= -9007199254740991 && e <= 9007199254740991 }, In.isSet = $s, In.isString = Js, In.isSymbol = Xs, In.isTypedArray = Qs, In.isUndefined = function ( e ) { return void 0 === e }, In.isWeakMap = function ( e ) { return Bs( e ) && no( e ) == b }, In.isWeakSet = function ( e ) { return Bs( e ) && "[object WeakSet]" == dr( e ) }, In.join = function ( e, t ) { return null == e ? "" : rn.call( e, t ) }, In.kebabCase = Pu, In.last = Ho, In.lastIndexOf = function ( e, t, n ) { var r = null == e ? 0 : e.length; if ( !r ) return -1; var i = r; return void 0 !== n && ( i = ( i = ru( n ) ) < 0 ? sn( r + i, 0 ) : un( i, r - 1 ) ), t == t ? function ( e, t, n ) { for ( var r = n + 1; r--; )if ( e[r] === t ) return r; return r }( e, t, i ) : Tt( e, Et, i, !0 ) }, In.lowerCase = Uu, In.lowerFirst = Du, In.lt = Zs, In.lte = eu, In.max = function ( e ) { return e && e.length ? rr( e, zu, _r ) : void 0 }, In.maxBy = function ( e, t ) { return e && e.length ? rr( e, Ji( t, 2 ), _r ) : void 0 }, In.mean = function ( e ) { return St( e, zu ) }, In.meanBy = function ( e, t ) { return St( e, Ji( t, 2 ) ) }, In.min = function ( e ) { return e && e.length ? rr( e, zu, wr ) : void 0 }, In.minBy = function ( e, t ) { return e && e.length ? rr( e, Ji( t, 2 ), wr ) : void 0 }, In.stubArray = il, In.stubFalse = ol, In.stubObject = function () { return {} }, In.stubString = function () { return "" }, In.stubTrue = function () { return !0 }, In.multiply = fl, In.nth = function ( e, t ) { return e && e.length ? xr( e, ru( t ) ) : void 0 }, In.noConflict = function () { return Ve._ === this && ( Ve._ = Oe ), this }, In.noop = Xu, In.now = ps, In.pad = function ( e, t, n ) { e = uu( e ); var r = ( t = ru( t ) ) ? Yt( e ) : 0; if ( !t || r >= t ) return e; var i = ( t - r ) / 2; return Ni( Zt( i ), n ) + e + Ni( Qt( i ), n ) }, In.padEnd = function ( e, t, n ) { e = uu( e ); var r = ( t = ru( t ) ) ? Yt( e ) : 0; return t && r < t ? e + Ni( t - r, n ) : e }, In.padStart = function ( e, t, n ) { e = uu( e ); var r = ( t = ru( t ) ) ? Yt( e ) : 0; return t && r < t ? Ni( t - r, n ) + e : e }, In.parseInt = function ( e, t, n ) { return n || null == t ? t = 0 : t && ( t = +t ), an( uu( e ).replace( $, "" ), t || 0 ) }, In.random = function ( e, t, n ) { if ( n && "boolean" != typeof n && uo( e, t, n ) && ( t = n = void 0 ), void 0 === n && ( "boolean" == typeof t ? ( n = t, t = void 0 ) : "boolean" == typeof e && ( n = e, e = void 0 ) ), void 0 === e && void 0 === t ? ( e = 0, t = 1 ) : ( e = nu( e ), void 0 === t ? ( t = e, e = 0 ) : t = nu( t ) ), e > t ) { var r = e; e = t, t = r } if ( n || e % 1 || t % 1 ) { var i = cn(); return un( e + i * ( t - e + We( "1e-" + ( ( i + "" ).length - 1 ) ) ), t ) } return Lr( e, t ) }, In.reduce = function ( e, t, n ) { var r = Ps( e ) ? pt : Rt, i = arguments.length < 3; return r( e, Ji( t, 4 ), n, i, er ) }, In.reduceRight = function ( e, t, n ) { var r = Ps( e ) ? vt : Rt, i = arguments.length < 3; return r( e, Ji( t, 4 ), n, i, tr ) }, In.repeat = function ( e, t, n ) { return t = ( n ? uo( e, t, n ) : void 0 === t ) ? 1 : ru( t ), Mr( uu( e ), t ) }, In.replace = function () { var e = arguments, t = uu( e[0] ); return e.length < 3 ? t : t.replace( e[1], e[2] ) }, In.result = function ( e, t, n ) { var r = -1, i = ( t = ui( t, e ) ).length; for ( i || ( i = 1, e = void 0 ); ++r < i; ) { var o = null == e ? void 0 : e[wo( t[r] )]; void 0 === o && ( r = i, o = n ), e = Fs( o ) ? o.call( e ) : o } return e }, In.round = hl, In.runInContext = e, In.sample = function ( e ) { return ( Ps( e ) ? Hn : Hr )( e ) }, In.size = function ( e ) { if ( null == e ) return 0; if ( Ds( e ) ) return Js( e ) ? Yt( e ) : e.length; var t = no( e ); return t == p || t == y ? e.size : Sr( e ).length }, In.snakeCase = Lu, In.some = function ( e, t, n ) { var r = Ps( e ) ? mt : zr; return n && uo( e, t, n ) && ( t = void 0 ), r( e, Ji( t, 3 ) ) }, In.sortedIndex = function ( e, t ) { return Vr( e, t ) }, In.sortedIndexBy = function ( e, t, n ) { return Kr( e, t, Ji( n, 2 ) ) }, In.sortedIndexOf = function ( e, t ) { var n = null == e ? 0 : e.length; if ( n ) { var r = Vr( e, t ); if ( r < n && Os( e[r], t ) ) return r } return -1 }, In.sortedLastIndex = function ( e, t ) { return Vr( e, t, !0 ) }, In.sortedLastIndexBy = function ( e, t, n ) { return Kr( e, t, Ji( n, 2 ), !0 ) }, In.sortedLastIndexOf = function ( e, t ) { if ( null == e ? 0 : e.length ) { var n = Vr( e, t, !0 ) - 1; if ( Os( e[n], t ) ) return n } return -1 }, In.startCase = Mu, In.startsWith = function ( e, t, n ) { return e = uu( e ), n = null == n ? 0 : $n( ru( n ), 0, e.length ), t = Xr( t ), e.slice( n, n + t.length ) == t }, In.subtract = dl, In.sum = function ( e ) { return e && e.length ? It( e, zu ) : 0 }, In.sumBy = function ( e, t ) { return e && e.length ? It( e, Ji( t, 2 ) ) : 0 }, In.template = function ( e, t, n ) { var r = In.templateSettings; n && uo( e, t, n ) && ( t = void 0 ), e = uu( e ), t = cu( {}, t, r, Fi ); var i, o, s = cu( {}, t.imports, r.imports, Fi ), u = Tu( s ), l = xt( s, u ), a = 0, c = t.interpolate || ce, f = "__p += '", h = ve( ( t.escape || ce ).source + "|" + c.source + "|" + ( c === G ? ne : ce ).source + "|" + ( t.evaluate || ce ).source + "|$", "g" ), d = "//# sourceURL=" + ( Se.call( t, "sourceURL" ) ? ( t.sourceURL + "" ).replace( /[\r\n]/g, " " ) : "lodash.templateSources[" + ++He + "]" ) + "\n"; e.replace( h, ( function ( t, n, r, s, u, l ) { return r || ( r = s ), f += e.slice( a, l ).replace( fe, qt ), n && ( i = !0, f += "' +\n__e(" + n + ") +\n'" ), u && ( o = !0, f += "';\n" + u + ";\n__p += '" ), r && ( f += "' +\n((__t = (" + r + ")) == null ? '' : __t) +\n'" ), a = l + t.length, t } ) ), f += "';\n"; var _ = Se.call( t, "variable" ) && t.variable; _ || ( f = "with (obj) {\n" + f + "\n}\n" ), f = ( o ? f.replace( P, "" ) : f ).replace( U, "$1" ).replace( D, "$1;" ), f = "function(" + ( _ || "obj" ) + ") {\n" + ( _ ? "" : "obj || (obj = {});\n" ) + "var __t, __p = ''" + ( i ? ", __e = _.escape" : "" ) + ( o ? ", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n" : ";\n" ) + f + "return __p\n}"; var p = ju( ( function () { return de( u, d + "return " + f ).apply( void 0, l ) } ) ); if ( p.source = f, Hs( p ) ) throw p; return p }, In.times = function ( e, t ) { if ( ( e = ru( e ) ) < 1 || e > 9007199254740991 ) return []; var n = 4294967295, r = un( e, 4294967295 ); e -= 4294967295; for ( var i = Ot( r, t = Ji( t ) ); ++n < e; )t( n ); return i }, In.toFinite = nu, In.toInteger = ru, In.toLength = iu, In.toLower = function ( e ) { return uu( e ).toLowerCase() }, In.toNumber = ou, In.toSafeInteger = function ( e ) { return e ? $n( ru( e ), -9007199254740991, 9007199254740991 ) : 0 === e ? e : 0 }, In.toString = uu, In.toUpper = function ( e ) { return uu( e ).toUpperCase() }, In.trim = function ( e, t, n ) { if ( ( e = uu( e ) ) && ( n || void 0 === t ) ) return e.replace( K, "" ); if ( !e || !( t = Xr( t ) ) ) return e; var r = zt( e ), i = zt( t ); return ai( r, Pt( r, i ), Ut( r, i ) + 1 ).join( "" ) }, In.trimEnd = function ( e, t, n ) { if ( ( e = uu( e ) ) && ( n || void 0 === t ) ) return e.replace( J, "" ); if ( !e || !( t = Xr( t ) ) ) return e; var r = zt( e ); return ai( r, 0, Ut( r, zt( t ) ) + 1 ).join( "" ) }, In.trimStart = function ( e, t, n ) { if ( ( e = uu( e ) ) && ( n || void 0 === t ) ) return e.replace( $, "" ); if ( !e || !( t = Xr( t ) ) ) return e; var r = zt( e ); return ai( r, Pt( r, zt( t ) ) ).join( "" ) }, In.truncate = function ( e, t ) { var n = 30, r = "..."; if ( Ws( t ) ) { var i = "separator" in t ? t.separator : i; n = "length" in t ? ru( t.length ) : n, r = "omission" in t ? Xr( t.omission ) : r } var o = ( e = uu( e ) ).length; if ( Ht( e ) ) { var s = zt( e ); o = s.length } if ( n >= o ) return e; var u = n - Yt( r ); if ( u < 1 ) return r; var l = s ? ai( s, 0, u ).join( "" ) : e.slice( 0, u ); if ( void 0 === i ) return l + r; if ( s && ( u += l.length - u ), Ks( i ) ) { if ( e.slice( u ).search( i ) ) { var a, c = l; for ( i.global || ( i = ve( i.source, uu( re.exec( i ) ) + "g" ) ), i.lastIndex = 0; a = i.exec( c ); )var f = a.index; l = l.slice( 0, void 0 === f ? u : f ) } } else if ( e.indexOf( Xr( i ), u ) != u ) { var h = l.lastIndexOf( i ); h > -1 && ( l = l.slice( 0, h ) ) } return l + r }, In.unescape = function ( e ) { return ( e = uu( e ) ) && q.test( e ) ? e.replace( L, Vt ) : e }, In.uniqueId = function ( e ) { var t = ++Ae; return uu( e ) + t }, In.upperCase = qu, In.upperFirst = Hu, In.each = us, In.eachRight = ls, In.first = Do, Ju( In, ( cl = {}, lr( In, ( function ( e, t ) { Se.call( In.prototype, t ) || ( cl[t] = e ) } ) ), cl ), { chain: !1 } ), In.VERSION = "4.17.15", ut( ["bind", "bindKey", "curry", "curryRight", "partial", "partialRight"], ( function ( e ) { In[e].placeholder = In } ) ), ut( ["drop", "take"], ( function ( e, t ) { Nn.prototype[e] = function ( n ) { n = void 0 === n ? 1 : sn( ru( n ), 0 ); var r = this.__filtered__ && !t ? new Nn( this ) : this.clone(); return r.__filtered__ ? r.__takeCount__ = un( n, r.__takeCount__ ) : r.__views__.push( { size: un( n, 4294967295 ), type: e + ( r.__dir__ < 0 ? "Right" : "" ) } ), r }, Nn.prototype[e + "Right"] = function ( t ) { return this.reverse()[e]( t ).reverse() } } ) ), ut( ["filter", "map", "takeWhile"], ( function ( e, t ) { var n = t + 1, r = 1 == n || 3 == n; Nn.prototype[e] = function ( e ) { var t = this.clone(); return t.__iteratees__.push( { iteratee: Ji( e, 3 ), type: n } ), t.__filtered__ = t.__filtered__ || r, t } } ) ), ut( ["head", "last"], ( function ( e, t ) { var n = "take" + ( t ? "Right" : "" ); Nn.prototype[e] = function () { return this[n]( 1 ).value()[0] } } ) ), ut( ["initial", "tail"], ( function ( e, t ) { var n = "drop" + ( t ? "" : "Right" ); Nn.prototype[e] = function () { return this.__filtered__ ? new Nn( this ) : this[n]( 1 ) } } ) ), Nn.prototype.compact = function () { return this.filter( zu ) }, Nn.prototype.find = function ( e ) { return this.filter( e ).head() }, Nn.prototype.findLast = function ( e ) { return this.reverse().find( e ) }, Nn.prototype.invokeMap = qr( ( function ( e, t ) { return "function" == typeof e ? new Nn( this ) : this.map( ( function ( n ) { return gr( n, e, t ) } ) ) } ) ), Nn.prototype.reject = function ( e ) { return this.filter( Ss( Ji( e ) ) ) }, Nn.prototype.slice = function ( e, t ) { e = ru( e ); var n = this; return n.__filtered__ && ( e > 0 || t < 0 ) ? new Nn( n ) : ( e < 0 ? n = n.takeRight( -e ) : e && ( n = n.drop( e ) ), void 0 !== t && ( n = ( t = ru( t ) ) < 0 ? n.dropRight( -t ) : n.take( t - e ) ), n ) }, Nn.prototype.takeRightWhile = function ( e ) { return this.reverse().takeWhile( e ).reverse() }, Nn.prototype.toArray = function () { return this.take( 4294967295 ) }, lr( Nn.prototype, ( function ( e, t ) { var n = /^(?:filter|find|map|reject)|While$/.test( t ), r = /^(?:head|last)$/.test( t ), i = In[r ? "take" + ( "last" == t ? "Right" : "" ) : t], o = r || /^find/.test( t ); i && ( In.prototype[t] = function () { var t = this.__wrapped__, s = r ? [1] : arguments, u = t instanceof Nn, l = s[0], a = u || Ps( t ), c = function ( e ) { var t = i.apply( In, _t( [e], s ) ); return r && f ? t[0] : t }; a && n && "function" == typeof l && 1 != l.length && ( u = a = !1 ); var f = this.__chain__, h = !!this.__actions__.length, d = o && !f, _ = u && !h; if ( !o && a ) { t = _ ? t : new Nn( this ); var p = e.apply( t, s ); return p.__actions__.push( { func: ns, args: [c], thisArg: void 0 } ), new xn( p, f ) } return d && _ ? e.apply( this, s ) : ( p = this.thru( c ), d ? r ? p.value()[0] : p.value() : p ) } ) } ) ), ut( ["pop", "push", "shift", "sort", "splice", "unshift"], ( function ( e ) { var t = ye[e], n = /^(?:push|sort|unshift)$/.test( e ) ? "tap" : "thru", r = /^(?:pop|shift)$/.test( e ); In.prototype[e] = function () { var e = arguments; if ( r && !this.__chain__ ) { var i = this.value(); return t.apply( Ps( i ) ? i : [], e ) } return this[n]( ( function ( n ) { return t.apply( Ps( n ) ? n : [], e ) } ) ) } } ) ), lr( Nn.prototype, ( function ( e, t ) { var n = In[t]; if ( n ) { var r = n.name + ""; Se.call( yn, r ) || ( yn[r] = [] ), yn[r].push( { name: t, func: n } ) } } ) ), yn[Ii( void 0, 2 ).name] = [{ name: "wrapper", func: void 0 }], Nn.prototype.clone = function () { var e = new Nn( this.__wrapped__ ); return e.__actions__ = mi( this.__actions__ ), e.__dir__ = this.__dir__, e.__filtered__ = this.__filtered__, e.__iteratees__ = mi( this.__iteratees__ ), e.__takeCount__ = this.__takeCount__, e.__views__ = mi( this.__views__ ), e }, Nn.prototype.reverse = function () { if ( this.__filtered__ ) { var e = new Nn( this ); e.__dir__ = -1, e.__filtered__ = !0 } else ( e = this.clone() ).__dir__ *= -1; return e }, Nn.prototype.value = function () { var e = this.__wrapped__.value(), t = this.__dir__, n = Ps( e ), r = t < 0, i = n ? e.length : 0, o = function ( e, t, n ) { var r = -1, i = n.length; for ( ; ++r < i; ) { var o = n[r], s = o.size; switch ( o.type ) { case "drop": e += s; break; case "dropRight": t -= s; break; case "take": t = un( t, e + s ); break; case "takeRight": e = sn( e, t - s ) } } return { start: e, end: t } }( 0, i, this.__views__ ), s = o.start, u = o.end, l = u - s, a = r ? u : s - 1, c = this.__iteratees__, f = c.length, h = 0, d = un( l, this.__takeCount__ ); if ( !n || !r && i == l && d == l ) return ni( e, this.__actions__ ); var _ = []; e: for ( ; l-- && h < d; ) { for ( var p = -1, v = e[a += t]; ++p < f; ) { var m = c[p], g = m.iteratee, y = m.type, T = g( v ); if ( 2 == y ) v = T; else if ( !T ) { if ( 1 == y ) continue e; break e } } _[h++] = v } return _ }, In.prototype.at = rs, In.prototype.chain = function () { return ts( this ) }, In.prototype.commit = function () { return new xn( this.value(), this.__chain__ ) }, In.prototype.next = function () { void 0 === this.__values__ && ( this.__values__ = tu( this.value() ) ); var e = this.__index__ >= this.__values__.length; return { done: e, value: e ? void 0 : this.__values__[this.__index__++] } }, In.prototype.plant = function ( e ) { for ( var t, n = this; n instanceof kn; ) { var r = Io( n ); r.__index__ = 0, r.__values__ = void 0, t ? i.__wrapped__ = r : t = r; var i = r; n = n.__wrapped__ } return i.__wrapped__ = e, t }, In.prototype.reverse = function () { var e = this.__wrapped__; if ( e instanceof Nn ) { var t = e; return this.__actions__.length && ( t = new Nn( this ) ), ( t = t.reverse() ).__actions__.push( { func: ns, args: [Wo], thisArg: void 0 } ), new xn( t, this.__chain__ ) } return this.thru( Wo ) }, In.prototype.toJSON = In.prototype.valueOf = In.prototype.value = function () { return ni( this.__wrapped__, this.__actions__ ) }, In.prototype.first = In.prototype.head, Qe && ( In.prototype[Qe] = function () { return this } ), In }(); Ve._ = Kt, void 0 === ( i = function () { return Kt }.call( t, n, t, r ) ) || ( r.exports = i ) } ).call( this )
    } ).call( this, n( 4 ), n( 5 )( e ) )
}, function ( e, t, n ) { e.exports = function e ( t, n, r ) { function i ( s, u ) { if ( !n[s] ) { if ( !t[s] ) { if ( o ) return o( s, !0 ); var l = new Error( "Cannot find module '" + s + "'" ); throw l.code = "MODULE_NOT_FOUND", l } var a = n[s] = { exports: {} }; t[s][0].call( a.exports, ( function ( e ) { return i( t[s][1][e] || e ) } ), a, a.exports, e, t, n, r ) } return n[s].exports } for ( var o = !1, s = 0; s < r.length; s++ )i( r[s] ); return i }( { 1: [function ( e, t, n ) { "use strict"; var r = e( "./Utils" ), i = e( "./Constants" ), o = e( "./Grammar" ), s = e( "./URI" ), u = e( "./Socket" ), l = e( "./Exceptions" ); n.settings = { authorization_user: null, password: null, realm: null, ha1: null, display_name: null, uri: null, contact_uri: null, instance_id: null, use_preloaded_route: !1, session_timers: !0, session_timers_refresh_method: i.UPDATE, no_answer_timeout: 60, register: !0, register_expires: 600, registrar_server: null, sockets: null, connection_recovery_max_interval: i.CONNECTION_RECOVERY_MAX_INTERVAL, connection_recovery_min_interval: i.CONNECTION_RECOVERY_MIN_INTERVAL, via_host: "".concat( r.createRandomToken( 12 ), ".invalid" ) }; var a = { mandatory: { sockets: function ( e ) { var t = []; if ( u.isSocket( e ) ) t.push( { socket: e } ); else { if ( !Array.isArray( e ) || !e.length ) return; var n = !0, r = !1, i = void 0; try { for ( var o, s = e[Symbol.iterator](); !( n = ( o = s.next() ).done ); n = !0 ) { var l = o.value; Object.prototype.hasOwnProperty.call( l, "socket" ) && u.isSocket( l.socket ) ? t.push( l ) : u.isSocket( l ) && t.push( { socket: l } ) } } catch ( e ) { r = !0, i = e } finally { try { n || null == s.return || s.return() } finally { if ( r ) throw i } } } return t }, uri: function ( e ) { /^sip:/i.test( e ) || ( e = "".concat( i.SIP, ":" ).concat( e ) ); var t = s.parse( e ); return t && t.user ? t : void 0 } }, optional: { authorization_user: function ( e ) { return -1 === o.parse( '"'.concat( e, '"' ), "quoted_string" ) ? void 0 : e }, user_agent: function ( e ) { if ( "string" == typeof e ) return e }, connection_recovery_max_interval: function ( e ) { if ( r.isDecimal( e ) ) { var t = Number( e ); if ( t > 0 ) return t } }, connection_recovery_min_interval: function ( e ) { if ( r.isDecimal( e ) ) { var t = Number( e ); if ( t > 0 ) return t } }, contact_uri: function ( e ) { if ( "string" == typeof e ) { var t = o.parse( e, "SIP_URI" ); if ( -1 !== t ) return t } }, display_name: function ( e ) { return e }, instance_id: function ( e ) { return /^uuid:/i.test( e ) && ( e = e.substr( 5 ) ), -1 === o.parse( e, "uuid" ) ? void 0 : e }, no_answer_timeout: function ( e ) { if ( r.isDecimal( e ) ) { var t = Number( e ); if ( t > 0 ) return t } }, session_timers: function ( e ) { if ( "boolean" == typeof e ) return e }, session_timers_refresh_method: function ( e ) { if ( "string" == typeof e && ( ( e = e.toUpperCase() ) === i.INVITE || e === i.UPDATE ) ) return e }, password: function ( e ) { return String( e ) }, realm: function ( e ) { return String( e ) }, ha1: function ( e ) { return String( e ) }, register: function ( e ) { if ( "boolean" == typeof e ) return e }, register_expires: function ( e ) { if ( r.isDecimal( e ) ) { var t = Number( e ); if ( t > 0 ) return t } }, registrar_server: function ( e ) { /^sip:/i.test( e ) || ( e = "".concat( i.SIP, ":" ).concat( e ) ); var t = s.parse( e ); return t ? t.user ? void 0 : t : void 0 }, use_preloaded_route: function ( e ) { if ( "boolean" == typeof e ) return e } } }; n.load = function ( e, t ) { for ( var n in a.mandatory ) { if ( !t.hasOwnProperty( n ) ) throw new l.ConfigurationError( n ); var i = t[n], o = a.mandatory[n]( i ); if ( void 0 === o ) throw new l.ConfigurationError( n, i ); e[n] = o } for ( var s in a.optional ) if ( t.hasOwnProperty( s ) ) { var u = t[s]; if ( r.isEmpty( u ) ) continue; var c = a.optional[s]( u ); if ( void 0 === c ) throw new l.ConfigurationError( s, u ); e[s] = c } } }, { "./Constants": 2, "./Exceptions": 6, "./Grammar": 7, "./Socket": 20, "./URI": 25, "./Utils": 26 }], 2: [function ( e, t, n ) { "use strict"; var r = e( "../package.json" ); t.exports = { USER_AGENT: "".concat( r.title, " " ).concat( r.version ), SIP: "sip", SIPS: "sips", causes: { CONNECTION_ERROR: "Connection Error", REQUEST_TIMEOUT: "Request Timeout", SIP_FAILURE_CODE: "SIP Failure Code", INTERNAL_ERROR: "Internal Error", BUSY: "Busy", REJECTED: "Rejected", REDIRECTED: "Redirected", UNAVAILABLE: "Unavailable", NOT_FOUND: "Not Found", ADDRESS_INCOMPLETE: "Address Incomplete", INCOMPATIBLE_SDP: "Incompatible SDP", MISSING_SDP: "Missing SDP", AUTHENTICATION_ERROR: "Authentication Error", BYE: "Terminated", WEBRTC_ERROR: "WebRTC Error", CANCELED: "Canceled", NO_ANSWER: "No Answer", EXPIRES: "Expires", NO_ACK: "No ACK", DIALOG_ERROR: "Dialog Error", USER_DENIED_MEDIA_ACCESS: "User Denied Media Access", BAD_MEDIA_DESCRIPTION: "Bad Media Description", RTP_TIMEOUT: "RTP Timeout" }, SIP_ERROR_CAUSES: { REDIRECTED: [300, 301, 302, 305, 380], BUSY: [486, 600], REJECTED: [403, 603], NOT_FOUND: [404, 604], UNAVAILABLE: [480, 410, 408, 430], ADDRESS_INCOMPLETE: [484, 424], INCOMPATIBLE_SDP: [488, 606], AUTHENTICATION_ERROR: [401, 407] }, ACK: "ACK", BYE: "BYE", CANCEL: "CANCEL", INFO: "INFO", INVITE: "INVITE", MESSAGE: "MESSAGE", NOTIFY: "NOTIFY", OPTIONS: "OPTIONS", REGISTER: "REGISTER", REFER: "REFER", UPDATE: "UPDATE", SUBSCRIBE: "SUBSCRIBE", REASON_PHRASE: { 100: "Trying", 180: "Ringing", 181: "Call Is Being Forwarded", 182: "Queued", 183: "Session Progress", 199: "Early Dialog Terminated", 200: "OK", 202: "Accepted", 204: "No Notification", 300: "Multiple Choices", 301: "Moved Permanently", 302: "Moved Temporarily", 305: "Use Proxy", 380: "Alternative Service", 400: "Bad Request", 401: "Unauthorized", 402: "Payment Required", 403: "Forbidden", 404: "Not Found", 405: "Method Not Allowed", 406: "Not Acceptable", 407: "Proxy Authentication Required", 408: "Request Timeout", 410: "Gone", 412: "Conditional Request Failed", 413: "Request Entity Too Large", 414: "Request-URI Too Long", 415: "Unsupported Media Type", 416: "Unsupported URI Scheme", 417: "Unknown Resource-Priority", 420: "Bad Extension", 421: "Extension Required", 422: "Session Interval Too Small", 423: "Interval Too Brief", 424: "Bad Location Information", 428: "Use Identity Header", 429: "Provide Referrer Identity", 430: "Flow Failed", 433: "Anonymity Disallowed", 436: "Bad Identity-Info", 437: "Unsupported Certificate", 438: "Invalid Identity Header", 439: "First Hop Lacks Outbound Support", 440: "Max-Breadth Exceeded", 469: "Bad Info Package", 470: "Consent Needed", 478: "Unresolvable Destination", 480: "Temporarily Unavailable", 481: "Call/Transaction Does Not Exist", 482: "Loop Detected", 483: "Too Many Hops", 484: "Address Incomplete", 485: "Ambiguous", 486: "Busy Here", 487: "Request Terminated", 488: "Not Acceptable Here", 489: "Bad Event", 491: "Request Pending", 493: "Undecipherable", 494: "Security Agreement Required", 500: "JsSIP Internal Error", 501: "Not Implemented", 502: "Bad Gateway", 503: "Service Unavailable", 504: "Server Time-out", 505: "Version Not Supported", 513: "Message Too Large", 580: "Precondition Failure", 600: "Busy Everywhere", 603: "Decline", 604: "Does Not Exist Anywhere", 606: "Not Acceptable" }, ALLOWED_METHODS: "INVITE,ACK,CANCEL,BYE,UPDATE,MESSAGE,OPTIONS,REFER,INFO,NOTIFY", ACCEPTED_BODY_TYPES: "application/sdp, application/dtmf-relay", MAX_FORWARDS: 69, SESSION_EXPIRES: 90, MIN_SESSION_EXPIRES: 60, CONNECTION_RECOVERY_MAX_INTERVAL: 30, CONNECTION_RECOVERY_MIN_INTERVAL: 2 } }, { "../package.json": 38 }], 3: [function ( e, t, n ) { "use strict"; function r ( e, t ) { for ( var n = 0; n < t.length; n++ ) { var r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && ( r.writable = !0 ), Object.defineProperty( e, r.key, r ) } } function i ( e, t, n ) { return t && r( e.prototype, t ), n && r( e, n ), e } var o = e( "./SIPMessage" ), s = e( "./Constants" ), u = e( "./Transactions" ), l = e( "./Dialog/RequestSender" ), a = e( "./Utils" ), c = e( "debug" )( "PIOPIY:Dialog" ), f = { STATUS_EARLY: 1, STATUS_CONFIRMED: 2 }; t.exports = function () { function e ( t, n, r ) { var i = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : f.STATUS_CONFIRMED; if ( function ( e, t ) { if ( !( e instanceof t ) ) throw new TypeError( "Cannot call a class as a function" ) }( this, e ), this._owner = t, this._ua = t._ua, this._uac_pending_reply = !1, this._uas_pending_reply = !1, !n.hasHeader( "contact" ) ) return { error: "unable to create a Dialog without Contact header field" }; n instanceof o.IncomingResponse && ( i = n.status_code < 200 ? f.STATUS_EARLY : f.STATUS_CONFIRMED ); var s = n.parseHeader( "contact" ); "UAS" === r ? ( this._id = { call_id: n.call_id, local_tag: n.to_tag, remote_tag: n.from_tag, toString: function () { return this.call_id + this.local_tag + this.remote_tag } }, this._state = i, this._remote_seqnum = n.cseq, this._local_uri = n.parseHeader( "to" ).uri, this._remote_uri = n.parseHeader( "from" ).uri, this._remote_target = s.uri, this._route_set = n.getHeaders( "record-route" ), this._ack_seqnum = this._remote_seqnum ) : "UAC" === r && ( this._id = { call_id: n.call_id, local_tag: n.from_tag, remote_tag: n.to_tag, toString: function () { return this.call_id + this.local_tag + this.remote_tag } }, this._state = i, this._local_seqnum = n.cseq, this._local_uri = n.parseHeader( "from" ).uri, this._remote_uri = n.parseHeader( "to" ).uri, this._remote_target = s.uri, this._route_set = n.getHeaders( "record-route" ).reverse(), this._ack_seqnum = null ), this._ua.newDialog( this ), c( "new ".concat( r, " dialog created with status " ).concat( this._state === f.STATUS_EARLY ? "EARLY" : "CONFIRMED" ) ) } return i( e, null, [{ key: "C", get: function () { return f } }] ), i( e, [{ key: "update", value: function ( e, t ) { this._state = f.STATUS_CONFIRMED, c( "dialog ".concat( this._id.toString(), "  changed to CONFIRMED state" ) ), "UAC" === t && ( this._route_set = e.getHeaders( "record-route" ).reverse() ) } }, { key: "terminate", value: function () { c( "dialog ".concat( this._id.toString(), " deleted" ) ), this._ua.destroyDialog( this ) } }, { key: "sendRequest", value: function ( e ) { var t = this, n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}, r = a.cloneArray( n.extraHeaders ), i = n.eventHandlers || {}, o = n.body || null, s = this._createRequest( e, r, o ); return i.onAuthenticated = function () { t._local_seqnum += 1 }, new l( this, s, i ).send(), s } }, { key: "receiveRequest", value: function ( e ) { this._checkInDialogRequest( e ) && ( e.method === s.ACK && null !== this._ack_seqnum ? this._ack_seqnum = null : e.method === s.INVITE && ( this._ack_seqnum = e.cseq ), this._owner.receiveRequest( e ) ) } }, { key: "_createRequest", value: function ( e, t, n ) { t = a.cloneArray( t ), this._local_seqnum || ( this._local_seqnum = Math.floor( 1e4 * Math.random() ) ); var r = e === s.CANCEL || e === s.ACK ? this._local_seqnum : this._local_seqnum += 1; return new o.OutgoingRequest( e, this._remote_target, this._ua, { cseq: r, call_id: this._id.call_id, from_uri: this._local_uri, from_tag: this._id.local_tag, to_uri: this._remote_uri, to_tag: this._id.remote_tag, route_set: this._route_set }, t, n ) } }, { key: "_checkInDialogRequest", value: function ( e ) { var t = this; if ( this._remote_seqnum ) if ( e.cseq < this._remote_seqnum ) { if ( e.method !== s.ACK ) return e.reply( 500 ), !1; if ( null === this._ack_seqnum || e.cseq !== this._ack_seqnum ) return !1 } else e.cseq > this._remote_seqnum && ( this._remote_seqnum = e.cseq ); else this._remote_seqnum = e.cseq; if ( e.method === s.INVITE || e.method === s.UPDATE && e.body ) { if ( !0 === this._uac_pending_reply ) e.reply( 491 ); else { if ( !0 === this._uas_pending_reply ) { var n = 1 + ( 10 * Math.random() | 0 ); return e.reply( 500, null, ["Retry-After:".concat( n )] ), !1 } this._uas_pending_reply = !0, e.server_transaction.on( "stateChanged", ( function n () { e.server_transaction.state !== u.C.STATUS_ACCEPTED && e.server_transaction.state !== u.C.STATUS_COMPLETED && e.server_transaction.state !== u.C.STATUS_TERMINATED || ( e.server_transaction.removeListener( "stateChanged", n ), t._uas_pending_reply = !1 ) } ) ) } e.hasHeader( "contact" ) && e.server_transaction.on( "stateChanged", ( function () { e.server_transaction.state === u.C.STATUS_ACCEPTED && ( t._remote_target = e.parseHeader( "contact" ).uri ) } ) ) } else e.method === s.NOTIFY && e.hasHeader( "contact" ) && e.server_transaction.on( "stateChanged", ( function () { e.server_transaction.state === u.C.STATUS_COMPLETED && ( t._remote_target = e.parseHeader( "contact" ).uri ) } ) ); return !0 } }, { key: "id", get: function () { return this._id } }, { key: "local_seqnum", get: function () { return this._local_seqnum }, set: function ( e ) { this._local_seqnum = e } }, { key: "owner", get: function () { return this._owner } }, { key: "uac_pending_reply", get: function () { return this._uac_pending_reply }, set: function ( e ) { this._uac_pending_reply = e } }, { key: "uas_pending_reply", get: function () { return this._uas_pending_reply } }] ), e }() }, { "./Constants": 2, "./Dialog/RequestSender": 4, "./SIPMessage": 19, "./Transactions": 22, "./Utils": 26, debug: 30 }], 4: [function ( e, t, n ) { "use strict"; function r ( e, t ) { for ( var n = 0; n < t.length; n++ ) { var r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && ( r.writable = !0 ), Object.defineProperty( e, r.key, r ) } } var i = e( "../Constants" ), o = e( "../Transactions" ), s = e( "../RTCSession" ), u = e( "../RequestSender" ), l = { onRequestTimeout: function () { }, onTransportError: function () { }, onSuccessResponse: function () { }, onErrorResponse: function () { }, onAuthenticated: function () { }, onDialogError: function () { } }; t.exports = function () { function e ( t, n, r ) { for ( var i in function ( e, t ) { if ( !( e instanceof t ) ) throw new TypeError( "Cannot call a class as a function" ) }( this, e ), this._dialog = t, this._ua = t._ua, this._request = n, this._eventHandlers = r, this._reattempt = !1, this._reattemptTimer = null, l ) Object.prototype.hasOwnProperty.call( l, i ) && ( this._eventHandlers[i] || ( this._eventHandlers[i] = l[i] ) ) } var t, n; return t = e, ( n = [{ key: "send", value: function () { var e = this, t = new u( this._ua, this._request, { onRequestTimeout: function () { e._eventHandlers.onRequestTimeout() }, onTransportError: function () { e._eventHandlers.onTransportError() }, onAuthenticated: function ( t ) { e._eventHandlers.onAuthenticated( t ) }, onReceiveResponse: function ( t ) { e._receiveResponse( t ) } } ); t.send(), ( this._request.method === i.INVITE || this._request.method === i.UPDATE && this._request.body ) && t.clientTransaction.state !== o.C.STATUS_TERMINATED && ( this._dialog.uac_pending_reply = !0, t.clientTransaction.on( "stateChanged", ( function n () { t.clientTransaction.state !== o.C.STATUS_ACCEPTED && t.clientTransaction.state !== o.C.STATUS_COMPLETED && t.clientTransaction.state !== o.C.STATUS_TERMINATED || ( t.clientTransaction.removeListener( "stateChanged", n ), e._dialog.uac_pending_reply = !1 ) } ) ) ) } }, { key: "_receiveResponse", value: function ( e ) { var t = this; 408 === e.status_code || 481 === e.status_code ? this._eventHandlers.onDialogError( e ) : e.method === i.INVITE && 491 === e.status_code ? this._reattempt ? e.status_code >= 200 && e.status_code < 300 ? this._eventHandlers.onSuccessResponse( e ) : e.status_code >= 300 && this._eventHandlers.onErrorResponse( e ) : ( this._request.cseq.value = this._dialog.local_seqnum += 1, this._reattemptTimer = setTimeout( ( function () { t._dialog.owner.status !== s.C.STATUS_TERMINATED && ( t._reattempt = !0, t._request_sender.send() ) } ), 1e3 ) ) : e.status_code >= 200 && e.status_code < 300 ? this._eventHandlers.onSuccessResponse( e ) : e.status_code >= 300 && this._eventHandlers.onErrorResponse( e ) } }, { key: "request", get: function () { return this._request } }] ) && r( t.prototype, n ), e }() }, { "../Constants": 2, "../RTCSession": 12, "../RequestSender": 18, "../Transactions": 22 }], 5: [function ( e, t, n ) { "use strict"; function r ( e, t ) { for ( var n = 0; n < t.length; n++ ) { var r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && ( r.writable = !0 ), Object.defineProperty( e, r.key, r ) } } var i = e( "./Utils" ), o = e( "debug" )( "PIOPIY:DigestAuthentication" ), s = e( "debug" )( "PIOPIY:ERROR:DigestAuthentication" ); s.log = console.warn.bind( console ), t.exports = function () { function e ( t ) { !function ( e, t ) { if ( !( e instanceof t ) ) throw new TypeError( "Cannot call a class as a function" ) }( this, e ), this._credentials = t, this._cnonce = null, this._nc = 0, this._ncHex = "00000000", this._algorithm = null, this._realm = null, this._nonce = null, this._opaque = null, this._stale = null, this._qop = null, this._method = null, this._uri = null, this._ha1 = null, this._response = null } var t, n; return t = e, ( n = [{ key: "get", value: function ( e ) { switch ( e ) { case "realm": return this._realm; case "ha1": return this._ha1; default: return void s( 'get() | cannot get "%s" parameter', e ) } } }, { key: "authenticate", value: function ( e, t ) { var n = e.method, r = e.ruri, u = e.body, l = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : null; if ( this._algorithm = t.algorithm, this._realm = t.realm, this._nonce = t.nonce, this._opaque = t.opaque, this._stale = t.stale, this._algorithm ) { if ( "MD5" !== this._algorithm ) return s( 'authenticate() | challenge with Digest algorithm different than "MD5", authentication aborted' ), !1 } else this._algorithm = "MD5"; if ( !this._nonce ) return s( "authenticate() | challenge without Digest nonce, authentication aborted" ), !1; if ( !this._realm ) return s( "authenticate() | challenge without Digest realm, authentication aborted" ), !1; if ( !this._credentials.password ) { if ( !this._credentials.ha1 ) return s( "authenticate() | no plain SIP password nor ha1 provided, authentication aborted" ), !1; if ( this._credentials.realm !== this._realm ) return s( 'authenticate() | no plain SIP password, and stored `realm` does not match the given `realm`, cannot authenticate [stored:"%s", given:"%s"]', this._credentials.realm, this._realm ), !1 } if ( t.qop ) if ( t.qop.indexOf( "auth-int" ) > -1 ) this._qop = "auth-int"; else { if ( !( t.qop.indexOf( "auth" ) > -1 ) ) return s( 'authenticate() | challenge without Digest qop different than "auth" or "auth-int", authentication aborted' ), !1; this._qop = "auth" } else this._qop = null; this._method = n, this._uri = r, this._cnonce = l || i.createRandomToken( 12 ), this._nc += 1; var a, c, f = Number( this._nc ).toString( 16 ); return this._ncHex = "00000000".substr( 0, 8 - f.length ) + f, 4294967296 === this._nc && ( this._nc = 1, this._ncHex = "00000001" ), this._credentials.password ? this._ha1 = i.calculateMD5( "".concat( this._credentials.username, ":" ).concat( this._realm, ":" ).concat( this._credentials.password ) ) : this._ha1 = this._credentials.ha1, "auth" === this._qop ? ( a = "".concat( this._method, ":" ).concat( this._uri ), c = i.calculateMD5( a ), o( 'authenticate() | using qop=auth [a2:"%s"]', a ), this._response = i.calculateMD5( "".concat( this._ha1, ":" ).concat( this._nonce, ":" ).concat( this._ncHex, ":" ).concat( this._cnonce, ":auth:" ).concat( c ) ) ) : "auth-int" === this._qop ? ( a = "".concat( this._method, ":" ).concat( this._uri, ":" ).concat( i.calculateMD5( u || "" ) ), c = i.calculateMD5( a ), o( 'authenticate() | using qop=auth-int [a2:"%s"]', a ), this._response = i.calculateMD5( "".concat( this._ha1, ":" ).concat( this._nonce, ":" ).concat( this._ncHex, ":" ).concat( this._cnonce, ":auth-int:" ).concat( c ) ) ) : null === this._qop && ( a = "".concat( this._method, ":" ).concat( this._uri ), c = i.calculateMD5( a ), o( 'authenticate() | using qop=null [a2:"%s"]', a ), this._response = i.calculateMD5( "".concat( this._ha1, ":" ).concat( this._nonce, ":" ).concat( c ) ) ), o( "authenticate() | response generated" ), !0 } }, { key: "toString", value: function () { var e = []; if ( !this._response ) throw new Error( "response field does not exist, cannot generate Authorization header" ); return e.push( "algorithm=".concat( this._algorithm ) ), e.push( 'username="'.concat( this._credentials.username, '"' ) ), e.push( 'realm="'.concat( this._realm, '"' ) ), e.push( 'nonce="'.concat( this._nonce, '"' ) ), e.push( 'uri="'.concat( this._uri, '"' ) ), e.push( 'response="'.concat( this._response, '"' ) ), this._opaque && e.push( 'opaque="'.concat( this._opaque, '"' ) ), this._qop && ( e.push( "qop=".concat( this._qop ) ), e.push( 'cnonce="'.concat( this._cnonce, '"' ) ), e.push( "nc=".concat( this._ncHex ) ) ), "Digest ".concat( e.join( ", " ) ) } }] ) && r( t.prototype, n ), e }() }, { "./Utils": 26, debug: 30 }], 6: [function ( e, t, n ) { "use strict"; function r ( e ) { return ( r = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function ( e ) { return typeof e } : function ( e ) { return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e } )( e ) } function i ( e, t ) { if ( !( e instanceof t ) ) throw new TypeError( "Cannot call a class as a function" ) } function o ( e, t ) { return !t || "object" !== r( t ) && "function" != typeof t ? function ( e ) { if ( void 0 === e ) throw new ReferenceError( "this hasn't been initialised - super() hasn't been called" ); return e }( e ) : t } function s ( e, t ) { if ( "function" != typeof t && null !== t ) throw new TypeError( "Super expression must either be null or a function" ); e.prototype = Object.create( t && t.prototype, { constructor: { value: e, writable: !0, configurable: !0 } } ), t && a( e, t ) } function u ( e ) { var t = "function" == typeof Map ? new Map : void 0; return ( u = function ( e ) { if ( null === e || ( n = e, -1 === Function.toString.call( n ).indexOf( "[native code]" ) ) ) return e; var n; if ( "function" != typeof e ) throw new TypeError( "Super expression must either be null or a function" ); if ( void 0 !== t ) { if ( t.has( e ) ) return t.get( e ); t.set( e, r ) } function r () { return l( e, arguments, c( this ).constructor ) } return r.prototype = Object.create( e.prototype, { constructor: { value: r, enumerable: !1, writable: !0, configurable: !0 } } ), a( r, e ) } )( e ) } function l ( e, t, n ) { return ( l = function () { if ( "undefined" == typeof Reflect || !Reflect.construct ) return !1; if ( Reflect.construct.sham ) return !1; if ( "function" == typeof Proxy ) return !0; try { return Date.prototype.toString.call( Reflect.construct( Date, [], ( function () { } ) ) ), !0 } catch ( e ) { return !1 } }() ? Reflect.construct : function ( e, t, n ) { var r = [null]; r.push.apply( r, t ); var i = new ( Function.bind.apply( e, r ) ); return n && a( i, n.prototype ), i } ).apply( null, arguments ) } function a ( e, t ) { return ( a = Object.setPrototypeOf || function ( e, t ) { return e.__proto__ = t, e } )( e, t ) } function c ( e ) { return ( c = Object.setPrototypeOf ? Object.getPrototypeOf : function ( e ) { return e.__proto__ || Object.getPrototypeOf( e ) } )( e ) } var f = function ( e ) { function t ( e, n ) { var r; return i( this, t ), ( r = o( this, c( t ).call( this ) ) ).code = 1, r.name = "CONFIGURATION_ERROR", r.parameter = e, r.value = n, r.message = r.value ? "Invalid value ".concat( JSON.stringify( r.value ), ' for parameter "' ).concat( r.parameter, '"' ) : "Missing parameter: ".concat( r.parameter ), r } return s( t, u( Error ) ), t }(), h = function ( e ) { function t ( e ) { var n; return i( this, t ), ( n = o( this, c( t ).call( this ) ) ).code = 2, n.name = "INVALID_STATE_ERROR", n.status = e, n.message = "Invalid status: ".concat( e ), n } return s( t, u( Error ) ), t }(), d = function ( e ) { function t ( e ) { var n; return i( this, t ), ( n = o( this, c( t ).call( this ) ) ).code = 3, n.name = "NOT_SUPPORTED_ERROR", n.message = e, n } return s( t, u( Error ) ), t }(), _ = function ( e ) { function t ( e ) { var n; return i( this, t ), ( n = o( this, c( t ).call( this ) ) ).code = 4, n.name = "NOT_READY_ERROR", n.message = e, n } return s( t, u( Error ) ), t }(); t.exports = { ConfigurationError: f, InvalidStateError: h, NotSupportedError: d, NotReadyError: _ } }, {}], 7: [function ( e, t, n ) { "use strict"; t.exports = function () { function t ( e ) { return '"' + e.replace( /\\/g, "\\\\" ).replace( /"/g, '\\"' ).replace( /\x08/g, "\\b" ).replace( /\t/g, "\\t" ).replace( /\n/g, "\\n" ).replace( /\f/g, "\\f" ).replace( /\r/g, "\\r" ).replace( /[\x00-\x07\x0B\x0E-\x1F\x80-\uFFFF]/g, escape ) + '"' } var n = { parse: function ( n, r ) { var i = { CRLF: c, DIGIT: f, ALPHA: h, HEXDIG: d, WSP: _, OCTET: p, DQUOTE: v, SP: m, HTAB: g, alphanum: y, reserved: T, unreserved: C, mark: b, escaped: E, LWS: S, SWS: A, HCOLON: w, TEXT_UTF8_TRIM: R, TEXT_UTF8char: I, UTF8_NONASCII: O, UTF8_CONT: k, LHEX: function () { var e; return null === ( e = f() ) && ( /^[a-f]/.test( n.charAt( o ) ) ? ( e = n.charAt( o ), o++ ) : ( e = null, 0 === s && a( "[a-f]" ) ) ), e }, token: x, token_nodot: N, separators: function () { var e; return 40 === n.charCodeAt( o ) ? ( e = "(", o++ ) : ( e = null, 0 === s && a( '"("' ) ), null === e && ( 41 === n.charCodeAt( o ) ? ( e = ")", o++ ) : ( e = null, 0 === s && a( '")"' ) ), null === e && ( 60 === n.charCodeAt( o ) ? ( e = "<", o++ ) : ( e = null, 0 === s && a( '"<"' ) ), null === e && ( 62 === n.charCodeAt( o ) ? ( e = ">", o++ ) : ( e = null, 0 === s && a( '">"' ) ), null === e && ( 64 === n.charCodeAt( o ) ? ( e = "@", o++ ) : ( e = null, 0 === s && a( '"@"' ) ), null === e && ( 44 === n.charCodeAt( o ) ? ( e = ",", o++ ) : ( e = null, 0 === s && a( '","' ) ), null === e && ( 59 === n.charCodeAt( o ) ? ( e = ";", o++ ) : ( e = null, 0 === s && a( '";"' ) ), null === e && ( 58 === n.charCodeAt( o ) ? ( e = ":", o++ ) : ( e = null, 0 === s && a( '":"' ) ), null === e && ( 92 === n.charCodeAt( o ) ? ( e = "\\", o++ ) : ( e = null, 0 === s && a( '"\\\\"' ) ), null === e && null === ( e = v() ) && ( 47 === n.charCodeAt( o ) ? ( e = "/", o++ ) : ( e = null, 0 === s && a( '"/"' ) ), null === e && ( 91 === n.charCodeAt( o ) ? ( e = "[", o++ ) : ( e = null, 0 === s && a( '"["' ) ), null === e && ( 93 === n.charCodeAt( o ) ? ( e = "]", o++ ) : ( e = null, 0 === s && a( '"]"' ) ), null === e && ( 63 === n.charCodeAt( o ) ? ( e = "?", o++ ) : ( e = null, 0 === s && a( '"?"' ) ), null === e && ( 61 === n.charCodeAt( o ) ? ( e = "=", o++ ) : ( e = null, 0 === s && a( '"="' ) ), null === e && ( 123 === n.charCodeAt( o ) ? ( e = "{", o++ ) : ( e = null, 0 === s && a( '"{"' ) ), null === e && ( 125 === n.charCodeAt( o ) ? ( e = "}", o++ ) : ( e = null, 0 === s && a( '"}"' ) ), null === e && null === ( e = m() ) && ( e = g() ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ), e }, word: P, STAR: U, SLASH: D, EQUAL: L, LPAREN: M, RPAREN: q, RAQUOT: H, LAQUOT: F, COMMA: j, SEMI: G, COLON: W, LDQUOT: B, RDQUOT: Y, comment: function e () { var t, n, r, i; if ( i = o, null !== ( t = M() ) ) { for ( n = [], null === ( r = z() ) && null === ( r = J() ) && ( r = e() ); null !== r; )n.push( r ), null === ( r = z() ) && null === ( r = J() ) && ( r = e() ); null !== n && null !== ( r = q() ) ? t = [t, n, r] : ( t = null, o = i ) } else t = null, o = i; return t }, ctext: z, quoted_string: V, quoted_string_clean: K, qdtext: $, quoted_pair: J, SIP_URI_noparams: X, SIP_URI: Q, uri_scheme: Z, uri_scheme_sips: ee, uri_scheme_sip: te, userinfo: ne, user: re, user_unreserved: ie, password: oe, hostport: se, host: ue, hostname: le, domainlabel: ae, toplabel: ce, IPv6reference: fe, IPv6address: he, h16: de, ls32: _e, IPv4address: pe, dec_octet: ve, port: me, uri_parameters: ge, uri_parameter: ye, transport_param: Te, user_param: Ce, method_param: be, ttl_param: Ee, maddr_param: Se, lr_param: Ae, other_param: we, pname: Re, pvalue: Ie, paramchar: Oe, param_unreserved: ke, headers: xe, header: Ne, hname: Pe, hvalue: Ue, hnv_unreserved: De, Request_Response: function () { var e; return null === ( e = ft() ) && ( e = Le() ), e }, Request_Line: Le, Request_URI: Me, absoluteURI: qe, hier_part: He, net_path: Fe, abs_path: je, opaque_part: Ge, uric: We, uric_no_slash: Be, path_segments: Ye, segment: ze, param: Ve, pchar: Ke, scheme: $e, authority: Je, srvr: Xe, reg_name: Qe, query: Ze, SIP_Version: et, INVITEm: tt, ACKm: nt, OPTIONSm: rt, BYEm: it, CANCELm: ot, REGISTERm: st, SUBSCRIBEm: ut, NOTIFYm: lt, REFERm: at, Method: ct, Status_Line: ft, Status_Code: ht, extension_code: dt, Reason_Phrase: _t, Allow_Events: function () { var e, t, n, r, i, s; if ( i = o, null !== ( e = qt() ) ) { for ( t = [], s = o, null !== ( n = j() ) && null !== ( r = qt() ) ? n = [n, r] : ( n = null, o = s ); null !== n; )t.push( n ), s = o, null !== ( n = j() ) && null !== ( r = qt() ) ? n = [n, r] : ( n = null, o = s ); null !== t ? e = [e, t] : ( e = null, o = i ) } else e = null, o = i; return e }, Call_ID: function () { var e, t, r, i, u, l, c; return i = o, u = o, null !== ( e = P() ) ? ( l = o, 64 === n.charCodeAt( o ) ? ( t = "@", o++ ) : ( t = null, 0 === s && a( '"@"' ) ), null !== t && null !== ( r = P() ) ? t = [t, r] : ( t = null, o = l ), null !== ( t = null !== t ? t : "" ) ? e = [e, t] : ( e = null, o = u ) ) : ( e = null, o = u ), null !== e && ( c = i, e = void ( Fn = n.substring( o, c ) ) ), null === e && ( o = i ), e }, Contact: function () { var e, t, n, r, i, s, u; if ( i = o, null === ( e = U() ) ) if ( s = o, null !== ( e = pt() ) ) { for ( t = [], u = o, null !== ( n = j() ) && null !== ( r = pt() ) ? n = [n, r] : ( n = null, o = u ); null !== n; )t.push( n ), u = o, null !== ( n = j() ) && null !== ( r = pt() ) ? n = [n, r] : ( n = null, o = u ); null !== t ? e = [e, t] : ( e = null, o = s ) } else e = null, o = s; return null !== e && ( e = function ( e ) { var t, n; for ( n = Fn.multi_header.length, t = 0; t < n; t++ )if ( null === Fn.multi_header[t].parsed ) { Fn = null; break } Fn = null !== Fn ? Fn.multi_header : -1 }() ), null === e && ( o = i ), e }, contact_param: pt, name_addr: vt, display_name: mt, contact_params: gt, c_p_q: yt, c_p_expires: Tt, delta_seconds: Ct, qvalue: bt, generic_param: Et, gen_value: St, Content_Disposition: function () { var e, t, n, r, i, s; if ( i = o, null !== ( e = At() ) ) { for ( t = [], s = o, null !== ( n = G() ) && null !== ( r = wt() ) ? n = [n, r] : ( n = null, o = s ); null !== n; )t.push( n ), s = o, null !== ( n = G() ) && null !== ( r = wt() ) ? n = [n, r] : ( n = null, o = s ); null !== t ? e = [e, t] : ( e = null, o = i ) } else e = null, o = i; return e }, disp_type: At, disp_param: wt, handling_param: Rt, Content_Encoding: function () { var e, t, n, r, i, s; if ( i = o, null !== ( e = x() ) ) { for ( t = [], s = o, null !== ( n = j() ) && null !== ( r = x() ) ? n = [n, r] : ( n = null, o = s ); null !== n; )t.push( n ), s = o, null !== ( n = j() ) && null !== ( r = x() ) ? n = [n, r] : ( n = null, o = s ); null !== t ? e = [e, t] : ( e = null, o = i ) } else e = null, o = i; return e }, Content_Length: function () { var e, t, n; if ( n = o, null !== ( t = f() ) ) for ( e = []; null !== t; )e.push( t ), t = f(); else e = null; return null !== e && ( e = void ( Fn = parseInt( e.join( "" ) ) ) ), null === e && ( o = n ), e }, Content_Type: function () { var e, t, r; return t = o, null !== ( e = It() ) && ( r = t, e = void ( Fn = n.substring( o, r ) ) ), null === e && ( o = t ), e }, media_type: It, m_type: Ot, discrete_type: kt, composite_type: xt, extension_token: Nt, x_token: Pt, m_subtype: Ut, m_parameter: Dt, m_value: Lt, CSeq: function () { var e, t, n, r; return r = o, null !== ( e = Mt() ) && null !== ( t = S() ) && null !== ( n = ct() ) ? e = [e, t, n] : ( e = null, o = r ), e }, CSeq_value: Mt, Expires: function () { var e, t; return t = o, null !== ( e = Ct() ) && ( e = void ( Fn = e ) ), null === e && ( o = t ), e }, Event: function () { var e, t, n, r, i, s, u, l; if ( i = o, s = o, null !== ( e = qt() ) ) { for ( t = [], u = o, null !== ( n = G() ) && null !== ( r = Et() ) ? n = [n, r] : ( n = null, o = u ); null !== n; )t.push( n ), u = o, null !== ( n = G() ) && null !== ( r = Et() ) ? n = [n, r] : ( n = null, o = u ); null !== t ? e = [e, t] : ( e = null, o = s ) } else e = null, o = s; return null !== e && ( l = e[0], e = void ( Fn.event = l.join( "" ).toLowerCase() ) ), null === e && ( o = i ), e }, event_type: qt, From: function () { var e, t, n, r, i, s, u; if ( i = o, s = o, null === ( e = X() ) && ( e = vt() ), null !== e ) { for ( t = [], u = o, null !== ( n = G() ) && null !== ( r = Ht() ) ? n = [n, r] : ( n = null, o = u ); null !== n; )t.push( n ), u = o, null !== ( n = G() ) && null !== ( r = Ht() ) ? n = [n, r] : ( n = null, o = u ); null !== t ? e = [e, t] : ( e = null, o = s ) } else e = null, o = s; return null !== e && ( e = function ( e ) { var t = Fn.tag; try { Fn = new Hn( Fn.uri, Fn.display_name, Fn.params ), t && Fn.setParam( "tag", t ) } catch ( e ) { Fn = -1 } }() ), null === e && ( o = i ), e }, from_param: Ht, tag_param: Ft, Max_Forwards: function () { var e, t, n; if ( n = o, null !== ( t = f() ) ) for ( e = []; null !== t; )e.push( t ), t = f(); else e = null; return null !== e && ( e = void ( Fn = parseInt( e.join( "" ) ) ) ), null === e && ( o = n ), e }, Min_Expires: function () { var e, t; return t = o, null !== ( e = Ct() ) && ( e = void ( Fn = e ) ), null === e && ( o = t ), e }, Name_Addr_Header: function () { var e, t, n, r, i, s, u, l, a, c; for ( l = o, a = o, e = [], t = mt(); null !== t; )e.push( t ), t = mt(); if ( null !== e ) if ( null !== ( t = F() ) ) if ( null !== ( n = Q() ) ) if ( null !== ( r = H() ) ) { for ( i = [], c = o, null !== ( s = G() ) && null !== ( u = Et() ) ? s = [s, u] : ( s = null, o = c ); null !== s; )i.push( s ), c = o, null !== ( s = G() ) && null !== ( u = Et() ) ? s = [s, u] : ( s = null, o = c ); null !== i ? e = [e, t, n, r, i] : ( e = null, o = a ) } else e = null, o = a; else e = null, o = a; else e = null, o = a; else e = null, o = a; return null !== e && ( e = function ( e ) { try { Fn = new Hn( Fn.uri, Fn.display_name, Fn.params ) } catch ( e ) { Fn = -1 } }() ), null === e && ( o = l ), e }, Proxy_Authenticate: function () { return jt() }, challenge: jt, other_challenge: Gt, auth_param: Wt, digest_cln: Bt, realm: Yt, realm_value: zt, domain: Vt, URI: Kt, nonce: $t, nonce_value: Jt, opaque: Xt, stale: Qt, algorithm: Zt, qop_options: en, qop_value: tn, Proxy_Require: function () { var e, t, n, r, i, s; if ( i = o, null !== ( e = x() ) ) { for ( t = [], s = o, null !== ( n = j() ) && null !== ( r = x() ) ? n = [n, r] : ( n = null, o = s ); null !== n; )t.push( n ), s = o, null !== ( n = j() ) && null !== ( r = x() ) ? n = [n, r] : ( n = null, o = s ); null !== t ? e = [e, t] : ( e = null, o = i ) } else e = null, o = i; return e }, Record_Route: function () { var e, t, n, r, i, s, u; if ( i = o, s = o, null !== ( e = nn() ) ) { for ( t = [], u = o, null !== ( n = j() ) && null !== ( r = nn() ) ? n = [n, r] : ( n = null, o = u ); null !== n; )t.push( n ), u = o, null !== ( n = j() ) && null !== ( r = nn() ) ? n = [n, r] : ( n = null, o = u ); null !== t ? e = [e, t] : ( e = null, o = s ) } else e = null, o = s; return null !== e && ( e = function ( e ) { var t, n; for ( n = Fn.multi_header.length, t = 0; t < n; t++ )if ( null === Fn.multi_header[t].parsed ) { Fn = null; break } Fn = null !== Fn ? Fn.multi_header : -1 }() ), null === e && ( o = i ), e }, rec_route: nn, Reason: function () { var e, t, r, i, u, l, c; if ( u = o, l = o, "sip" === n.substr( o, 3 ).toLowerCase() ? ( e = n.substr( o, 3 ), o += 3 ) : ( e = null, 0 === s && a( '"SIP"' ) ), null === e && ( e = x() ), null !== e ) { for ( t = [], c = o, null !== ( r = G() ) && null !== ( i = rn() ) ? r = [r, i] : ( r = null, o = c ); null !== r; )t.push( r ), c = o, null !== ( r = G() ) && null !== ( i = rn() ) ? r = [r, i] : ( r = null, o = c ); null !== t ? e = [e, t] : ( e = null, o = l ) } else e = null, o = l; return null !== e && ( e = function ( e, t ) { if ( Fn.protocol = t.toLowerCase(), Fn.params || ( Fn.params = {} ), Fn.params.text && '"' === Fn.params.text[0] ) { var n = Fn.params.text; Fn.text = n.substring( 1, n.length - 1 ), delete Fn.params.text } }( 0, e[0] ) ), null === e && ( o = u ), e }, reason_param: rn, reason_cause: on, Require: function () { var e, t, n, r, i, s; if ( i = o, null !== ( e = x() ) ) { for ( t = [], s = o, null !== ( n = j() ) && null !== ( r = x() ) ? n = [n, r] : ( n = null, o = s ); null !== n; )t.push( n ), s = o, null !== ( n = j() ) && null !== ( r = x() ) ? n = [n, r] : ( n = null, o = s ); null !== t ? e = [e, t] : ( e = null, o = i ) } else e = null, o = i; return e }, Route: function () { var e, t, n, r, i, s; if ( i = o, null !== ( e = sn() ) ) { for ( t = [], s = o, null !== ( n = j() ) && null !== ( r = sn() ) ? n = [n, r] : ( n = null, o = s ); null !== n; )t.push( n ), s = o, null !== ( n = j() ) && null !== ( r = sn() ) ? n = [n, r] : ( n = null, o = s ); null !== t ? e = [e, t] : ( e = null, o = i ) } else e = null, o = i; return e }, route_param: sn, Subscription_State: function () { var e, t, n, r, i, s; if ( i = o, null !== ( e = un() ) ) { for ( t = [], s = o, null !== ( n = G() ) && null !== ( r = ln() ) ? n = [n, r] : ( n = null, o = s ); null !== n; )t.push( n ), s = o, null !== ( n = G() ) && null !== ( r = ln() ) ? n = [n, r] : ( n = null, o = s ); null !== t ? e = [e, t] : ( e = null, o = i ) } else e = null, o = i; return e }, substate_value: un, subexp_params: ln, event_reason_value: an, Subject: function () { var e; return null !== ( e = R() ) ? e : "" }, Supported: function () { var e, t, n, r, i, s; if ( i = o, null !== ( e = x() ) ) { for ( t = [], s = o, null !== ( n = j() ) && null !== ( r = x() ) ? n = [n, r] : ( n = null, o = s ); null !== n; )t.push( n ), s = o, null !== ( n = j() ) && null !== ( r = x() ) ? n = [n, r] : ( n = null, o = s ); null !== t ? e = [e, t] : ( e = null, o = i ) } else e = null, o = i; return null !== e ? e : "" }, To: function () { var e, t, n, r, i, s, u; if ( i = o, s = o, null === ( e = X() ) && ( e = vt() ), null !== e ) { for ( t = [], u = o, null !== ( n = G() ) && null !== ( r = cn() ) ? n = [n, r] : ( n = null, o = u ); null !== n; )t.push( n ), u = o, null !== ( n = G() ) && null !== ( r = cn() ) ? n = [n, r] : ( n = null, o = u ); null !== t ? e = [e, t] : ( e = null, o = s ) } else e = null, o = s; return null !== e && ( e = function ( e ) { var t = Fn.tag; try { Fn = new Hn( Fn.uri, Fn.display_name, Fn.params ), t && Fn.setParam( "tag", t ) } catch ( e ) { Fn = -1 } }() ), null === e && ( o = i ), e }, to_param: cn, Via: function () { var e, t, n, r, i, s; if ( i = o, null !== ( e = fn() ) ) { for ( t = [], s = o, null !== ( n = j() ) && null !== ( r = fn() ) ? n = [n, r] : ( n = null, o = s ); null !== n; )t.push( n ), s = o, null !== ( n = j() ) && null !== ( r = fn() ) ? n = [n, r] : ( n = null, o = s ); null !== t ? e = [e, t] : ( e = null, o = i ) } else e = null, o = i; return e }, via_param: fn, via_params: hn, via_ttl: dn, via_maddr: _n, via_received: pn, via_branch: vn, response_port: mn, sent_protocol: gn, protocol_name: yn, transport: Tn, sent_by: Cn, via_host: bn, via_port: En, ttl: Sn, WWW_Authenticate: function () { return jt() }, Session_Expires: function () { var e, t, n, r, i, s; if ( i = o, null !== ( e = An() ) ) { for ( t = [], s = o, null !== ( n = G() ) && null !== ( r = wn() ) ? n = [n, r] : ( n = null, o = s ); null !== n; )t.push( n ), s = o, null !== ( n = G() ) && null !== ( r = wn() ) ? n = [n, r] : ( n = null, o = s ); null !== t ? e = [e, t] : ( e = null, o = i ) } else e = null, o = i; return e }, s_e_expires: An, s_e_params: wn, s_e_refresher: Rn, extension_header: function () { var e, t, n, r; return r = o, null !== ( e = x() ) && null !== ( t = w() ) && null !== ( n = In() ) ? e = [e, t, n] : ( e = null, o = r ), e }, header_value: In, message_body: function () { var e, t; for ( e = [], t = p(); null !== t; )e.push( t ), t = p(); return e }, uuid_URI: function () { var e, t, r; return r = o, "uuid:" === n.substr( o, 5 ) ? ( e = "uuid:", o += 5 ) : ( e = null, 0 === s && a( '"uuid:"' ) ), null !== e && null !== ( t = On() ) ? e = [e, t] : ( e = null, o = r ), e }, uuid: On, hex4: kn, hex8: xn, hex12: Nn, Refer_To: function () { var e, t, n, r, i, s, u; if ( i = o, s = o, null === ( e = X() ) && ( e = vt() ), null !== e ) { for ( t = [], u = o, null !== ( n = G() ) && null !== ( r = Et() ) ? n = [n, r] : ( n = null, o = u ); null !== n; )t.push( n ), u = o, null !== ( n = G() ) && null !== ( r = Et() ) ? n = [n, r] : ( n = null, o = u ); null !== t ? e = [e, t] : ( e = null, o = s ) } else e = null, o = s; return null !== e && ( e = function ( e ) { try { Fn = new Hn( Fn.uri, Fn.display_name, Fn.params ) } catch ( e ) { Fn = -1 } }() ), null === e && ( o = i ), e }, Replaces: function () { var e, t, n, r, i, s; if ( i = o, null !== ( e = Pn() ) ) { for ( t = [], s = o, null !== ( n = G() ) && null !== ( r = Un() ) ? n = [n, r] : ( n = null, o = s ); null !== n; )t.push( n ), s = o, null !== ( n = G() ) && null !== ( r = Un() ) ? n = [n, r] : ( n = null, o = s ); null !== t ? e = [e, t] : ( e = null, o = i ) } else e = null, o = i; return e }, call_id: Pn, replaces_param: Un, to_tag: Dn, from_tag: Ln, early_flag: Mn }; if ( void 0 !== r ) { if ( void 0 === i[r] ) throw new Error( "Invalid rule name: " + t( r ) + "." ) } else r = "CRLF"; var o = 0, s = 0, u = 0, l = []; function a ( e ) { o < u || ( o > u && ( u = o, l = [] ), l.push( e ) ) } function c () { var e; return "\r\n" === n.substr( o, 2 ) ? ( e = "\r\n", o += 2 ) : ( e = null, 0 === s && a( '"\\r\\n"' ) ), e } function f () { var e; return /^[0-9]/.test( n.charAt( o ) ) ? ( e = n.charAt( o ), o++ ) : ( e = null, 0 === s && a( "[0-9]" ) ), e } function h () { var e; return /^[a-zA-Z]/.test( n.charAt( o ) ) ? ( e = n.charAt( o ), o++ ) : ( e = null, 0 === s && a( "[a-zA-Z]" ) ), e } function d () { var e; return /^[0-9a-fA-F]/.test( n.charAt( o ) ) ? ( e = n.charAt( o ), o++ ) : ( e = null, 0 === s && a( "[0-9a-fA-F]" ) ), e } function _ () { var e; return null === ( e = m() ) && ( e = g() ), e } function p () { var e; return /^[\0-\xFF]/.test( n.charAt( o ) ) ? ( e = n.charAt( o ), o++ ) : ( e = null, 0 === s && a( "[\\0-\\xFF]" ) ), e } function v () { var e; return /^["]/.test( n.charAt( o ) ) ? ( e = n.charAt( o ), o++ ) : ( e = null, 0 === s && a( '["]' ) ), e } function m () { var e; return 32 === n.charCodeAt( o ) ? ( e = " ", o++ ) : ( e = null, 0 === s && a( '" "' ) ), e } function g () { var e; return 9 === n.charCodeAt( o ) ? ( e = "\t", o++ ) : ( e = null, 0 === s && a( '"\\t"' ) ), e } function y () { var e; return /^[a-zA-Z0-9]/.test( n.charAt( o ) ) ? ( e = n.charAt( o ), o++ ) : ( e = null, 0 === s && a( "[a-zA-Z0-9]" ) ), e } function T () { var e; return 59 === n.charCodeAt( o ) ? ( e = ";", o++ ) : ( e = null, 0 === s && a( '";"' ) ), null === e && ( 47 === n.charCodeAt( o ) ? ( e = "/", o++ ) : ( e = null, 0 === s && a( '"/"' ) ), null === e && ( 63 === n.charCodeAt( o ) ? ( e = "?", o++ ) : ( e = null, 0 === s && a( '"?"' ) ), null === e && ( 58 === n.charCodeAt( o ) ? ( e = ":", o++ ) : ( e = null, 0 === s && a( '":"' ) ), null === e && ( 64 === n.charCodeAt( o ) ? ( e = "@", o++ ) : ( e = null, 0 === s && a( '"@"' ) ), null === e && ( 38 === n.charCodeAt( o ) ? ( e = "&", o++ ) : ( e = null, 0 === s && a( '"&"' ) ), null === e && ( 61 === n.charCodeAt( o ) ? ( e = "=", o++ ) : ( e = null, 0 === s && a( '"="' ) ), null === e && ( 43 === n.charCodeAt( o ) ? ( e = "+", o++ ) : ( e = null, 0 === s && a( '"+"' ) ), null === e && ( 36 === n.charCodeAt( o ) ? ( e = "$", o++ ) : ( e = null, 0 === s && a( '"$"' ) ), null === e && ( 44 === n.charCodeAt( o ) ? ( e = ",", o++ ) : ( e = null, 0 === s && a( '","' ) ) ) ) ) ) ) ) ) ) ), e } function C () { var e; return null === ( e = y() ) && ( e = b() ), e } function b () { var e; return 45 === n.charCodeAt( o ) ? ( e = "-", o++ ) : ( e = null, 0 === s && a( '"-"' ) ), null === e && ( 95 === n.charCodeAt( o ) ? ( e = "_", o++ ) : ( e = null, 0 === s && a( '"_"' ) ), null === e && ( 46 === n.charCodeAt( o ) ? ( e = ".", o++ ) : ( e = null, 0 === s && a( '"."' ) ), null === e && ( 33 === n.charCodeAt( o ) ? ( e = "!", o++ ) : ( e = null, 0 === s && a( '"!"' ) ), null === e && ( 126 === n.charCodeAt( o ) ? ( e = "~", o++ ) : ( e = null, 0 === s && a( '"~"' ) ), null === e && ( 42 === n.charCodeAt( o ) ? ( e = "*", o++ ) : ( e = null, 0 === s && a( '"*"' ) ), null === e && ( 39 === n.charCodeAt( o ) ? ( e = "'", o++ ) : ( e = null, 0 === s && a( '"\'"' ) ), null === e && ( 40 === n.charCodeAt( o ) ? ( e = "(", o++ ) : ( e = null, 0 === s && a( '"("' ) ), null === e && ( 41 === n.charCodeAt( o ) ? ( e = ")", o++ ) : ( e = null, 0 === s && a( '")"' ) ) ) ) ) ) ) ) ) ), e } function E () { var e, t, r, i, u; return i = o, u = o, 37 === n.charCodeAt( o ) ? ( e = "%", o++ ) : ( e = null, 0 === s && a( '"%"' ) ), null !== e && null !== ( t = d() ) && null !== ( r = d() ) ? e = [e, t, r] : ( e = null, o = u ), null !== e && ( e = e.join( "" ) ), null === e && ( o = i ), e } function S () { var e, t, n, r, i, s; for ( r = o, i = o, s = o, e = [], t = _(); null !== t; )e.push( t ), t = _(); if ( null !== e && null !== ( t = c() ) ? e = [e, t] : ( e = null, o = s ), null !== ( e = null !== e ? e : "" ) ) { if ( null !== ( n = _() ) ) for ( t = []; null !== n; )t.push( n ), n = _(); else t = null; null !== t ? e = [e, t] : ( e = null, o = i ) } else e = null, o = i; return null !== e && ( e = " " ), null === e && ( o = r ), e } function A () { var e; return null !== ( e = S() ) ? e : "" } function w () { var e, t, r, i, u; for ( i = o, u = o, e = [], null === ( t = m() ) && ( t = g() ); null !== t; )e.push( t ), null === ( t = m() ) && ( t = g() ); return null !== e ? ( 58 === n.charCodeAt( o ) ? ( t = ":", o++ ) : ( t = null, 0 === s && a( '":"' ) ), null !== t && null !== ( r = A() ) ? e = [e, t, r] : ( e = null, o = u ) ) : ( e = null, o = u ), null !== e && ( e = ":" ), null === e && ( o = i ), e } function R () { var e, t, r, i, s, u, l, a; if ( s = o, u = o, null !== ( t = I() ) ) for ( e = []; null !== t; )e.push( t ), t = I(); else e = null; if ( null !== e ) { for ( t = [], l = o, r = [], i = S(); null !== i; )r.push( i ), i = S(); for ( null !== r && null !== ( i = I() ) ? r = [r, i] : ( r = null, o = l ); null !== r; ) { for ( t.push( r ), l = o, r = [], i = S(); null !== i; )r.push( i ), i = S(); null !== r && null !== ( i = I() ) ? r = [r, i] : ( r = null, o = l ) } null !== t ? e = [e, t] : ( e = null, o = u ) } else e = null, o = u; return null !== e && ( a = s, e = n.substring( o, a ) ), null === e && ( o = s ), e } function I () { var e; return /^[!-~]/.test( n.charAt( o ) ) ? ( e = n.charAt( o ), o++ ) : ( e = null, 0 === s && a( "[!-~]" ) ), null === e && ( e = O() ), e } function O () { var e; return /^[\x80-\uFFFF]/.test( n.charAt( o ) ) ? ( e = n.charAt( o ), o++ ) : ( e = null, 0 === s && a( "[\\x80-\\uFFFF]" ) ), e } function k () { var e; return /^[\x80-\xBF]/.test( n.charAt( o ) ) ? ( e = n.charAt( o ), o++ ) : ( e = null, 0 === s && a( "[\\x80-\\xBF]" ) ), e } function x () { var e, t, r, i; if ( r = o, null === ( t = y() ) && ( 45 === n.charCodeAt( o ) ? ( t = "-", o++ ) : ( t = null, 0 === s && a( '"-"' ) ), null === t && ( 46 === n.charCodeAt( o ) ? ( t = ".", o++ ) : ( t = null, 0 === s && a( '"."' ) ), null === t && ( 33 === n.charCodeAt( o ) ? ( t = "!", o++ ) : ( t = null, 0 === s && a( '"!"' ) ), null === t && ( 37 === n.charCodeAt( o ) ? ( t = "%", o++ ) : ( t = null, 0 === s && a( '"%"' ) ), null === t && ( 42 === n.charCodeAt( o ) ? ( t = "*", o++ ) : ( t = null, 0 === s && a( '"*"' ) ), null === t && ( 95 === n.charCodeAt( o ) ? ( t = "_", o++ ) : ( t = null, 0 === s && a( '"_"' ) ), null === t && ( 43 === n.charCodeAt( o ) ? ( t = "+", o++ ) : ( t = null, 0 === s && a( '"+"' ) ), null === t && ( 96 === n.charCodeAt( o ) ? ( t = "`", o++ ) : ( t = null, 0 === s && a( '"`"' ) ), null === t && ( 39 === n.charCodeAt( o ) ? ( t = "'", o++ ) : ( t = null, 0 === s && a( '"\'"' ) ), null === t && ( 126 === n.charCodeAt( o ) ? ( t = "~", o++ ) : ( t = null, 0 === s && a( '"~"' ) ) ) ) ) ) ) ) ) ) ) ), null !== t ) for ( e = []; null !== t; )e.push( t ), null === ( t = y() ) && ( 45 === n.charCodeAt( o ) ? ( t = "-", o++ ) : ( t = null, 0 === s && a( '"-"' ) ), null === t && ( 46 === n.charCodeAt( o ) ? ( t = ".", o++ ) : ( t = null, 0 === s && a( '"."' ) ), null === t && ( 33 === n.charCodeAt( o ) ? ( t = "!", o++ ) : ( t = null, 0 === s && a( '"!"' ) ), null === t && ( 37 === n.charCodeAt( o ) ? ( t = "%", o++ ) : ( t = null, 0 === s && a( '"%"' ) ), null === t && ( 42 === n.charCodeAt( o ) ? ( t = "*", o++ ) : ( t = null, 0 === s && a( '"*"' ) ), null === t && ( 95 === n.charCodeAt( o ) ? ( t = "_", o++ ) : ( t = null, 0 === s && a( '"_"' ) ), null === t && ( 43 === n.charCodeAt( o ) ? ( t = "+", o++ ) : ( t = null, 0 === s && a( '"+"' ) ), null === t && ( 96 === n.charCodeAt( o ) ? ( t = "`", o++ ) : ( t = null, 0 === s && a( '"`"' ) ), null === t && ( 39 === n.charCodeAt( o ) ? ( t = "'", o++ ) : ( t = null, 0 === s && a( '"\'"' ) ), null === t && ( 126 === n.charCodeAt( o ) ? ( t = "~", o++ ) : ( t = null, 0 === s && a( '"~"' ) ) ) ) ) ) ) ) ) ) ) ); else e = null; return null !== e && ( i = r, e = n.substring( o, i ) ), null === e && ( o = r ), e } function N () { var e, t, r, i; if ( r = o, null === ( t = y() ) && ( 45 === n.charCodeAt( o ) ? ( t = "-", o++ ) : ( t = null, 0 === s && a( '"-"' ) ), null === t && ( 33 === n.charCodeAt( o ) ? ( t = "!", o++ ) : ( t = null, 0 === s && a( '"!"' ) ), null === t && ( 37 === n.charCodeAt( o ) ? ( t = "%", o++ ) : ( t = null, 0 === s && a( '"%"' ) ), null === t && ( 42 === n.charCodeAt( o ) ? ( t = "*", o++ ) : ( t = null, 0 === s && a( '"*"' ) ), null === t && ( 95 === n.charCodeAt( o ) ? ( t = "_", o++ ) : ( t = null, 0 === s && a( '"_"' ) ), null === t && ( 43 === n.charCodeAt( o ) ? ( t = "+", o++ ) : ( t = null, 0 === s && a( '"+"' ) ), null === t && ( 96 === n.charCodeAt( o ) ? ( t = "`", o++ ) : ( t = null, 0 === s && a( '"`"' ) ), null === t && ( 39 === n.charCodeAt( o ) ? ( t = "'", o++ ) : ( t = null, 0 === s && a( '"\'"' ) ), null === t && ( 126 === n.charCodeAt( o ) ? ( t = "~", o++ ) : ( t = null, 0 === s && a( '"~"' ) ) ) ) ) ) ) ) ) ) ), null !== t ) for ( e = []; null !== t; )e.push( t ), null === ( t = y() ) && ( 45 === n.charCodeAt( o ) ? ( t = "-", o++ ) : ( t = null, 0 === s && a( '"-"' ) ), null === t && ( 33 === n.charCodeAt( o ) ? ( t = "!", o++ ) : ( t = null, 0 === s && a( '"!"' ) ), null === t && ( 37 === n.charCodeAt( o ) ? ( t = "%", o++ ) : ( t = null, 0 === s && a( '"%"' ) ), null === t && ( 42 === n.charCodeAt( o ) ? ( t = "*", o++ ) : ( t = null, 0 === s && a( '"*"' ) ), null === t && ( 95 === n.charCodeAt( o ) ? ( t = "_", o++ ) : ( t = null, 0 === s && a( '"_"' ) ), null === t && ( 43 === n.charCodeAt( o ) ? ( t = "+", o++ ) : ( t = null, 0 === s && a( '"+"' ) ), null === t && ( 96 === n.charCodeAt( o ) ? ( t = "`", o++ ) : ( t = null, 0 === s && a( '"`"' ) ), null === t && ( 39 === n.charCodeAt( o ) ? ( t = "'", o++ ) : ( t = null, 0 === s && a( '"\'"' ) ), null === t && ( 126 === n.charCodeAt( o ) ? ( t = "~", o++ ) : ( t = null, 0 === s && a( '"~"' ) ) ) ) ) ) ) ) ) ) ); else e = null; return null !== e && ( i = r, e = n.substring( o, i ) ), null === e && ( o = r ), e } function P () { var e, t, r, i; if ( r = o, null === ( t = y() ) && ( 45 === n.charCodeAt( o ) ? ( t = "-", o++ ) : ( t = null, 0 === s && a( '"-"' ) ), null === t && ( 46 === n.charCodeAt( o ) ? ( t = ".", o++ ) : ( t = null, 0 === s && a( '"."' ) ), null === t && ( 33 === n.charCodeAt( o ) ? ( t = "!", o++ ) : ( t = null, 0 === s && a( '"!"' ) ), null === t && ( 37 === n.charCodeAt( o ) ? ( t = "%", o++ ) : ( t = null, 0 === s && a( '"%"' ) ), null === t && ( 42 === n.charCodeAt( o ) ? ( t = "*", o++ ) : ( t = null, 0 === s && a( '"*"' ) ), null === t && ( 95 === n.charCodeAt( o ) ? ( t = "_", o++ ) : ( t = null, 0 === s && a( '"_"' ) ), null === t && ( 43 === n.charCodeAt( o ) ? ( t = "+", o++ ) : ( t = null, 0 === s && a( '"+"' ) ), null === t && ( 96 === n.charCodeAt( o ) ? ( t = "`", o++ ) : ( t = null, 0 === s && a( '"`"' ) ), null === t && ( 39 === n.charCodeAt( o ) ? ( t = "'", o++ ) : ( t = null, 0 === s && a( '"\'"' ) ), null === t && ( 126 === n.charCodeAt( o ) ? ( t = "~", o++ ) : ( t = null, 0 === s && a( '"~"' ) ), null === t && ( 40 === n.charCodeAt( o ) ? ( t = "(", o++ ) : ( t = null, 0 === s && a( '"("' ) ), null === t && ( 41 === n.charCodeAt( o ) ? ( t = ")", o++ ) : ( t = null, 0 === s && a( '")"' ) ), null === t && ( 60 === n.charCodeAt( o ) ? ( t = "<", o++ ) : ( t = null, 0 === s && a( '"<"' ) ), null === t && ( 62 === n.charCodeAt( o ) ? ( t = ">", o++ ) : ( t = null, 0 === s && a( '">"' ) ), null === t && ( 58 === n.charCodeAt( o ) ? ( t = ":", o++ ) : ( t = null, 0 === s && a( '":"' ) ), null === t && ( 92 === n.charCodeAt( o ) ? ( t = "\\", o++ ) : ( t = null, 0 === s && a( '"\\\\"' ) ), null === t && null === ( t = v() ) && ( 47 === n.charCodeAt( o ) ? ( t = "/", o++ ) : ( t = null, 0 === s && a( '"/"' ) ), null === t && ( 91 === n.charCodeAt( o ) ? ( t = "[", o++ ) : ( t = null, 0 === s && a( '"["' ) ), null === t && ( 93 === n.charCodeAt( o ) ? ( t = "]", o++ ) : ( t = null, 0 === s && a( '"]"' ) ), null === t && ( 63 === n.charCodeAt( o ) ? ( t = "?", o++ ) : ( t = null, 0 === s && a( '"?"' ) ), null === t && ( 123 === n.charCodeAt( o ) ? ( t = "{", o++ ) : ( t = null, 0 === s && a( '"{"' ) ), null === t && ( 125 === n.charCodeAt( o ) ? ( t = "}", o++ ) : ( t = null, 0 === s && a( '"}"' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ), null !== t ) for ( e = []; null !== t; )e.push( t ), null === ( t = y() ) && ( 45 === n.charCodeAt( o ) ? ( t = "-", o++ ) : ( t = null, 0 === s && a( '"-"' ) ), null === t && ( 46 === n.charCodeAt( o ) ? ( t = ".", o++ ) : ( t = null, 0 === s && a( '"."' ) ), null === t && ( 33 === n.charCodeAt( o ) ? ( t = "!", o++ ) : ( t = null, 0 === s && a( '"!"' ) ), null === t && ( 37 === n.charCodeAt( o ) ? ( t = "%", o++ ) : ( t = null, 0 === s && a( '"%"' ) ), null === t && ( 42 === n.charCodeAt( o ) ? ( t = "*", o++ ) : ( t = null, 0 === s && a( '"*"' ) ), null === t && ( 95 === n.charCodeAt( o ) ? ( t = "_", o++ ) : ( t = null, 0 === s && a( '"_"' ) ), null === t && ( 43 === n.charCodeAt( o ) ? ( t = "+", o++ ) : ( t = null, 0 === s && a( '"+"' ) ), null === t && ( 96 === n.charCodeAt( o ) ? ( t = "`", o++ ) : ( t = null, 0 === s && a( '"`"' ) ), null === t && ( 39 === n.charCodeAt( o ) ? ( t = "'", o++ ) : ( t = null, 0 === s && a( '"\'"' ) ), null === t && ( 126 === n.charCodeAt( o ) ? ( t = "~", o++ ) : ( t = null, 0 === s && a( '"~"' ) ), null === t && ( 40 === n.charCodeAt( o ) ? ( t = "(", o++ ) : ( t = null, 0 === s && a( '"("' ) ), null === t && ( 41 === n.charCodeAt( o ) ? ( t = ")", o++ ) : ( t = null, 0 === s && a( '")"' ) ), null === t && ( 60 === n.charCodeAt( o ) ? ( t = "<", o++ ) : ( t = null, 0 === s && a( '"<"' ) ), null === t && ( 62 === n.charCodeAt( o ) ? ( t = ">", o++ ) : ( t = null, 0 === s && a( '">"' ) ), null === t && ( 58 === n.charCodeAt( o ) ? ( t = ":", o++ ) : ( t = null, 0 === s && a( '":"' ) ), null === t && ( 92 === n.charCodeAt( o ) ? ( t = "\\", o++ ) : ( t = null, 0 === s && a( '"\\\\"' ) ), null === t && null === ( t = v() ) && ( 47 === n.charCodeAt( o ) ? ( t = "/", o++ ) : ( t = null, 0 === s && a( '"/"' ) ), null === t && ( 91 === n.charCodeAt( o ) ? ( t = "[", o++ ) : ( t = null, 0 === s && a( '"["' ) ), null === t && ( 93 === n.charCodeAt( o ) ? ( t = "]", o++ ) : ( t = null, 0 === s && a( '"]"' ) ), null === t && ( 63 === n.charCodeAt( o ) ? ( t = "?", o++ ) : ( t = null, 0 === s && a( '"?"' ) ), null === t && ( 123 === n.charCodeAt( o ) ? ( t = "{", o++ ) : ( t = null, 0 === s && a( '"{"' ) ), null === t && ( 125 === n.charCodeAt( o ) ? ( t = "}", o++ ) : ( t = null, 0 === s && a( '"}"' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ); else e = null; return null !== e && ( i = r, e = n.substring( o, i ) ), null === e && ( o = r ), e } function U () { var e, t, r, i, u; return i = o, u = o, null !== ( e = A() ) ? ( 42 === n.charCodeAt( o ) ? ( t = "*", o++ ) : ( t = null, 0 === s && a( '"*"' ) ), null !== t && null !== ( r = A() ) ? e = [e, t, r] : ( e = null, o = u ) ) : ( e = null, o = u ), null !== e && ( e = "*" ), null === e && ( o = i ), e } function D () { var e, t, r, i, u; return i = o, u = o, null !== ( e = A() ) ? ( 47 === n.charCodeAt( o ) ? ( t = "/", o++ ) : ( t = null, 0 === s && a( '"/"' ) ), null !== t && null !== ( r = A() ) ? e = [e, t, r] : ( e = null, o = u ) ) : ( e = null, o = u ), null !== e && ( e = "/" ), null === e && ( o = i ), e } function L () { var e, t, r, i, u; return i = o, u = o, null !== ( e = A() ) ? ( 61 === n.charCodeAt( o ) ? ( t = "=", o++ ) : ( t = null, 0 === s && a( '"="' ) ), null !== t && null !== ( r = A() ) ? e = [e, t, r] : ( e = null, o = u ) ) : ( e = null, o = u ), null !== e && ( e = "=" ), null === e && ( o = i ), e } function M () { var e, t, r, i, u; return i = o, u = o, null !== ( e = A() ) ? ( 40 === n.charCodeAt( o ) ? ( t = "(", o++ ) : ( t = null, 0 === s && a( '"("' ) ), null !== t && null !== ( r = A() ) ? e = [e, t, r] : ( e = null, o = u ) ) : ( e = null, o = u ), null !== e && ( e = "(" ), null === e && ( o = i ), e } function q () { var e, t, r, i, u; return i = o, u = o, null !== ( e = A() ) ? ( 41 === n.charCodeAt( o ) ? ( t = ")", o++ ) : ( t = null, 0 === s && a( '")"' ) ), null !== t && null !== ( r = A() ) ? e = [e, t, r] : ( e = null, o = u ) ) : ( e = null, o = u ), null !== e && ( e = ")" ), null === e && ( o = i ), e } function H () { var e, t, r, i; return r = o, i = o, 62 === n.charCodeAt( o ) ? ( e = ">", o++ ) : ( e = null, 0 === s && a( '">"' ) ), null !== e && null !== ( t = A() ) ? e = [e, t] : ( e = null, o = i ), null !== e && ( e = ">" ), null === e && ( o = r ), e } function F () { var e, t, r, i; return r = o, i = o, null !== ( e = A() ) ? ( 60 === n.charCodeAt( o ) ? ( t = "<", o++ ) : ( t = null, 0 === s && a( '"<"' ) ), null !== t ? e = [e, t] : ( e = null, o = i ) ) : ( e = null, o = i ), null !== e && ( e = "<" ), null === e && ( o = r ), e } function j () { var e, t, r, i, u; return i = o, u = o, null !== ( e = A() ) ? ( 44 === n.charCodeAt( o ) ? ( t = ",", o++ ) : ( t = null, 0 === s && a( '","' ) ), null !== t && null !== ( r = A() ) ? e = [e, t, r] : ( e = null, o = u ) ) : ( e = null, o = u ), null !== e && ( e = "," ), null === e && ( o = i ), e } function G () { var e, t, r, i, u; return i = o, u = o, null !== ( e = A() ) ? ( 59 === n.charCodeAt( o ) ? ( t = ";", o++ ) : ( t = null, 0 === s && a( '";"' ) ), null !== t && null !== ( r = A() ) ? e = [e, t, r] : ( e = null, o = u ) ) : ( e = null, o = u ), null !== e && ( e = ";" ), null === e && ( o = i ), e } function W () { var e, t, r, i, u; return i = o, u = o, null !== ( e = A() ) ? ( 58 === n.charCodeAt( o ) ? ( t = ":", o++ ) : ( t = null, 0 === s && a( '":"' ) ), null !== t && null !== ( r = A() ) ? e = [e, t, r] : ( e = null, o = u ) ) : ( e = null, o = u ), null !== e && ( e = ":" ), null === e && ( o = i ), e } function B () { var e, t, n, r; return n = o, r = o, null !== ( e = A() ) && null !== ( t = v() ) ? e = [e, t] : ( e = null, o = r ), null !== e && ( e = '"' ), null === e && ( o = n ), e } function Y () { var e, t, n, r; return n = o, r = o, null !== ( e = v() ) && null !== ( t = A() ) ? e = [e, t] : ( e = null, o = r ), null !== e && ( e = '"' ), null === e && ( o = n ), e } function z () { var e; return /^[!-']/.test( n.charAt( o ) ) ? ( e = n.charAt( o ), o++ ) : ( e = null, 0 === s && a( "[!-']" ) ), null === e && ( /^[*-[]/.test( n.charAt( o ) ) ? ( e = n.charAt( o ), o++ ) : ( e = null, 0 === s && a( "[*-[]" ) ), null === e && ( /^[\]-~]/.test( n.charAt( o ) ) ? ( e = n.charAt( o ), o++ ) : ( e = null, 0 === s && a( "[\\]-~]" ) ), null === e && null === ( e = O() ) && ( e = S() ) ) ), e } function V () { var e, t, r, i, s, u, l; if ( s = o, u = o, null !== ( e = A() ) ) if ( null !== ( t = v() ) ) { for ( r = [], null === ( i = $() ) && ( i = J() ); null !== i; )r.push( i ), null === ( i = $() ) && ( i = J() ); null !== r && null !== ( i = v() ) ? e = [e, t, r, i] : ( e = null, o = u ) } else e = null, o = u; else e = null, o = u; return null !== e && ( l = s, e = n.substring( o, l ) ), null === e && ( o = s ), e } function K () { var e, t, r, i, s, u, l, a; if ( s = o, u = o, null !== ( e = A() ) ) if ( null !== ( t = v() ) ) { for ( r = [], null === ( i = $() ) && ( i = J() ); null !== i; )r.push( i ), null === ( i = $() ) && ( i = J() ); null !== r && null !== ( i = v() ) ? e = [e, t, r, i] : ( e = null, o = u ) } else e = null, o = u; else e = null, o = u; return null !== e && ( l = s, e = ( a = n.substring( o, l ).trim() ).substring( 1, a.length - 1 ).replace( /\\([\x00-\x09\x0b-\x0c\x0e-\x7f])/g, "$1" ) ), null === e && ( o = s ), e } function $ () { var e; return null === ( e = S() ) && ( 33 === n.charCodeAt( o ) ? ( e = "!", o++ ) : ( e = null, 0 === s && a( '"!"' ) ), null === e && ( /^[#-[]/.test( n.charAt( o ) ) ? ( e = n.charAt( o ), o++ ) : ( e = null, 0 === s && a( "[#-[]" ) ), null === e && ( /^[\]-~]/.test( n.charAt( o ) ) ? ( e = n.charAt( o ), o++ ) : ( e = null, 0 === s && a( "[\\]-~]" ) ), null === e && ( e = O() ) ) ) ), e } function J () { var e, t, r; return r = o, 92 === n.charCodeAt( o ) ? ( e = "\\", o++ ) : ( e = null, 0 === s && a( '"\\\\"' ) ), null !== e ? ( /^[\0-\t]/.test( n.charAt( o ) ) ? ( t = n.charAt( o ), o++ ) : ( t = null, 0 === s && a( "[\\0-\\t]" ) ), null === t && ( /^[\x0B-\f]/.test( n.charAt( o ) ) ? ( t = n.charAt( o ), o++ ) : ( t = null, 0 === s && a( "[\\x0B-\\f]" ) ), null === t && ( /^[\x0E-]/.test( n.charAt( o ) ) ? ( t = n.charAt( o ), o++ ) : ( t = null, 0 === s && a( "[\\x0E-]" ) ) ) ), null !== t ? e = [e, t] : ( e = null, o = r ) ) : ( e = null, o = r ), e } function X () { var e, t, r, i, u, l; return u = o, l = o, null !== ( e = Z() ) ? ( 58 === n.charCodeAt( o ) ? ( t = ":", o++ ) : ( t = null, 0 === s && a( '":"' ) ), null !== t && null !== ( r = null !== ( r = ne() ) ? r : "" ) && null !== ( i = se() ) ? e = [e, t, r, i] : ( e = null, o = l ) ) : ( e = null, o = l ), null !== e && ( e = function ( e ) { try { Fn.uri = new qn( Fn.scheme, Fn.user, Fn.host, Fn.port ), delete Fn.scheme, delete Fn.user, delete Fn.host, delete Fn.host_type, delete Fn.port } catch ( e ) { Fn = -1 } }() ), null === e && ( o = u ), e } function Q () { var e, t, i, u, l, c, f, h; return f = o, h = o, null !== ( e = Z() ) ? ( 58 === n.charCodeAt( o ) ? ( t = ":", o++ ) : ( t = null, 0 === s && a( '":"' ) ), null !== t && null !== ( i = null !== ( i = ne() ) ? i : "" ) && null !== ( u = se() ) && null !== ( l = ge() ) && null !== ( c = null !== ( c = xe() ) ? c : "" ) ? e = [e, t, i, u, l, c] : ( e = null, o = h ) ) : ( e = null, o = h ), null !== e && ( e = function ( e ) { try { Fn.uri = new qn( Fn.scheme, Fn.user, Fn.host, Fn.port, Fn.uri_params, Fn.uri_headers ), delete Fn.scheme, delete Fn.user, delete Fn.host, delete Fn.host_type, delete Fn.port, delete Fn.uri_params, "SIP_URI" === r && ( Fn = Fn.uri ) } catch ( e ) { Fn = -1 } }() ), null === e && ( o = f ), e } function Z () { var e; return null === ( e = ee() ) && ( e = te() ), e } function ee () { var e, t, r; return t = o, "sips" === n.substr( o, 4 ).toLowerCase() ? ( e = n.substr( o, 4 ), o += 4 ) : ( e = null, 0 === s && a( '"sips"' ) ), null !== e && ( r = e, e = void ( Fn.scheme = r.toLowerCase() ) ), null === e && ( o = t ), e } function te () { var e, t, r; return t = o, "sip" === n.substr( o, 3 ).toLowerCase() ? ( e = n.substr( o, 3 ), o += 3 ) : ( e = null, 0 === s && a( '"sip"' ) ), null !== e && ( r = e, e = void ( Fn.scheme = r.toLowerCase() ) ), null === e && ( o = t ), e } function ne () { var e, t, r, i, u, l, c; return i = o, u = o, null !== ( e = re() ) ? ( l = o, 58 === n.charCodeAt( o ) ? ( t = ":", o++ ) : ( t = null, 0 === s && a( '":"' ) ), null !== t && null !== ( r = oe() ) ? t = [t, r] : ( t = null, o = l ), null !== ( t = null !== t ? t : "" ) ? ( 64 === n.charCodeAt( o ) ? ( r = "@", o++ ) : ( r = null, 0 === s && a( '"@"' ) ), null !== r ? e = [e, t, r] : ( e = null, o = u ) ) : ( e = null, o = u ) ) : ( e = null, o = u ), null !== e && ( c = i, e = void ( Fn.user = decodeURIComponent( n.substring( o - 1, c ) ) ) ), null === e && ( o = i ), e } function re () { var e, t; if ( null === ( t = C() ) && null === ( t = E() ) && ( t = ie() ), null !== t ) for ( e = []; null !== t; )e.push( t ), null === ( t = C() ) && null === ( t = E() ) && ( t = ie() ); else e = null; return e } function ie () { var e; return 38 === n.charCodeAt( o ) ? ( e = "&", o++ ) : ( e = null, 0 === s && a( '"&"' ) ), null === e && ( 61 === n.charCodeAt( o ) ? ( e = "=", o++ ) : ( e = null, 0 === s && a( '"="' ) ), null === e && ( 43 === n.charCodeAt( o ) ? ( e = "+", o++ ) : ( e = null, 0 === s && a( '"+"' ) ), null === e && ( 36 === n.charCodeAt( o ) ? ( e = "$", o++ ) : ( e = null, 0 === s && a( '"$"' ) ), null === e && ( 44 === n.charCodeAt( o ) ? ( e = ",", o++ ) : ( e = null, 0 === s && a( '","' ) ), null === e && ( 59 === n.charCodeAt( o ) ? ( e = ";", o++ ) : ( e = null, 0 === s && a( '";"' ) ), null === e && ( 63 === n.charCodeAt( o ) ? ( e = "?", o++ ) : ( e = null, 0 === s && a( '"?"' ) ), null === e && ( 47 === n.charCodeAt( o ) ? ( e = "/", o++ ) : ( e = null, 0 === s && a( '"/"' ) ) ) ) ) ) ) ) ), e } function oe () { var e, t, r, i; for ( r = o, e = [], null === ( t = C() ) && null === ( t = E() ) && ( 38 === n.charCodeAt( o ) ? ( t = "&", o++ ) : ( t = null, 0 === s && a( '"&"' ) ), null === t && ( 61 === n.charCodeAt( o ) ? ( t = "=", o++ ) : ( t = null, 0 === s && a( '"="' ) ), null === t && ( 43 === n.charCodeAt( o ) ? ( t = "+", o++ ) : ( t = null, 0 === s && a( '"+"' ) ), null === t && ( 36 === n.charCodeAt( o ) ? ( t = "$", o++ ) : ( t = null, 0 === s && a( '"$"' ) ), null === t && ( 44 === n.charCodeAt( o ) ? ( t = ",", o++ ) : ( t = null, 0 === s && a( '","' ) ) ) ) ) ) ); null !== t; )e.push( t ), null === ( t = C() ) && null === ( t = E() ) && ( 38 === n.charCodeAt( o ) ? ( t = "&", o++ ) : ( t = null, 0 === s && a( '"&"' ) ), null === t && ( 61 === n.charCodeAt( o ) ? ( t = "=", o++ ) : ( t = null, 0 === s && a( '"="' ) ), null === t && ( 43 === n.charCodeAt( o ) ? ( t = "+", o++ ) : ( t = null, 0 === s && a( '"+"' ) ), null === t && ( 36 === n.charCodeAt( o ) ? ( t = "$", o++ ) : ( t = null, 0 === s && a( '"$"' ) ), null === t && ( 44 === n.charCodeAt( o ) ? ( t = ",", o++ ) : ( t = null, 0 === s && a( '","' ) ) ) ) ) ) ); return null !== e && ( i = r, e = void ( Fn.password = n.substring( o, i ) ) ), null === e && ( o = r ), e } function se () { var e, t, r, i, u; return i = o, null !== ( e = ue() ) ? ( u = o, 58 === n.charCodeAt( o ) ? ( t = ":", o++ ) : ( t = null, 0 === s && a( '":"' ) ), null !== t && null !== ( r = me() ) ? t = [t, r] : ( t = null, o = u ), null !== ( t = null !== t ? t : "" ) ? e = [e, t] : ( e = null, o = i ) ) : ( e = null, o = i ), e } function ue () { var e, t, r; return t = o, null === ( e = le() ) && null === ( e = pe() ) && ( e = fe() ), null !== e && ( r = t, Fn.host = n.substring( o, r ).toLowerCase(), e = Fn.host ), null === e && ( o = t ), e } function le () { var e, t, r, i, u, l, c; for ( i = o, u = o, e = [], l = o, null !== ( t = ae() ) ? ( 46 === n.charCodeAt( o ) ? ( r = ".", o++ ) : ( r = null, 0 === s && a( '"."' ) ), null !== r ? t = [t, r] : ( t = null, o = l ) ) : ( t = null, o = l ); null !== t; )e.push( t ), l = o, null !== ( t = ae() ) ? ( 46 === n.charCodeAt( o ) ? ( r = ".", o++ ) : ( r = null, 0 === s && a( '"."' ) ), null !== r ? t = [t, r] : ( t = null, o = l ) ) : ( t = null, o = l ); return null !== e && null !== ( t = ce() ) ? ( 46 === n.charCodeAt( o ) ? ( r = ".", o++ ) : ( r = null, 0 === s && a( '"."' ) ), null !== ( r = null !== r ? r : "" ) ? e = [e, t, r] : ( e = null, o = u ) ) : ( e = null, o = u ), null !== e && ( c = i, Fn.host_type = "domain", e = n.substring( o, c ) ), null === e && ( o = i ), e } function ae () { var e, t, r, i; if ( i = o, null !== ( e = y() ) ) { for ( t = [], null === ( r = y() ) && ( 45 === n.charCodeAt( o ) ? ( r = "-", o++ ) : ( r = null, 0 === s && a( '"-"' ) ), null === r && ( 95 === n.charCodeAt( o ) ? ( r = "_", o++ ) : ( r = null, 0 === s && a( '"_"' ) ) ) ); null !== r; )t.push( r ), null === ( r = y() ) && ( 45 === n.charCodeAt( o ) ? ( r = "-", o++ ) : ( r = null, 0 === s && a( '"-"' ) ), null === r && ( 95 === n.charCodeAt( o ) ? ( r = "_", o++ ) : ( r = null, 0 === s && a( '"_"' ) ) ) ); null !== t ? e = [e, t] : ( e = null, o = i ) } else e = null, o = i; return e } function ce () { var e, t, r, i; if ( i = o, null !== ( e = h() ) ) { for ( t = [], null === ( r = y() ) && ( 45 === n.charCodeAt( o ) ? ( r = "-", o++ ) : ( r = null, 0 === s && a( '"-"' ) ), null === r && ( 95 === n.charCodeAt( o ) ? ( r = "_", o++ ) : ( r = null, 0 === s && a( '"_"' ) ) ) ); null !== r; )t.push( r ), null === ( r = y() ) && ( 45 === n.charCodeAt( o ) ? ( r = "-", o++ ) : ( r = null, 0 === s && a( '"-"' ) ), null === r && ( 95 === n.charCodeAt( o ) ? ( r = "_", o++ ) : ( r = null, 0 === s && a( '"_"' ) ) ) ); null !== t ? e = [e, t] : ( e = null, o = i ) } else e = null, o = i; return e } function fe () { var e, t, r, i, u, l; return i = o, u = o, 91 === n.charCodeAt( o ) ? ( e = "[", o++ ) : ( e = null, 0 === s && a( '"["' ) ), null !== e && null !== ( t = he() ) ? ( 93 === n.charCodeAt( o ) ? ( r = "]", o++ ) : ( r = null, 0 === s && a( '"]"' ) ), null !== r ? e = [e, t, r] : ( e = null, o = u ) ) : ( e = null, o = u ), null !== e && ( l = i, Fn.host_type = "IPv6", e = n.substring( o, l ) ), null === e && ( o = i ), e } function he () { var e, t, r, i, u, l, c, f, h, d, _, p, v, m, g, y, T; return m = o, g = o, null !== ( e = de() ) ? ( 58 === n.charCodeAt( o ) ? ( t = ":", o++ ) : ( t = null, 0 === s && a( '":"' ) ), null !== t && null !== ( r = de() ) ? ( 58 === n.charCodeAt( o ) ? ( i = ":", o++ ) : ( i = null, 0 === s && a( '":"' ) ), null !== i && null !== ( u = de() ) ? ( 58 === n.charCodeAt( o ) ? ( l = ":", o++ ) : ( l = null, 0 === s && a( '":"' ) ), null !== l && null !== ( c = de() ) ? ( 58 === n.charCodeAt( o ) ? ( f = ":", o++ ) : ( f = null, 0 === s && a( '":"' ) ), null !== f && null !== ( h = de() ) ? ( 58 === n.charCodeAt( o ) ? ( d = ":", o++ ) : ( d = null, 0 === s && a( '":"' ) ), null !== d && null !== ( _ = de() ) ? ( 58 === n.charCodeAt( o ) ? ( p = ":", o++ ) : ( p = null, 0 === s && a( '":"' ) ), null !== p && null !== ( v = _e() ) ? e = [e, t, r, i, u, l, c, f, h, d, _, p, v] : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ), null === e && ( g = o, "::" === n.substr( o, 2 ) ? ( e = "::", o += 2 ) : ( e = null, 0 === s && a( '"::"' ) ), null !== e && null !== ( t = de() ) ? ( 58 === n.charCodeAt( o ) ? ( r = ":", o++ ) : ( r = null, 0 === s && a( '":"' ) ), null !== r && null !== ( i = de() ) ? ( 58 === n.charCodeAt( o ) ? ( u = ":", o++ ) : ( u = null, 0 === s && a( '":"' ) ), null !== u && null !== ( l = de() ) ? ( 58 === n.charCodeAt( o ) ? ( c = ":", o++ ) : ( c = null, 0 === s && a( '":"' ) ), null !== c && null !== ( f = de() ) ? ( 58 === n.charCodeAt( o ) ? ( h = ":", o++ ) : ( h = null, 0 === s && a( '":"' ) ), null !== h && null !== ( d = de() ) ? ( 58 === n.charCodeAt( o ) ? ( _ = ":", o++ ) : ( _ = null, 0 === s && a( '":"' ) ), null !== _ && null !== ( p = _e() ) ? e = [e, t, r, i, u, l, c, f, h, d, _, p] : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ), null === e && ( g = o, "::" === n.substr( o, 2 ) ? ( e = "::", o += 2 ) : ( e = null, 0 === s && a( '"::"' ) ), null !== e && null !== ( t = de() ) ? ( 58 === n.charCodeAt( o ) ? ( r = ":", o++ ) : ( r = null, 0 === s && a( '":"' ) ), null !== r && null !== ( i = de() ) ? ( 58 === n.charCodeAt( o ) ? ( u = ":", o++ ) : ( u = null, 0 === s && a( '":"' ) ), null !== u && null !== ( l = de() ) ? ( 58 === n.charCodeAt( o ) ? ( c = ":", o++ ) : ( c = null, 0 === s && a( '":"' ) ), null !== c && null !== ( f = de() ) ? ( 58 === n.charCodeAt( o ) ? ( h = ":", o++ ) : ( h = null, 0 === s && a( '":"' ) ), null !== h && null !== ( d = _e() ) ? e = [e, t, r, i, u, l, c, f, h, d] : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ), null === e && ( g = o, "::" === n.substr( o, 2 ) ? ( e = "::", o += 2 ) : ( e = null, 0 === s && a( '"::"' ) ), null !== e && null !== ( t = de() ) ? ( 58 === n.charCodeAt( o ) ? ( r = ":", o++ ) : ( r = null, 0 === s && a( '":"' ) ), null !== r && null !== ( i = de() ) ? ( 58 === n.charCodeAt( o ) ? ( u = ":", o++ ) : ( u = null, 0 === s && a( '":"' ) ), null !== u && null !== ( l = de() ) ? ( 58 === n.charCodeAt( o ) ? ( c = ":", o++ ) : ( c = null, 0 === s && a( '":"' ) ), null !== c && null !== ( f = _e() ) ? e = [e, t, r, i, u, l, c, f] : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ), null === e && ( g = o, "::" === n.substr( o, 2 ) ? ( e = "::", o += 2 ) : ( e = null, 0 === s && a( '"::"' ) ), null !== e && null !== ( t = de() ) ? ( 58 === n.charCodeAt( o ) ? ( r = ":", o++ ) : ( r = null, 0 === s && a( '":"' ) ), null !== r && null !== ( i = de() ) ? ( 58 === n.charCodeAt( o ) ? ( u = ":", o++ ) : ( u = null, 0 === s && a( '":"' ) ), null !== u && null !== ( l = _e() ) ? e = [e, t, r, i, u, l] : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ), null === e && ( g = o, "::" === n.substr( o, 2 ) ? ( e = "::", o += 2 ) : ( e = null, 0 === s && a( '"::"' ) ), null !== e && null !== ( t = de() ) ? ( 58 === n.charCodeAt( o ) ? ( r = ":", o++ ) : ( r = null, 0 === s && a( '":"' ) ), null !== r && null !== ( i = _e() ) ? e = [e, t, r, i] : ( e = null, o = g ) ) : ( e = null, o = g ), null === e && ( g = o, "::" === n.substr( o, 2 ) ? ( e = "::", o += 2 ) : ( e = null, 0 === s && a( '"::"' ) ), null !== e && null !== ( t = _e() ) ? e = [e, t] : ( e = null, o = g ), null === e && ( g = o, "::" === n.substr( o, 2 ) ? ( e = "::", o += 2 ) : ( e = null, 0 === s && a( '"::"' ) ), null !== e && null !== ( t = de() ) ? e = [e, t] : ( e = null, o = g ), null === e && ( g = o, null !== ( e = de() ) ? ( "::" === n.substr( o, 2 ) ? ( t = "::", o += 2 ) : ( t = null, 0 === s && a( '"::"' ) ), null !== t && null !== ( r = de() ) ? ( 58 === n.charCodeAt( o ) ? ( i = ":", o++ ) : ( i = null, 0 === s && a( '":"' ) ), null !== i && null !== ( u = de() ) ? ( 58 === n.charCodeAt( o ) ? ( l = ":", o++ ) : ( l = null, 0 === s && a( '":"' ) ), null !== l && null !== ( c = de() ) ? ( 58 === n.charCodeAt( o ) ? ( f = ":", o++ ) : ( f = null, 0 === s && a( '":"' ) ), null !== f && null !== ( h = de() ) ? ( 58 === n.charCodeAt( o ) ? ( d = ":", o++ ) : ( d = null, 0 === s && a( '":"' ) ), null !== d && null !== ( _ = _e() ) ? e = [e, t, r, i, u, l, c, f, h, d, _] : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ), null === e && ( g = o, null !== ( e = de() ) ? ( y = o, 58 === n.charCodeAt( o ) ? ( t = ":", o++ ) : ( t = null, 0 === s && a( '":"' ) ), null !== t && null !== ( r = de() ) ? t = [t, r] : ( t = null, o = y ), null !== ( t = null !== t ? t : "" ) ? ( "::" === n.substr( o, 2 ) ? ( r = "::", o += 2 ) : ( r = null, 0 === s && a( '"::"' ) ), null !== r && null !== ( i = de() ) ? ( 58 === n.charCodeAt( o ) ? ( u = ":", o++ ) : ( u = null, 0 === s && a( '":"' ) ), null !== u && null !== ( l = de() ) ? ( 58 === n.charCodeAt( o ) ? ( c = ":", o++ ) : ( c = null, 0 === s && a( '":"' ) ), null !== c && null !== ( f = de() ) ? ( 58 === n.charCodeAt( o ) ? ( h = ":", o++ ) : ( h = null, 0 === s && a( '":"' ) ), null !== h && null !== ( d = _e() ) ? e = [e, t, r, i, u, l, c, f, h, d] : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ), null === e && ( g = o, null !== ( e = de() ) ? ( y = o, 58 === n.charCodeAt( o ) ? ( t = ":", o++ ) : ( t = null, 0 === s && a( '":"' ) ), null !== t && null !== ( r = de() ) ? t = [t, r] : ( t = null, o = y ), null !== ( t = null !== t ? t : "" ) ? ( y = o, 58 === n.charCodeAt( o ) ? ( r = ":", o++ ) : ( r = null, 0 === s && a( '":"' ) ), null !== r && null !== ( i = de() ) ? r = [r, i] : ( r = null, o = y ), null !== ( r = null !== r ? r : "" ) ? ( "::" === n.substr( o, 2 ) ? ( i = "::", o += 2 ) : ( i = null, 0 === s && a( '"::"' ) ), null !== i && null !== ( u = de() ) ? ( 58 === n.charCodeAt( o ) ? ( l = ":", o++ ) : ( l = null, 0 === s && a( '":"' ) ), null !== l && null !== ( c = de() ) ? ( 58 === n.charCodeAt( o ) ? ( f = ":", o++ ) : ( f = null, 0 === s && a( '":"' ) ), null !== f && null !== ( h = _e() ) ? e = [e, t, r, i, u, l, c, f, h] : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ), null === e && ( g = o, null !== ( e = de() ) ? ( y = o, 58 === n.charCodeAt( o ) ? ( t = ":", o++ ) : ( t = null, 0 === s && a( '":"' ) ), null !== t && null !== ( r = de() ) ? t = [t, r] : ( t = null, o = y ), null !== ( t = null !== t ? t : "" ) ? ( y = o, 58 === n.charCodeAt( o ) ? ( r = ":", o++ ) : ( r = null, 0 === s && a( '":"' ) ), null !== r && null !== ( i = de() ) ? r = [r, i] : ( r = null, o = y ), null !== ( r = null !== r ? r : "" ) ? ( y = o, 58 === n.charCodeAt( o ) ? ( i = ":", o++ ) : ( i = null, 0 === s && a( '":"' ) ), null !== i && null !== ( u = de() ) ? i = [i, u] : ( i = null, o = y ), null !== ( i = null !== i ? i : "" ) ? ( "::" === n.substr( o, 2 ) ? ( u = "::", o += 2 ) : ( u = null, 0 === s && a( '"::"' ) ), null !== u && null !== ( l = de() ) ? ( 58 === n.charCodeAt( o ) ? ( c = ":", o++ ) : ( c = null, 0 === s && a( '":"' ) ), null !== c && null !== ( f = _e() ) ? e = [e, t, r, i, u, l, c, f] : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ), null === e && ( g = o, null !== ( e = de() ) ? ( y = o, 58 === n.charCodeAt( o ) ? ( t = ":", o++ ) : ( t = null, 0 === s && a( '":"' ) ), null !== t && null !== ( r = de() ) ? t = [t, r] : ( t = null, o = y ), null !== ( t = null !== t ? t : "" ) ? ( y = o, 58 === n.charCodeAt( o ) ? ( r = ":", o++ ) : ( r = null, 0 === s && a( '":"' ) ), null !== r && null !== ( i = de() ) ? r = [r, i] : ( r = null, o = y ), null !== ( r = null !== r ? r : "" ) ? ( y = o, 58 === n.charCodeAt( o ) ? ( i = ":", o++ ) : ( i = null, 0 === s && a( '":"' ) ), null !== i && null !== ( u = de() ) ? i = [i, u] : ( i = null, o = y ), null !== ( i = null !== i ? i : "" ) ? ( y = o, 58 === n.charCodeAt( o ) ? ( u = ":", o++ ) : ( u = null, 0 === s && a( '":"' ) ), null !== u && null !== ( l = de() ) ? u = [u, l] : ( u = null, o = y ), null !== ( u = null !== u ? u : "" ) ? ( "::" === n.substr( o, 2 ) ? ( l = "::", o += 2 ) : ( l = null, 0 === s && a( '"::"' ) ), null !== l && null !== ( c = _e() ) ? e = [e, t, r, i, u, l, c] : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ), null === e && ( g = o, null !== ( e = de() ) ? ( y = o, 58 === n.charCodeAt( o ) ? ( t = ":", o++ ) : ( t = null, 0 === s && a( '":"' ) ), null !== t && null !== ( r = de() ) ? t = [t, r] : ( t = null, o = y ), null !== ( t = null !== t ? t : "" ) ? ( y = o, 58 === n.charCodeAt( o ) ? ( r = ":", o++ ) : ( r = null, 0 === s && a( '":"' ) ), null !== r && null !== ( i = de() ) ? r = [r, i] : ( r = null, o = y ), null !== ( r = null !== r ? r : "" ) ? ( y = o, 58 === n.charCodeAt( o ) ? ( i = ":", o++ ) : ( i = null, 0 === s && a( '":"' ) ), null !== i && null !== ( u = de() ) ? i = [i, u] : ( i = null, o = y ), null !== ( i = null !== i ? i : "" ) ? ( y = o, 58 === n.charCodeAt( o ) ? ( u = ":", o++ ) : ( u = null, 0 === s && a( '":"' ) ), null !== u && null !== ( l = de() ) ? u = [u, l] : ( u = null, o = y ), null !== ( u = null !== u ? u : "" ) ? ( y = o, 58 === n.charCodeAt( o ) ? ( l = ":", o++ ) : ( l = null, 0 === s && a( '":"' ) ), null !== l && null !== ( c = de() ) ? l = [l, c] : ( l = null, o = y ), null !== ( l = null !== l ? l : "" ) ? ( "::" === n.substr( o, 2 ) ? ( c = "::", o += 2 ) : ( c = null, 0 === s && a( '"::"' ) ), null !== c && null !== ( f = de() ) ? e = [e, t, r, i, u, l, c, f] : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ), null === e && ( g = o, null !== ( e = de() ) ? ( y = o, 58 === n.charCodeAt( o ) ? ( t = ":", o++ ) : ( t = null, 0 === s && a( '":"' ) ), null !== t && null !== ( r = de() ) ? t = [t, r] : ( t = null, o = y ), null !== ( t = null !== t ? t : "" ) ? ( y = o, 58 === n.charCodeAt( o ) ? ( r = ":", o++ ) : ( r = null, 0 === s && a( '":"' ) ), null !== r && null !== ( i = de() ) ? r = [r, i] : ( r = null, o = y ), null !== ( r = null !== r ? r : "" ) ? ( y = o, 58 === n.charCodeAt( o ) ? ( i = ":", o++ ) : ( i = null, 0 === s && a( '":"' ) ), null !== i && null !== ( u = de() ) ? i = [i, u] : ( i = null, o = y ), null !== ( i = null !== i ? i : "" ) ? ( y = o, 58 === n.charCodeAt( o ) ? ( u = ":", o++ ) : ( u = null, 0 === s && a( '":"' ) ), null !== u && null !== ( l = de() ) ? u = [u, l] : ( u = null, o = y ), null !== ( u = null !== u ? u : "" ) ? ( y = o, 58 === n.charCodeAt( o ) ? ( l = ":", o++ ) : ( l = null, 0 === s && a( '":"' ) ), null !== l && null !== ( c = de() ) ? l = [l, c] : ( l = null, o = y ), null !== ( l = null !== l ? l : "" ) ? ( y = o, 58 === n.charCodeAt( o ) ? ( c = ":", o++ ) : ( c = null, 0 === s && a( '":"' ) ), null !== c && null !== ( f = de() ) ? c = [c, f] : ( c = null, o = y ), null !== ( c = null !== c ? c : "" ) ? ( "::" === n.substr( o, 2 ) ? ( f = "::", o += 2 ) : ( f = null, 0 === s && a( '"::"' ) ), null !== f ? e = [e, t, r, i, u, l, c, f] : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ) ) : ( e = null, o = g ) ) ) ) ) ) ) ) ) ) ) ) ) ) ), null !== e && ( T = m, Fn.host_type = "IPv6", e = n.substring( o, T ) ), null === e && ( o = m ), e } function de () { var e, t, n, r, i; return i = o, null !== ( e = d() ) && null !== ( t = null !== ( t = d() ) ? t : "" ) && null !== ( n = null !== ( n = d() ) ? n : "" ) && null !== ( r = null !== ( r = d() ) ? r : "" ) ? e = [e, t, n, r] : ( e = null, o = i ), e } function _e () { var e, t, r, i; return i = o, null !== ( e = de() ) ? ( 58 === n.charCodeAt( o ) ? ( t = ":", o++ ) : ( t = null, 0 === s && a( '":"' ) ), null !== t && null !== ( r = de() ) ? e = [e, t, r] : ( e = null, o = i ) ) : ( e = null, o = i ), null === e && ( e = pe() ), e } function pe () { var e, t, r, i, u, l, c, f, h, d; return f = o, h = o, null !== ( e = ve() ) ? ( 46 === n.charCodeAt( o ) ? ( t = ".", o++ ) : ( t = null, 0 === s && a( '"."' ) ), null !== t && null !== ( r = ve() ) ? ( 46 === n.charCodeAt( o ) ? ( i = ".", o++ ) : ( i = null, 0 === s && a( '"."' ) ), null !== i && null !== ( u = ve() ) ? ( 46 === n.charCodeAt( o ) ? ( l = ".", o++ ) : ( l = null, 0 === s && a( '"."' ) ), null !== l && null !== ( c = ve() ) ? e = [e, t, r, i, u, l, c] : ( e = null, o = h ) ) : ( e = null, o = h ) ) : ( e = null, o = h ) ) : ( e = null, o = h ), null !== e && ( d = f, Fn.host_type = "IPv4", e = n.substring( o, d ) ), null === e && ( o = f ), e } function ve () { var e, t, r, i; return i = o, "25" === n.substr( o, 2 ) ? ( e = "25", o += 2 ) : ( e = null, 0 === s && a( '"25"' ) ), null !== e ? ( /^[0-5]/.test( n.charAt( o ) ) ? ( t = n.charAt( o ), o++ ) : ( t = null, 0 === s && a( "[0-5]" ) ), null !== t ? e = [e, t] : ( e = null, o = i ) ) : ( e = null, o = i ), null === e && ( i = o, 50 === n.charCodeAt( o ) ? ( e = "2", o++ ) : ( e = null, 0 === s && a( '"2"' ) ), null !== e ? ( /^[0-4]/.test( n.charAt( o ) ) ? ( t = n.charAt( o ), o++ ) : ( t = null, 0 === s && a( "[0-4]" ) ), null !== t && null !== ( r = f() ) ? e = [e, t, r] : ( e = null, o = i ) ) : ( e = null, o = i ), null === e && ( i = o, 49 === n.charCodeAt( o ) ? ( e = "1", o++ ) : ( e = null, 0 === s && a( '"1"' ) ), null !== e && null !== ( t = f() ) && null !== ( r = f() ) ? e = [e, t, r] : ( e = null, o = i ), null === e && ( i = o, /^[1-9]/.test( n.charAt( o ) ) ? ( e = n.charAt( o ), o++ ) : ( e = null, 0 === s && a( "[1-9]" ) ), null !== e && null !== ( t = f() ) ? e = [e, t] : ( e = null, o = i ), null === e && ( e = f() ) ) ) ), e } function me () { var e, t, n, r, i, s, u, l; return s = o, u = o, null !== ( e = null !== ( e = f() ) ? e : "" ) && null !== ( t = null !== ( t = f() ) ? t : "" ) && null !== ( n = null !== ( n = f() ) ? n : "" ) && null !== ( r = null !== ( r = f() ) ? r : "" ) && null !== ( i = null !== ( i = f() ) ? i : "" ) ? e = [e, t, n, r, i] : ( e = null, o = u ), null !== e && ( l = e, l = parseInt( l.join( "" ) ), Fn.port = l, e = l ), null === e && ( o = s ), e } function ge () { var e, t, r, i; for ( e = [], i = o, 59 === n.charCodeAt( o ) ? ( t = ";", o++ ) : ( t = null, 0 === s && a( '";"' ) ), null !== t && null !== ( r = ye() ) ? t = [t, r] : ( t = null, o = i ); null !== t; )e.push( t ), i = o, 59 === n.charCodeAt( o ) ? ( t = ";", o++ ) : ( t = null, 0 === s && a( '";"' ) ), null !== t && null !== ( r = ye() ) ? t = [t, r] : ( t = null, o = i ); return e } function ye () { var e; return null === ( e = Te() ) && null === ( e = Ce() ) && null === ( e = be() ) && null === ( e = Ee() ) && null === ( e = Se() ) && null === ( e = Ae() ) && ( e = we() ), e } function Te () { var e, t, r, i, u; return r = o, i = o, "transport=" === n.substr( o, 10 ).toLowerCase() ? ( e = n.substr( o, 10 ), o += 10 ) : ( e = null, 0 === s && a( '"transport="' ) ), null !== e ? ( "udp" === n.substr( o, 3 ).toLowerCase() ? ( t = n.substr( o, 3 ), o += 3 ) : ( t = null, 0 === s && a( '"udp"' ) ), null === t && ( "tcp" === n.substr( o, 3 ).toLowerCase() ? ( t = n.substr( o, 3 ), o += 3 ) : ( t = null, 0 === s && a( '"tcp"' ) ), null === t && ( "sctp" === n.substr( o, 4 ).toLowerCase() ? ( t = n.substr( o, 4 ), o += 4 ) : ( t = null, 0 === s && a( '"sctp"' ) ), null === t && ( "tls" === n.substr( o, 3 ).toLowerCase() ? ( t = n.substr( o, 3 ), o += 3 ) : ( t = null, 0 === s && a( '"tls"' ) ), null === t && ( t = x() ) ) ) ), null !== t ? e = [e, t] : ( e = null, o = i ) ) : ( e = null, o = i ), null !== e && ( u = e[1], Fn.uri_params || ( Fn.uri_params = {} ), e = void ( Fn.uri_params.transport = u.toLowerCase() ) ), null === e && ( o = r ), e } function Ce () { var e, t, r, i, u; return r = o, i = o, "user=" === n.substr( o, 5 ).toLowerCase() ? ( e = n.substr( o, 5 ), o += 5 ) : ( e = null, 0 === s && a( '"user="' ) ), null !== e ? ( "phone" === n.substr( o, 5 ).toLowerCase() ? ( t = n.substr( o, 5 ), o += 5 ) : ( t = null, 0 === s && a( '"phone"' ) ), null === t && ( "ip" === n.substr( o, 2 ).toLowerCase() ? ( t = n.substr( o, 2 ), o += 2 ) : ( t = null, 0 === s && a( '"ip"' ) ), null === t && ( t = x() ) ), null !== t ? e = [e, t] : ( e = null, o = i ) ) : ( e = null, o = i ), null !== e && ( u = e[1], Fn.uri_params || ( Fn.uri_params = {} ), e = void ( Fn.uri_params.user = u.toLowerCase() ) ), null === e && ( o = r ), e } function be () { var e, t, r, i, u; return r = o, i = o, "method=" === n.substr( o, 7 ).toLowerCase() ? ( e = n.substr( o, 7 ), o += 7 ) : ( e = null, 0 === s && a( '"method="' ) ), null !== e && null !== ( t = ct() ) ? e = [e, t] : ( e = null, o = i ), null !== e && ( u = e[1], Fn.uri_params || ( Fn.uri_params = {} ), e = void ( Fn.uri_params.method = u ) ), null === e && ( o = r ), e } function Ee () { var e, t, r, i, u; return r = o, i = o, "ttl=" === n.substr( o, 4 ).toLowerCase() ? ( e = n.substr( o, 4 ), o += 4 ) : ( e = null, 0 === s && a( '"ttl="' ) ), null !== e && null !== ( t = Sn() ) ? e = [e, t] : ( e = null, o = i ), null !== e && ( u = e[1], Fn.params || ( Fn.params = {} ), e = void ( Fn.params.ttl = u ) ), null === e && ( o = r ), e } function Se () { var e, t, r, i, u; return r = o, i = o, "maddr=" === n.substr( o, 6 ).toLowerCase() ? ( e = n.substr( o, 6 ), o += 6 ) : ( e = null, 0 === s && a( '"maddr="' ) ), null !== e && null !== ( t = ue() ) ? e = [e, t] : ( e = null, o = i ), null !== e && ( u = e[1], Fn.uri_params || ( Fn.uri_params = {} ), e = void ( Fn.uri_params.maddr = u ) ), null === e && ( o = r ), e } function Ae () { var e, t, r, i, u, l; return i = o, u = o, "lr" === n.substr( o, 2 ).toLowerCase() ? ( e = n.substr( o, 2 ), o += 2 ) : ( e = null, 0 === s && a( '"lr"' ) ), null !== e ? ( l = o, 61 === n.charCodeAt( o ) ? ( t = "=", o++ ) : ( t = null, 0 === s && a( '"="' ) ), null !== t && null !== ( r = x() ) ? t = [t, r] : ( t = null, o = l ), null !== ( t = null !== t ? t : "" ) ? e = [e, t] : ( e = null, o = u ) ) : ( e = null, o = u ), null !== e && ( Fn.uri_params || ( Fn.uri_params = {} ), e = void ( Fn.uri_params.lr = void 0 ) ), null === e && ( o = i ), e } function we () { var e, t, r, i, u, l, c, f; return i = o, u = o, null !== ( e = Re() ) ? ( l = o, 61 === n.charCodeAt( o ) ? ( t = "=", o++ ) : ( t = null, 0 === s && a( '"="' ) ), null !== t && null !== ( r = Ie() ) ? t = [t, r] : ( t = null, o = l ), null !== ( t = null !== t ? t : "" ) ? e = [e, t] : ( e = null, o = u ) ) : ( e = null, o = u ), null !== e && ( c = e[0], f = e[1], Fn.uri_params || ( Fn.uri_params = {} ), f = void 0 === f ? void 0 : f[1], e = void ( Fn.uri_params[c.toLowerCase()] = f ) ), null === e && ( o = i ), e } function Re () { var e, t, n; if ( n = o, null !== ( t = Oe() ) ) for ( e = []; null !== t; )e.push( t ), t = Oe(); else e = null; return null !== e && ( e = e.join( "" ) ), null === e && ( o = n ), e } function Ie () { var e, t, n; if ( n = o, null !== ( t = Oe() ) ) for ( e = []; null !== t; )e.push( t ), t = Oe(); else e = null; return null !== e && ( e = e.join( "" ) ), null === e && ( o = n ), e } function Oe () { var e; return null === ( e = ke() ) && null === ( e = C() ) && ( e = E() ), e } function ke () { var e; return 91 === n.charCodeAt( o ) ? ( e = "[", o++ ) : ( e = null, 0 === s && a( '"["' ) ), null === e && ( 93 === n.charCodeAt( o ) ? ( e = "]", o++ ) : ( e = null, 0 === s && a( '"]"' ) ), null === e && ( 47 === n.charCodeAt( o ) ? ( e = "/", o++ ) : ( e = null, 0 === s && a( '"/"' ) ), null === e && ( 58 === n.charCodeAt( o ) ? ( e = ":", o++ ) : ( e = null, 0 === s && a( '":"' ) ), null === e && ( 38 === n.charCodeAt( o ) ? ( e = "&", o++ ) : ( e = null, 0 === s && a( '"&"' ) ), null === e && ( 43 === n.charCodeAt( o ) ? ( e = "+", o++ ) : ( e = null, 0 === s && a( '"+"' ) ), null === e && ( 36 === n.charCodeAt( o ) ? ( e = "$", o++ ) : ( e = null, 0 === s && a( '"$"' ) ) ) ) ) ) ) ), e } function xe () { var e, t, r, i, u, l, c; if ( l = o, 63 === n.charCodeAt( o ) ? ( e = "?", o++ ) : ( e = null, 0 === s && a( '"?"' ) ), null !== e ) if ( null !== ( t = Ne() ) ) { for ( r = [], c = o, 38 === n.charCodeAt( o ) ? ( i = "&", o++ ) : ( i = null, 0 === s && a( '"&"' ) ), null !== i && null !== ( u = Ne() ) ? i = [i, u] : ( i = null, o = c ); null !== i; )r.push( i ), c = o, 38 === n.charCodeAt( o ) ? ( i = "&", o++ ) : ( i = null, 0 === s && a( '"&"' ) ), null !== i && null !== ( u = Ne() ) ? i = [i, u] : ( i = null, o = c ); null !== r ? e = [e, t, r] : ( e = null, o = l ) } else e = null, o = l; else e = null, o = l; return e } function Ne () { var e, t, r, i, u, l, c; return i = o, u = o, null !== ( e = Pe() ) ? ( 61 === n.charCodeAt( o ) ? ( t = "=", o++ ) : ( t = null, 0 === s && a( '"="' ) ), null !== t && null !== ( r = Ue() ) ? e = [e, t, r] : ( e = null, o = u ) ) : ( e = null, o = u ), null !== e && ( l = e[0], c = e[2], l = l.join( "" ).toLowerCase(), c = c.join( "" ), Fn.uri_headers || ( Fn.uri_headers = {} ), e = void ( Fn.uri_headers[l] ? Fn.uri_headers[l].push( c ) : Fn.uri_headers[l] = [c] ) ), null === e && ( o = i ), e } function Pe () { var e, t; if ( null === ( t = De() ) && null === ( t = C() ) && ( t = E() ), null !== t ) for ( e = []; null !== t; )e.push( t ), null === ( t = De() ) && null === ( t = C() ) && ( t = E() ); else e = null; return e } function Ue () { var e, t; for ( e = [], null === ( t = De() ) && null === ( t = C() ) && ( t = E() ); null !== t; )e.push( t ), null === ( t = De() ) && null === ( t = C() ) && ( t = E() ); return e } function De () { var e; return 91 === n.charCodeAt( o ) ? ( e = "[", o++ ) : ( e = null, 0 === s && a( '"["' ) ), null === e && ( 93 === n.charCodeAt( o ) ? ( e = "]", o++ ) : ( e = null, 0 === s && a( '"]"' ) ), null === e && ( 47 === n.charCodeAt( o ) ? ( e = "/", o++ ) : ( e = null, 0 === s && a( '"/"' ) ), null === e && ( 63 === n.charCodeAt( o ) ? ( e = "?", o++ ) : ( e = null, 0 === s && a( '"?"' ) ), null === e && ( 58 === n.charCodeAt( o ) ? ( e = ":", o++ ) : ( e = null, 0 === s && a( '":"' ) ), null === e && ( 43 === n.charCodeAt( o ) ? ( e = "+", o++ ) : ( e = null, 0 === s && a( '"+"' ) ), null === e && ( 36 === n.charCodeAt( o ) ? ( e = "$", o++ ) : ( e = null, 0 === s && a( '"$"' ) ) ) ) ) ) ) ), e } function Le () { var e, t, n, r, i, s; return s = o, null !== ( e = ct() ) && null !== ( t = m() ) && null !== ( n = Me() ) && null !== ( r = m() ) && null !== ( i = et() ) ? e = [e, t, n, r, i] : ( e = null, o = s ), e } function Me () { var e; return null === ( e = Q() ) && ( e = qe() ), e } function qe () { var e, t, r, i; return i = o, null !== ( e = $e() ) ? ( 58 === n.charCodeAt( o ) ? ( t = ":", o++ ) : ( t = null, 0 === s && a( '":"' ) ), null !== t ? ( null === ( r = He() ) && ( r = Ge() ), null !== r ? e = [e, t, r] : ( e = null, o = i ) ) : ( e = null, o = i ) ) : ( e = null, o = i ), e } function He () { var e, t, r, i, u; return i = o, null === ( e = Fe() ) && ( e = je() ), null !== e ? ( u = o, 63 === n.charCodeAt( o ) ? ( t = "?", o++ ) : ( t = null, 0 === s && a( '"?"' ) ), null !== t && null !== ( r = Ze() ) ? t = [t, r] : ( t = null, o = u ), null !== ( t = null !== t ? t : "" ) ? e = [e, t] : ( e = null, o = i ) ) : ( e = null, o = i ), e } function Fe () { var e, t, r, i; return i = o, "//" === n.substr( o, 2 ) ? ( e = "//", o += 2 ) : ( e = null, 0 === s && a( '"//"' ) ), null !== e && null !== ( t = Je() ) && null !== ( r = null !== ( r = je() ) ? r : "" ) ? e = [e, t, r] : ( e = null, o = i ), e } function je () { var e, t, r; return r = o, 47 === n.charCodeAt( o ) ? ( e = "/", o++ ) : ( e = null, 0 === s && a( '"/"' ) ), null !== e && null !== ( t = Ye() ) ? e = [e, t] : ( e = null, o = r ), e } function Ge () { var e, t, n, r; if ( r = o, null !== ( e = Be() ) ) { for ( t = [], n = We(); null !== n; )t.push( n ), n = We(); null !== t ? e = [e, t] : ( e = null, o = r ) } else e = null, o = r; return e } function We () { var e; return null === ( e = T() ) && null === ( e = C() ) && ( e = E() ), e } function Be () { var e; return null === ( e = C() ) && null === ( e = E() ) && ( 59 === n.charCodeAt( o ) ? ( e = ";", o++ ) : ( e = null, 0 === s && a( '";"' ) ), null === e && ( 63 === n.charCodeAt( o ) ? ( e = "?", o++ ) : ( e = null, 0 === s && a( '"?"' ) ), null === e && ( 58 === n.charCodeAt( o ) ? ( e = ":", o++ ) : ( e = null, 0 === s && a( '":"' ) ), null === e && ( 64 === n.charCodeAt( o ) ? ( e = "@", o++ ) : ( e = null, 0 === s && a( '"@"' ) ), null === e && ( 38 === n.charCodeAt( o ) ? ( e = "&", o++ ) : ( e = null, 0 === s && a( '"&"' ) ), null === e && ( 61 === n.charCodeAt( o ) ? ( e = "=", o++ ) : ( e = null, 0 === s && a( '"="' ) ), null === e && ( 43 === n.charCodeAt( o ) ? ( e = "+", o++ ) : ( e = null, 0 === s && a( '"+"' ) ), null === e && ( 36 === n.charCodeAt( o ) ? ( e = "$", o++ ) : ( e = null, 0 === s && a( '"$"' ) ), null === e && ( 44 === n.charCodeAt( o ) ? ( e = ",", o++ ) : ( e = null, 0 === s && a( '","' ) ) ) ) ) ) ) ) ) ) ), e } function Ye () { var e, t, r, i, u, l; if ( u = o, null !== ( e = ze() ) ) { for ( t = [], l = o, 47 === n.charCodeAt( o ) ? ( r = "/", o++ ) : ( r = null, 0 === s && a( '"/"' ) ), null !== r && null !== ( i = ze() ) ? r = [r, i] : ( r = null, o = l ); null !== r; )t.push( r ), l = o, 47 === n.charCodeAt( o ) ? ( r = "/", o++ ) : ( r = null, 0 === s && a( '"/"' ) ), null !== r && null !== ( i = ze() ) ? r = [r, i] : ( r = null, o = l ); null !== t ? e = [e, t] : ( e = null, o = u ) } else e = null, o = u; return e } function ze () { var e, t, r, i, u, l; for ( u = o, e = [], t = Ke(); null !== t; )e.push( t ), t = Ke(); if ( null !== e ) { for ( t = [], l = o, 59 === n.charCodeAt( o ) ? ( r = ";", o++ ) : ( r = null, 0 === s && a( '";"' ) ), null !== r && null !== ( i = Ve() ) ? r = [r, i] : ( r = null, o = l ); null !== r; )t.push( r ), l = o, 59 === n.charCodeAt( o ) ? ( r = ";", o++ ) : ( r = null, 0 === s && a( '";"' ) ), null !== r && null !== ( i = Ve() ) ? r = [r, i] : ( r = null, o = l ); null !== t ? e = [e, t] : ( e = null, o = u ) } else e = null, o = u; return e } function Ve () { var e, t; for ( e = [], t = Ke(); null !== t; )e.push( t ), t = Ke(); return e } function Ke () { var e; return null === ( e = C() ) && null === ( e = E() ) && ( 58 === n.charCodeAt( o ) ? ( e = ":", o++ ) : ( e = null, 0 === s && a( '":"' ) ), null === e && ( 64 === n.charCodeAt( o ) ? ( e = "@", o++ ) : ( e = null, 0 === s && a( '"@"' ) ), null === e && ( 38 === n.charCodeAt( o ) ? ( e = "&", o++ ) : ( e = null, 0 === s && a( '"&"' ) ), null === e && ( 61 === n.charCodeAt( o ) ? ( e = "=", o++ ) : ( e = null, 0 === s && a( '"="' ) ), null === e && ( 43 === n.charCodeAt( o ) ? ( e = "+", o++ ) : ( e = null, 0 === s && a( '"+"' ) ), null === e && ( 36 === n.charCodeAt( o ) ? ( e = "$", o++ ) : ( e = null, 0 === s && a( '"$"' ) ), null === e && ( 44 === n.charCodeAt( o ) ? ( e = ",", o++ ) : ( e = null, 0 === s && a( '","' ) ) ) ) ) ) ) ) ), e } function $e () { var e, t, r, i, u, l; if ( i = o, u = o, null !== ( e = h() ) ) { for ( t = [], null === ( r = h() ) && null === ( r = f() ) && ( 43 === n.charCodeAt( o ) ? ( r = "+", o++ ) : ( r = null, 0 === s && a( '"+"' ) ), null === r && ( 45 === n.charCodeAt( o ) ? ( r = "-", o++ ) : ( r = null, 0 === s && a( '"-"' ) ), null === r && ( 46 === n.charCodeAt( o ) ? ( r = ".", o++ ) : ( r = null, 0 === s && a( '"."' ) ) ) ) ); null !== r; )t.push( r ), null === ( r = h() ) && null === ( r = f() ) && ( 43 === n.charCodeAt( o ) ? ( r = "+", o++ ) : ( r = null, 0 === s && a( '"+"' ) ), null === r && ( 45 === n.charCodeAt( o ) ? ( r = "-", o++ ) : ( r = null, 0 === s && a( '"-"' ) ), null === r && ( 46 === n.charCodeAt( o ) ? ( r = ".", o++ ) : ( r = null, 0 === s && a( '"."' ) ) ) ) ); null !== t ? e = [e, t] : ( e = null, o = u ) } else e = null, o = u; return null !== e && ( l = i, e = void ( Fn.scheme = n.substring( o, l ) ) ), null === e && ( o = i ), e } function Je () { var e; return null === ( e = Xe() ) && ( e = Qe() ), e } function Xe () { var e, t, r, i; return r = o, i = o, null !== ( e = ne() ) ? ( 64 === n.charCodeAt( o ) ? ( t = "@", o++ ) : ( t = null, 0 === s && a( '"@"' ) ), null !== t ? e = [e, t] : ( e = null, o = i ) ) : ( e = null, o = i ), null !== ( e = null !== e ? e : "" ) && null !== ( t = se() ) ? e = [e, t] : ( e = null, o = r ), null !== e ? e : "" } function Qe () { var e, t; if ( null === ( t = C() ) && null === ( t = E() ) && ( 36 === n.charCodeAt( o ) ? ( t = "$", o++ ) : ( t = null, 0 === s && a( '"$"' ) ), null === t && ( 44 === n.charCodeAt( o ) ? ( t = ",", o++ ) : ( t = null, 0 === s && a( '","' ) ), null === t && ( 59 === n.charCodeAt( o ) ? ( t = ";", o++ ) : ( t = null, 0 === s && a( '";"' ) ), null === t && ( 58 === n.charCodeAt( o ) ? ( t = ":", o++ ) : ( t = null, 0 === s && a( '":"' ) ), null === t && ( 64 === n.charCodeAt( o ) ? ( t = "@", o++ ) : ( t = null, 0 === s && a( '"@"' ) ), null === t && ( 38 === n.charCodeAt( o ) ? ( t = "&", o++ ) : ( t = null, 0 === s && a( '"&"' ) ), null === t && ( 61 === n.charCodeAt( o ) ? ( t = "=", o++ ) : ( t = null, 0 === s && a( '"="' ) ), null === t && ( 43 === n.charCodeAt( o ) ? ( t = "+", o++ ) : ( t = null, 0 === s && a( '"+"' ) ) ) ) ) ) ) ) ) ), null !== t ) for ( e = []; null !== t; )e.push( t ), null === ( t = C() ) && null === ( t = E() ) && ( 36 === n.charCodeAt( o ) ? ( t = "$", o++ ) : ( t = null, 0 === s && a( '"$"' ) ), null === t && ( 44 === n.charCodeAt( o ) ? ( t = ",", o++ ) : ( t = null, 0 === s && a( '","' ) ), null === t && ( 59 === n.charCodeAt( o ) ? ( t = ";", o++ ) : ( t = null, 0 === s && a( '";"' ) ), null === t && ( 58 === n.charCodeAt( o ) ? ( t = ":", o++ ) : ( t = null, 0 === s && a( '":"' ) ), null === t && ( 64 === n.charCodeAt( o ) ? ( t = "@", o++ ) : ( t = null, 0 === s && a( '"@"' ) ), null === t && ( 38 === n.charCodeAt( o ) ? ( t = "&", o++ ) : ( t = null, 0 === s && a( '"&"' ) ), null === t && ( 61 === n.charCodeAt( o ) ? ( t = "=", o++ ) : ( t = null, 0 === s && a( '"="' ) ), null === t && ( 43 === n.charCodeAt( o ) ? ( t = "+", o++ ) : ( t = null, 0 === s && a( '"+"' ) ) ) ) ) ) ) ) ) ); else e = null; return e } function Ze () { var e, t; for ( e = [], t = We(); null !== t; )e.push( t ), t = We(); return e } function et () { var e, t, r, i, u, l, c, h, d; if ( c = o, h = o, "sip" === n.substr( o, 3 ).toLowerCase() ? ( e = n.substr( o, 3 ), o += 3 ) : ( e = null, 0 === s && a( '"SIP"' ) ), null !== e ) if ( 47 === n.charCodeAt( o ) ? ( t = "/", o++ ) : ( t = null, 0 === s && a( '"/"' ) ), null !== t ) { if ( null !== ( i = f() ) ) for ( r = []; null !== i; )r.push( i ), i = f(); else r = null; if ( null !== r ) if ( 46 === n.charCodeAt( o ) ? ( i = ".", o++ ) : ( i = null, 0 === s && a( '"."' ) ), null !== i ) { if ( null !== ( l = f() ) ) for ( u = []; null !== l; )u.push( l ), l = f(); else u = null; null !== u ? e = [e, t, r, i, u] : ( e = null, o = h ) } else e = null, o = h; else e = null, o = h } else e = null, o = h; else e = null, o = h; return null !== e && ( d = c, e = void ( Fn.sip_version = n.substring( o, d ) ) ), null === e && ( o = c ), e } function tt () { var e; return "INVITE" === n.substr( o, 6 ) ? ( e = "INVITE", o += 6 ) : ( e = null, 0 === s && a( '"INVITE"' ) ), e } function nt () { var e; return "ACK" === n.substr( o, 3 ) ? ( e = "ACK", o += 3 ) : ( e = null, 0 === s && a( '"ACK"' ) ), e } function rt () { var e; return "OPTIONS" === n.substr( o, 7 ) ? ( e = "OPTIONS", o += 7 ) : ( e = null, 0 === s && a( '"OPTIONS"' ) ), e } function it () { var e; return "BYE" === n.substr( o, 3 ) ? ( e = "BYE", o += 3 ) : ( e = null, 0 === s && a( '"BYE"' ) ), e } function ot () { var e; return "CANCEL" === n.substr( o, 6 ) ? ( e = "CANCEL", o += 6 ) : ( e = null, 0 === s && a( '"CANCEL"' ) ), e } function st () { var e; return "REGISTER" === n.substr( o, 8 ) ? ( e = "REGISTER", o += 8 ) : ( e = null, 0 === s && a( '"REGISTER"' ) ), e } function ut () { var e; return "SUBSCRIBE" === n.substr( o, 9 ) ? ( e = "SUBSCRIBE", o += 9 ) : ( e = null, 0 === s && a( '"SUBSCRIBE"' ) ), e } function lt () { var e; return "NOTIFY" === n.substr( o, 6 ) ? ( e = "NOTIFY", o += 6 ) : ( e = null, 0 === s && a( '"NOTIFY"' ) ), e } function at () { var e; return "REFER" === n.substr( o, 5 ) ? ( e = "REFER", o += 5 ) : ( e = null, 0 === s && a( '"REFER"' ) ), e } function ct () { var e, t, r; return t = o, null === ( e = tt() ) && null === ( e = nt() ) && null === ( e = rt() ) && null === ( e = it() ) && null === ( e = ot() ) && null === ( e = st() ) && null === ( e = ut() ) && null === ( e = lt() ) && null === ( e = at() ) && ( e = x() ), null !== e && ( r = t, Fn.method = n.substring( o, r ), e = Fn.method ), null === e && ( o = t ), e } function ft () { var e, t, n, r, i, s; return s = o, null !== ( e = et() ) && null !== ( t = m() ) && null !== ( n = ht() ) && null !== ( r = m() ) && null !== ( i = _t() ) ? e = [e, t, n, r, i] : ( e = null, o = s ), e } function ht () { var e, t, n; return t = o, null !== ( e = dt() ) && ( n = e, e = void ( Fn.status_code = parseInt( n.join( "" ) ) ) ), null === e && ( o = t ), e } function dt () { var e, t, n, r; return r = o, null !== ( e = f() ) && null !== ( t = f() ) && null !== ( n = f() ) ? e = [e, t, n] : ( e = null, o = r ), e } function _t () { var e, t, r, i; for ( r = o, e = [], null === ( t = T() ) && null === ( t = C() ) && null === ( t = E() ) && null === ( t = O() ) && null === ( t = k() ) && null === ( t = m() ) && ( t = g() ); null !== t; )e.push( t ), null === ( t = T() ) && null === ( t = C() ) && null === ( t = E() ) && null === ( t = O() ) && null === ( t = k() ) && null === ( t = m() ) && ( t = g() ); return null !== e && ( i = r, e = void ( Fn.reason_phrase = n.substring( o, i ) ) ), null === e && ( o = r ), e } function pt () { var e, t, n, r, i, s, u; if ( i = o, s = o, null === ( e = X() ) && ( e = vt() ), null !== e ) { for ( t = [], u = o, null !== ( n = G() ) && null !== ( r = gt() ) ? n = [n, r] : ( n = null, o = u ); null !== n; )t.push( n ), u = o, null !== ( n = G() ) && null !== ( r = gt() ) ? n = [n, r] : ( n = null, o = u ); null !== t ? e = [e, t] : ( e = null, o = s ) } else e = null, o = s; return null !== e && ( e = function ( e ) { var t; Fn.multi_header || ( Fn.multi_header = [] ); try { t = new Hn( Fn.uri, Fn.display_name, Fn.params ), delete Fn.uri, delete Fn.display_name, delete Fn.params } catch ( e ) { t = null } Fn.multi_header.push( { possition: o, offset: e, parsed: t } ) }( i ) ), null === e && ( o = i ), e } function vt () { var e, t, n, r, i; return i = o, null !== ( e = null !== ( e = mt() ) ? e : "" ) && null !== ( t = F() ) && null !== ( n = Q() ) && null !== ( r = H() ) ? e = [e, t, n, r] : ( e = null, o = i ), e } function mt () { var e, t, n, r, i, s, u, l; if ( i = o, s = o, null !== ( e = x() ) ) { for ( t = [], u = o, null !== ( n = S() ) && null !== ( r = x() ) ? n = [n, r] : ( n = null, o = u ); null !== n; )t.push( n ), u = o, null !== ( n = S() ) && null !== ( r = x() ) ? n = [n, r] : ( n = null, o = u ); null !== t ? e = [e, t] : ( e = null, o = s ) } else e = null, o = s; return null === e && ( e = K() ), null !== e && ( l = e, e = void ( Fn.display_name = "string" == typeof l ? l : l[1].reduce( ( function ( e, t ) { return e + t[0] + t[1] } ), l[0] ) ) ), null === e && ( o = i ), e } function gt () { var e; return null === ( e = yt() ) && null === ( e = Tt() ) && ( e = Et() ), e } function yt () { var e, t, r, i, u, l; return i = o, u = o, "q" === n.substr( o, 1 ).toLowerCase() ? ( e = n.substr( o, 1 ), o++ ) : ( e = null, 0 === s && a( '"q"' ) ), null !== e && null !== ( t = L() ) && null !== ( r = bt() ) ? e = [e, t, r] : ( e = null, o = u ), null !== e && ( l = e[2], Fn.params || ( Fn.params = {} ), e = void ( Fn.params.q = l ) ), null === e && ( o = i ), e } function Tt () { var e, t, r, i, u, l; return i = o, u = o, "expires" === n.substr( o, 7 ).toLowerCase() ? ( e = n.substr( o, 7 ), o += 7 ) : ( e = null, 0 === s && a( '"expires"' ) ), null !== e && null !== ( t = L() ) && null !== ( r = Ct() ) ? e = [e, t, r] : ( e = null, o = u ), null !== e && ( l = e[2], Fn.params || ( Fn.params = {} ), e = void ( Fn.params.expires = l ) ), null === e && ( o = i ), e } function Ct () { var e, t, n; if ( n = o, null !== ( t = f() ) ) for ( e = []; null !== t; )e.push( t ), t = f(); else e = null; return null !== e && ( e = parseInt( e.join( "" ) ) ), null === e && ( o = n ), e } function bt () { var e, t, r, i, u, l, c, h, d; return l = o, c = o, 48 === n.charCodeAt( o ) ? ( e = "0", o++ ) : ( e = null, 0 === s && a( '"0"' ) ), null !== e ? ( h = o, 46 === n.charCodeAt( o ) ? ( t = ".", o++ ) : ( t = null, 0 === s && a( '"."' ) ), null !== t && null !== ( r = null !== ( r = f() ) ? r : "" ) && null !== ( i = null !== ( i = f() ) ? i : "" ) && null !== ( u = null !== ( u = f() ) ? u : "" ) ? t = [t, r, i, u] : ( t = null, o = h ), null !== ( t = null !== t ? t : "" ) ? e = [e, t] : ( e = null, o = c ) ) : ( e = null, o = c ), null !== e && ( d = l, e = parseFloat( n.substring( o, d ) ) ), null === e && ( o = l ), e } function Et () { var e, t, n, r, i, s, u, l; return r = o, i = o, null !== ( e = x() ) ? ( s = o, null !== ( t = L() ) && null !== ( n = St() ) ? t = [t, n] : ( t = null, o = s ), null !== ( t = null !== t ? t : "" ) ? e = [e, t] : ( e = null, o = i ) ) : ( e = null, o = i ), null !== e && ( u = e[0], l = e[1], Fn.params || ( Fn.params = {} ), l = void 0 === l ? void 0 : l[1], e = void ( Fn.params[u.toLowerCase()] = l ) ), null === e && ( o = r ), e } function St () { var e; return null === ( e = x() ) && null === ( e = ue() ) && ( e = V() ), e } function At () { var e; return "render" === n.substr( o, 6 ).toLowerCase() ? ( e = n.substr( o, 6 ), o += 6 ) : ( e = null, 0 === s && a( '"render"' ) ), null === e && ( "session" === n.substr( o, 7 ).toLowerCase() ? ( e = n.substr( o, 7 ), o += 7 ) : ( e = null, 0 === s && a( '"session"' ) ), null === e && ( "icon" === n.substr( o, 4 ).toLowerCase() ? ( e = n.substr( o, 4 ), o += 4 ) : ( e = null, 0 === s && a( '"icon"' ) ), null === e && ( "alert" === n.substr( o, 5 ).toLowerCase() ? ( e = n.substr( o, 5 ), o += 5 ) : ( e = null, 0 === s && a( '"alert"' ) ), null === e && ( e = x() ) ) ) ), e } function wt () { var e; return null === ( e = Rt() ) && ( e = Et() ), e } function Rt () { var e, t, r, i; return i = o, "handling" === n.substr( o, 8 ).toLowerCase() ? ( e = n.substr( o, 8 ), o += 8 ) : ( e = null, 0 === s && a( '"handling"' ) ), null !== e && null !== ( t = L() ) ? ( "optional" === n.substr( o, 8 ).toLowerCase() ? ( r = n.substr( o, 8 ), o += 8 ) : ( r = null, 0 === s && a( '"optional"' ) ), null === r && ( "required" === n.substr( o, 8 ).toLowerCase() ? ( r = n.substr( o, 8 ), o += 8 ) : ( r = null, 0 === s && a( '"required"' ) ), null === r && ( r = x() ) ), null !== r ? e = [e, t, r] : ( e = null, o = i ) ) : ( e = null, o = i ), e } function It () { var e, t, n, r, i, s, u, l; if ( u = o, null !== ( e = Ot() ) ) if ( null !== ( t = D() ) ) if ( null !== ( n = Ut() ) ) { for ( r = [], l = o, null !== ( i = G() ) && null !== ( s = Dt() ) ? i = [i, s] : ( i = null, o = l ); null !== i; )r.push( i ), l = o, null !== ( i = G() ) && null !== ( s = Dt() ) ? i = [i, s] : ( i = null, o = l ); null !== r ? e = [e, t, n, r] : ( e = null, o = u ) } else e = null, o = u; else e = null, o = u; else e = null, o = u; return e } function Ot () { var e; return null === ( e = kt() ) && ( e = xt() ), e } function kt () { var e; return "text" === n.substr( o, 4 ).toLowerCase() ? ( e = n.substr( o, 4 ), o += 4 ) : ( e = null, 0 === s && a( '"text"' ) ), null === e && ( "image" === n.substr( o, 5 ).toLowerCase() ? ( e = n.substr( o, 5 ), o += 5 ) : ( e = null, 0 === s && a( '"image"' ) ), null === e && ( "audio" === n.substr( o, 5 ).toLowerCase() ? ( e = n.substr( o, 5 ), o += 5 ) : ( e = null, 0 === s && a( '"audio"' ) ), null === e && ( "video" === n.substr( o, 5 ).toLowerCase() ? ( e = n.substr( o, 5 ), o += 5 ) : ( e = null, 0 === s && a( '"video"' ) ), null === e && ( "application" === n.substr( o, 11 ).toLowerCase() ? ( e = n.substr( o, 11 ), o += 11 ) : ( e = null, 0 === s && a( '"application"' ) ), null === e && ( e = Nt() ) ) ) ) ), e } function xt () { var e; return "message" === n.substr( o, 7 ).toLowerCase() ? ( e = n.substr( o, 7 ), o += 7 ) : ( e = null, 0 === s && a( '"message"' ) ), null === e && ( "multipart" === n.substr( o, 9 ).toLowerCase() ? ( e = n.substr( o, 9 ), o += 9 ) : ( e = null, 0 === s && a( '"multipart"' ) ), null === e && ( e = Nt() ) ), e } function Nt () { var e; return null === ( e = x() ) && ( e = Pt() ), e } function Pt () { var e, t, r; return r = o, "x-" === n.substr( o, 2 ).toLowerCase() ? ( e = n.substr( o, 2 ), o += 2 ) : ( e = null, 0 === s && a( '"x-"' ) ), null !== e && null !== ( t = x() ) ? e = [e, t] : ( e = null, o = r ), e } function Ut () { var e; return null === ( e = Nt() ) && ( e = x() ), e } function Dt () { var e, t, n, r; return r = o, null !== ( e = x() ) && null !== ( t = L() ) && null !== ( n = Lt() ) ? e = [e, t, n] : ( e = null, o = r ), e } function Lt () { var e; return null === ( e = x() ) && ( e = V() ), e } function Mt () { var e, t, n, r; if ( n = o, null !== ( t = f() ) ) for ( e = []; null !== t; )e.push( t ), t = f(); else e = null; return null !== e && ( r = e, e = void ( Fn.value = parseInt( r.join( "" ) ) ) ), null === e && ( o = n ), e } function qt () { var e, t, r, i, u, l; if ( u = o, null !== ( e = N() ) ) { for ( t = [], l = o, 46 === n.charCodeAt( o ) ? ( r = ".", o++ ) : ( r = null, 0 === s && a( '"."' ) ), null !== r && null !== ( i = N() ) ? r = [r, i] : ( r = null, o = l ); null !== r; )t.push( r ), l = o, 46 === n.charCodeAt( o ) ? ( r = ".", o++ ) : ( r = null, 0 === s && a( '"."' ) ), null !== r && null !== ( i = N() ) ? r = [r, i] : ( r = null, o = l ); null !== t ? e = [e, t] : ( e = null, o = u ) } else e = null, o = u; return e } function Ht () { var e; return null === ( e = Ft() ) && ( e = Et() ), e } function Ft () { var e, t, r, i, u, l; return i = o, u = o, "tag" === n.substr( o, 3 ).toLowerCase() ? ( e = n.substr( o, 3 ), o += 3 ) : ( e = null, 0 === s && a( '"tag"' ) ), null !== e && null !== ( t = L() ) && null !== ( r = x() ) ? e = [e, t, r] : ( e = null, o = u ), null !== e && ( l = e[2], e = void ( Fn.tag = l ) ), null === e && ( o = i ), e } function jt () { var e, t, r, i, u, l, c, f; if ( c = o, "digest" === n.substr( o, 6 ).toLowerCase() ? ( e = n.substr( o, 6 ), o += 6 ) : ( e = null, 0 === s && a( '"Digest"' ) ), null !== e ) if ( null !== ( t = S() ) ) if ( null !== ( r = Bt() ) ) { for ( i = [], f = o, null !== ( u = j() ) && null !== ( l = Bt() ) ? u = [u, l] : ( u = null, o = f ); null !== u; )i.push( u ), f = o, null !== ( u = j() ) && null !== ( l = Bt() ) ? u = [u, l] : ( u = null, o = f ); null !== i ? e = [e, t, r, i] : ( e = null, o = c ) } else e = null, o = c; else e = null, o = c; else e = null, o = c; return null === e && ( e = Gt() ), e } function Gt () { var e, t, n, r, i, s, u, l; if ( u = o, null !== ( e = x() ) ) if ( null !== ( t = S() ) ) if ( null !== ( n = Wt() ) ) { for ( r = [], l = o, null !== ( i = j() ) && null !== ( s = Wt() ) ? i = [i, s] : ( i = null, o = l ); null !== i; )r.push( i ), l = o, null !== ( i = j() ) && null !== ( s = Wt() ) ? i = [i, s] : ( i = null, o = l ); null !== r ? e = [e, t, n, r] : ( e = null, o = u ) } else e = null, o = u; else e = null, o = u; else e = null, o = u; return e } function Wt () { var e, t, n, r; return r = o, null !== ( e = x() ) && null !== ( t = L() ) ? ( null === ( n = x() ) && ( n = V() ), null !== n ? e = [e, t, n] : ( e = null, o = r ) ) : ( e = null, o = r ), e } function Bt () { var e; return null === ( e = Yt() ) && null === ( e = Vt() ) && null === ( e = $t() ) && null === ( e = Xt() ) && null === ( e = Qt() ) && null === ( e = Zt() ) && null === ( e = en() ) && ( e = Wt() ), e } function Yt () { var e, t, r, i; return i = o, "realm" === n.substr( o, 5 ).toLowerCase() ? ( e = n.substr( o, 5 ), o += 5 ) : ( e = null, 0 === s && a( '"realm"' ) ), null !== e && null !== ( t = L() ) && null !== ( r = zt() ) ? e = [e, t, r] : ( e = null, o = i ), e } function zt () { var e, t, n; return t = o, null !== ( e = K() ) && ( n = e, e = void ( Fn.realm = n ) ), null === e && ( o = t ), e } function Vt () { var e, t, r, i, u, l, c, f, h; if ( f = o, "domain" === n.substr( o, 6 ).toLowerCase() ? ( e = n.substr( o, 6 ), o += 6 ) : ( e = null, 0 === s && a( '"domain"' ) ), null !== e ) if ( null !== ( t = L() ) ) if ( null !== ( r = B() ) ) if ( null !== ( i = Kt() ) ) { if ( u = [], h = o, null !== ( c = m() ) ) for ( l = []; null !== c; )l.push( c ), c = m(); else l = null; for ( null !== l && null !== ( c = Kt() ) ? l = [l, c] : ( l = null, o = h ); null !== l; ) { if ( u.push( l ), h = o, null !== ( c = m() ) ) for ( l = []; null !== c; )l.push( c ), c = m(); else l = null; null !== l && null !== ( c = Kt() ) ? l = [l, c] : ( l = null, o = h ) } null !== u && null !== ( l = Y() ) ? e = [e, t, r, i, u, l] : ( e = null, o = f ) } else e = null, o = f; else e = null, o = f; else e = null, o = f; else e = null, o = f; return e } function Kt () { var e; return null === ( e = qe() ) && ( e = je() ), e } function $t () { var e, t, r, i; return i = o, "nonce" === n.substr( o, 5 ).toLowerCase() ? ( e = n.substr( o, 5 ), o += 5 ) : ( e = null, 0 === s && a( '"nonce"' ) ), null !== e && null !== ( t = L() ) && null !== ( r = Jt() ) ? e = [e, t, r] : ( e = null, o = i ), e } function Jt () { var e, t, n; return t = o, null !== ( e = K() ) && ( n = e, e = void ( Fn.nonce = n ) ), null === e && ( o = t ), e } function Xt () { var e, t, r, i, u, l; return i = o, u = o, "opaque" === n.substr( o, 6 ).toLowerCase() ? ( e = n.substr( o, 6 ), o += 6 ) : ( e = null, 0 === s && a( '"opaque"' ) ), null !== e && null !== ( t = L() ) && null !== ( r = K() ) ? e = [e, t, r] : ( e = null, o = u ), null !== e && ( l = e[2], e = void ( Fn.opaque = l ) ), null === e && ( o = i ), e } function Qt () { var e, t, r, i, u; return i = o, "stale" === n.substr( o, 5 ).toLowerCase() ? ( e = n.substr( o, 5 ), o += 5 ) : ( e = null, 0 === s && a( '"stale"' ) ), null !== e && null !== ( t = L() ) ? ( u = o, "true" === n.substr( o, 4 ).toLowerCase() ? ( r = n.substr( o, 4 ), o += 4 ) : ( r = null, 0 === s && a( '"true"' ) ), null !== r && ( r = void ( Fn.stale = !0 ) ), null === r && ( o = u ), null === r && ( u = o, "false" === n.substr( o, 5 ).toLowerCase() ? ( r = n.substr( o, 5 ), o += 5 ) : ( r = null, 0 === s && a( '"false"' ) ), null !== r && ( r = void ( Fn.stale = !1 ) ), null === r && ( o = u ) ), null !== r ? e = [e, t, r] : ( e = null, o = i ) ) : ( e = null, o = i ), e } function Zt () { var e, t, r, i, u, l; return i = o, u = o, "algorithm" === n.substr( o, 9 ).toLowerCase() ? ( e = n.substr( o, 9 ), o += 9 ) : ( e = null, 0 === s && a( '"algorithm"' ) ), null !== e && null !== ( t = L() ) ? ( "md5" === n.substr( o, 3 ).toLowerCase() ? ( r = n.substr( o, 3 ), o += 3 ) : ( r = null, 0 === s && a( '"MD5"' ) ), null === r && ( "md5-sess" === n.substr( o, 8 ).toLowerCase() ? ( r = n.substr( o, 8 ), o += 8 ) : ( r = null, 0 === s && a( '"MD5-sess"' ) ), null === r && ( r = x() ) ), null !== r ? e = [e, t, r] : ( e = null, o = u ) ) : ( e = null, o = u ), null !== e && ( l = e[2], e = void ( Fn.algorithm = l.toUpperCase() ) ), null === e && ( o = i ), e } function en () { var e, t, r, i, u, l, c, f, h, d; if ( f = o, "qop" === n.substr( o, 3 ).toLowerCase() ? ( e = n.substr( o, 3 ), o += 3 ) : ( e = null, 0 === s && a( '"qop"' ) ), null !== e ) if ( null !== ( t = L() ) ) if ( null !== ( r = B() ) ) { if ( h = o, null !== ( i = tn() ) ) { for ( u = [], d = o, 44 === n.charCodeAt( o ) ? ( l = ",", o++ ) : ( l = null, 0 === s && a( '","' ) ), null !== l && null !== ( c = tn() ) ? l = [l, c] : ( l = null, o = d ); null !== l; )u.push( l ), d = o, 44 === n.charCodeAt( o ) ? ( l = ",", o++ ) : ( l = null, 0 === s && a( '","' ) ), null !== l && null !== ( c = tn() ) ? l = [l, c] : ( l = null, o = d ); null !== u ? i = [i, u] : ( i = null, o = h ) } else i = null, o = h; null !== i && null !== ( u = Y() ) ? e = [e, t, r, i, u] : ( e = null, o = f ) } else e = null, o = f; else e = null, o = f; else e = null, o = f; return e } function tn () { var e, t, r; return t = o, "auth-int" === n.substr( o, 8 ).toLowerCase() ? ( e = n.substr( o, 8 ), o += 8 ) : ( e = null, 0 === s && a( '"auth-int"' ) ), null === e && ( "auth" === n.substr( o, 4 ).toLowerCase() ? ( e = n.substr( o, 4 ), o += 4 ) : ( e = null, 0 === s && a( '"auth"' ) ), null === e && ( e = x() ) ), null !== e && ( r = e, Fn.qop || ( Fn.qop = [] ), e = void Fn.qop.push( r.toLowerCase() ) ), null === e && ( o = t ), e } function nn () { var e, t, n, r, i, s, u; if ( i = o, s = o, null !== ( e = vt() ) ) { for ( t = [], u = o, null !== ( n = G() ) && null !== ( r = Et() ) ? n = [n, r] : ( n = null, o = u ); null !== n; )t.push( n ), u = o, null !== ( n = G() ) && null !== ( r = Et() ) ? n = [n, r] : ( n = null, o = u ); null !== t ? e = [e, t] : ( e = null, o = s ) } else e = null, o = s; return null !== e && ( e = function ( e ) { var t; Fn.multi_header || ( Fn.multi_header = [] ); try { t = new Hn( Fn.uri, Fn.display_name, Fn.params ), delete Fn.uri, delete Fn.display_name, delete Fn.params } catch ( e ) { t = null } Fn.multi_header.push( { possition: o, offset: e, parsed: t } ) }( i ) ), null === e && ( o = i ), e } function rn () { var e; return null === ( e = on() ) && ( e = Et() ), e } function on () { var e, t, r, i, u, l, c; if ( u = o, l = o, "cause" === n.substr( o, 5 ).toLowerCase() ? ( e = n.substr( o, 5 ), o += 5 ) : ( e = null, 0 === s && a( '"cause"' ) ), null !== e ) if ( null !== ( t = L() ) ) { if ( null !== ( i = f() ) ) for ( r = []; null !== i; )r.push( i ), i = f(); else r = null; null !== r ? e = [e, t, r] : ( e = null, o = l ) } else e = null, o = l; else e = null, o = l; return null !== e && ( c = e[2], e = void ( Fn.cause = parseInt( c.join( "" ) ) ) ), null === e && ( o = u ), e } function sn () { var e, t, n, r, i, s; if ( i = o, null !== ( e = vt() ) ) { for ( t = [], s = o, null !== ( n = G() ) && null !== ( r = Et() ) ? n = [n, r] : ( n = null, o = s ); null !== n; )t.push( n ), s = o, null !== ( n = G() ) && null !== ( r = Et() ) ? n = [n, r] : ( n = null, o = s ); null !== t ? e = [e, t] : ( e = null, o = i ) } else e = null, o = i; return e } function un () { var e, t, r; return t = o, "active" === n.substr( o, 6 ).toLowerCase() ? ( e = n.substr( o, 6 ), o += 6 ) : ( e = null, 0 === s && a( '"active"' ) ), null === e && ( "pending" === n.substr( o, 7 ).toLowerCase() ? ( e = n.substr( o, 7 ), o += 7 ) : ( e = null, 0 === s && a( '"pending"' ) ), null === e && ( "terminated" === n.substr( o, 10 ).toLowerCase() ? ( e = n.substr( o, 10 ), o += 10 ) : ( e = null, 0 === s && a( '"terminated"' ) ), null === e && ( e = x() ) ) ), null !== e && ( r = t, e = void ( Fn.state = n.substring( o, r ) ) ), null === e && ( o = t ), e } function ln () { var e, t, r, i, u, l, c, f; return i = o, u = o, "reason" === n.substr( o, 6 ).toLowerCase() ? ( e = n.substr( o, 6 ), o += 6 ) : ( e = null, 0 === s && a( '"reason"' ) ), null !== e && null !== ( t = L() ) && null !== ( r = an() ) ? e = [e, t, r] : ( e = null, o = u ), null !== e && ( e = void ( void 0 !== ( l = e[2] ) && ( Fn.reason = l ) ) ), null === e && ( o = i ), null === e && ( i = o, u = o, "expires" === n.substr( o, 7 ).toLowerCase() ? ( e = n.substr( o, 7 ), o += 7 ) : ( e = null, 0 === s && a( '"expires"' ) ), null !== e && null !== ( t = L() ) && null !== ( r = Ct() ) ? e = [e, t, r] : ( e = null, o = u ), null !== e && ( e = void ( void 0 !== ( f = e[2] ) && ( Fn.expires = f ) ) ), null === e && ( o = i ), null === e && ( i = o, u = o, "retry_after" === n.substr( o, 11 ).toLowerCase() ? ( e = n.substr( o, 11 ), o += 11 ) : ( e = null, 0 === s && a( '"retry_after"' ) ), null !== e && null !== ( t = L() ) && null !== ( r = Ct() ) ? e = [e, t, r] : ( e = null, o = u ), null !== e && ( e = void ( void 0 !== ( c = e[2] ) && ( Fn.retry_after = c ) ) ), null === e && ( o = i ), null === e && ( e = Et() ) ) ), e } function an () { var e; return "deactivated" === n.substr( o, 11 ).toLowerCase() ? ( e = n.substr( o, 11 ), o += 11 ) : ( e = null, 0 === s && a( '"deactivated"' ) ), null === e && ( "probation" === n.substr( o, 9 ).toLowerCase() ? ( e = n.substr( o, 9 ), o += 9 ) : ( e = null, 0 === s && a( '"probation"' ) ), null === e && ( "rejected" === n.substr( o, 8 ).toLowerCase() ? ( e = n.substr( o, 8 ), o += 8 ) : ( e = null, 0 === s && a( '"rejected"' ) ), null === e && ( "timeout" === n.substr( o, 7 ).toLowerCase() ? ( e = n.substr( o, 7 ), o += 7 ) : ( e = null, 0 === s && a( '"timeout"' ) ), null === e && ( "giveup" === n.substr( o, 6 ).toLowerCase() ? ( e = n.substr( o, 6 ), o += 6 ) : ( e = null, 0 === s && a( '"giveup"' ) ), null === e && ( "noresource" === n.substr( o, 10 ).toLowerCase() ? ( e = n.substr( o, 10 ), o += 10 ) : ( e = null, 0 === s && a( '"noresource"' ) ), null === e && ( "invariant" === n.substr( o, 9 ).toLowerCase() ? ( e = n.substr( o, 9 ), o += 9 ) : ( e = null, 0 === s && a( '"invariant"' ) ), null === e && ( e = x() ) ) ) ) ) ) ), e } function cn () { var e; return null === ( e = Ft() ) && ( e = Et() ), e } function fn () { var e, t, n, r, i, s, u, l; if ( u = o, null !== ( e = gn() ) ) if ( null !== ( t = S() ) ) if ( null !== ( n = Cn() ) ) { for ( r = [], l = o, null !== ( i = G() ) && null !== ( s = hn() ) ? i = [i, s] : ( i = null, o = l ); null !== i; )r.push( i ), l = o, null !== ( i = G() ) && null !== ( s = hn() ) ? i = [i, s] : ( i = null, o = l ); null !== r ? e = [e, t, n, r] : ( e = null, o = u ) } else e = null, o = u; else e = null, o = u; else e = null, o = u; return e } function hn () { var e; return null === ( e = dn() ) && null === ( e = _n() ) && null === ( e = pn() ) && null === ( e = vn() ) && null === ( e = mn() ) && ( e = Et() ), e } function dn () { var e, t, r, i, u, l; return i = o, u = o, "ttl" === n.substr( o, 3 ).toLowerCase() ? ( e = n.substr( o, 3 ), o += 3 ) : ( e = null, 0 === s && a( '"ttl"' ) ), null !== e && null !== ( t = L() ) && null !== ( r = Sn() ) ? e = [e, t, r] : ( e = null, o = u ), null !== e && ( l = e[2], e = void ( Fn.ttl = l ) ), null === e && ( o = i ), e } function _n () { var e, t, r, i, u, l; return i = o, u = o, "maddr" === n.substr( o, 5 ).toLowerCase() ? ( e = n.substr( o, 5 ), o += 5 ) : ( e = null, 0 === s && a( '"maddr"' ) ), null !== e && null !== ( t = L() ) && null !== ( r = ue() ) ? e = [e, t, r] : ( e = null, o = u ), null !== e && ( l = e[2], e = void ( Fn.maddr = l ) ), null === e && ( o = i ), e } function pn () { var e, t, r, i, u, l; return i = o, u = o, "received" === n.substr( o, 8 ).toLowerCase() ? ( e = n.substr( o, 8 ), o += 8 ) : ( e = null, 0 === s && a( '"received"' ) ), null !== e && null !== ( t = L() ) ? ( null === ( r = pe() ) && ( r = he() ), null !== r ? e = [e, t, r] : ( e = null, o = u ) ) : ( e = null, o = u ), null !== e && ( l = e[2], e = void ( Fn.received = l ) ), null === e && ( o = i ), e } function vn () { var e, t, r, i, u, l; return i = o, u = o, "branch" === n.substr( o, 6 ).toLowerCase() ? ( e = n.substr( o, 6 ), o += 6 ) : ( e = null, 0 === s && a( '"branch"' ) ), null !== e && null !== ( t = L() ) && null !== ( r = x() ) ? e = [e, t, r] : ( e = null, o = u ), null !== e && ( l = e[2], e = void ( Fn.branch = l ) ), null === e && ( o = i ), e } function mn () { var e, t, r, i, u, l, c; if ( u = o, l = o, "rport" === n.substr( o, 5 ).toLowerCase() ? ( e = n.substr( o, 5 ), o += 5 ) : ( e = null, 0 === s && a( '"rport"' ) ), null !== e ) { if ( c = o, null !== ( t = L() ) ) { for ( r = [], i = f(); null !== i; )r.push( i ), i = f(); null !== r ? t = [t, r] : ( t = null, o = c ) } else t = null, o = c; null !== ( t = null !== t ? t : "" ) ? e = [e, t] : ( e = null, o = l ) } else e = null, o = l; return null !== e && ( e = void ( "undefined" != typeof response_port && ( Fn.rport = response_port.join( "" ) ) ) ), null === e && ( o = u ), e } function gn () { var e, t, n, r, i, s; return s = o, null !== ( e = yn() ) && null !== ( t = D() ) && null !== ( n = x() ) && null !== ( r = D() ) && null !== ( i = Tn() ) ? e = [e, t, n, r, i] : ( e = null, o = s ), e } function yn () { var e, t, r; return t = o, "sip" === n.substr( o, 3 ).toLowerCase() ? ( e = n.substr( o, 3 ), o += 3 ) : ( e = null, 0 === s && a( '"SIP"' ) ), null === e && ( e = x() ), null !== e && ( r = e, e = void ( Fn.protocol = r ) ), null === e && ( o = t ), e } function Tn () { var e, t, r; return t = o, "udp" === n.substr( o, 3 ).toLowerCase() ? ( e = n.substr( o, 3 ), o += 3 ) : ( e = null, 0 === s && a( '"UDP"' ) ), null === e && ( "tcp" === n.substr( o, 3 ).toLowerCase() ? ( e = n.substr( o, 3 ), o += 3 ) : ( e = null, 0 === s && a( '"TCP"' ) ), null === e && ( "tls" === n.substr( o, 3 ).toLowerCase() ? ( e = n.substr( o, 3 ), o += 3 ) : ( e = null, 0 === s && a( '"TLS"' ) ), null === e && ( "sctp" === n.substr( o, 4 ).toLowerCase() ? ( e = n.substr( o, 4 ), o += 4 ) : ( e = null, 0 === s && a( '"SCTP"' ) ), null === e && ( e = x() ) ) ) ), null !== e && ( r = e, e = void ( Fn.transport = r ) ), null === e && ( o = t ), e } function Cn () { var e, t, n, r, i; return r = o, null !== ( e = bn() ) ? ( i = o, null !== ( t = W() ) && null !== ( n = En() ) ? t = [t, n] : ( t = null, o = i ), null !== ( t = null !== t ? t : "" ) ? e = [e, t] : ( e = null, o = r ) ) : ( e = null, o = r ), e } function bn () { var e, t, r; return t = o, null === ( e = pe() ) && null === ( e = fe() ) && ( e = le() ), null !== e && ( r = t, e = void ( Fn.host = n.substring( o, r ) ) ), null === e && ( o = t ), e } function En () { var e, t, n, r, i, s, u, l; return s = o, u = o, null !== ( e = null !== ( e = f() ) ? e : "" ) && null !== ( t = null !== ( t = f() ) ? t : "" ) && null !== ( n = null !== ( n = f() ) ? n : "" ) && null !== ( r = null !== ( r = f() ) ? r : "" ) && null !== ( i = null !== ( i = f() ) ? i : "" ) ? e = [e, t, n, r, i] : ( e = null, o = u ), null !== e && ( l = e, e = void ( Fn.port = parseInt( l.join( "" ) ) ) ), null === e && ( o = s ), e } function Sn () { var e, t, n, r, i; return r = o, i = o, null !== ( e = f() ) && null !== ( t = null !== ( t = f() ) ? t : "" ) && null !== ( n = null !== ( n = f() ) ? n : "" ) ? e = [e, t, n] : ( e = null, o = i ), null !== e && ( e = parseInt( e.join( "" ) ) ), null === e && ( o = r ), e } function An () { var e, t, n; return t = o, null !== ( e = Ct() ) && ( n = e, e = void ( Fn.expires = n ) ), null === e && ( o = t ), e } function wn () { var e; return null === ( e = Rn() ) && ( e = Et() ), e } function Rn () { var e, t, r, i, u, l; return i = o, u = o, "refresher" === n.substr( o, 9 ).toLowerCase() ? ( e = n.substr( o, 9 ), o += 9 ) : ( e = null, 0 === s && a( '"refresher"' ) ), null !== e && null !== ( t = L() ) ? ( "uac" === n.substr( o, 3 ).toLowerCase() ? ( r = n.substr( o, 3 ), o += 3 ) : ( r = null, 0 === s && a( '"uac"' ) ), null === r && ( "uas" === n.substr( o, 3 ).toLowerCase() ? ( r = n.substr( o, 3 ), o += 3 ) : ( r = null, 0 === s && a( '"uas"' ) ) ), null !== r ? e = [e, t, r] : ( e = null, o = u ) ) : ( e = null, o = u ), null !== e && ( l = e[2], e = void ( Fn.refresher = l.toLowerCase() ) ), null === e && ( o = i ), e } function In () { var e, t; for ( e = [], null === ( t = I() ) && null === ( t = k() ) && ( t = S() ); null !== t; )e.push( t ), null === ( t = I() ) && null === ( t = k() ) && ( t = S() ); return e } function On () { var e, t, r, i, u, l, c, f, h, d, _, p; return d = o, _ = o, null !== ( e = xn() ) ? ( 45 === n.charCodeAt( o ) ? ( t = "-", o++ ) : ( t = null, 0 === s && a( '"-"' ) ), null !== t && null !== ( r = kn() ) ? ( 45 === n.charCodeAt( o ) ? ( i = "-", o++ ) : ( i = null, 0 === s && a( '"-"' ) ), null !== i && null !== ( u = kn() ) ? ( 45 === n.charCodeAt( o ) ? ( l = "-", o++ ) : ( l = null, 0 === s && a( '"-"' ) ), null !== l && null !== ( c = kn() ) ? ( 45 === n.charCodeAt( o ) ? ( f = "-", o++ ) : ( f = null, 0 === s && a( '"-"' ) ), null !== f && null !== ( h = Nn() ) ? e = [e, t, r, i, u, l, c, f, h] : ( e = null, o = _ ) ) : ( e = null, o = _ ) ) : ( e = null, o = _ ) ) : ( e = null, o = _ ) ) : ( e = null, o = _ ), null !== e && ( p = d, e[0], e = void ( Fn = n.substring( o + 5, p ) ) ), null === e && ( o = d ), e } function kn () { var e, t, n, r, i; return i = o, null !== ( e = d() ) && null !== ( t = d() ) && null !== ( n = d() ) && null !== ( r = d() ) ? e = [e, t, n, r] : ( e = null, o = i ), e } function xn () { var e, t, n; return n = o, null !== ( e = kn() ) && null !== ( t = kn() ) ? e = [e, t] : ( e = null, o = n ), e } function Nn () { var e, t, n, r; return r = o, null !== ( e = kn() ) && null !== ( t = kn() ) && null !== ( n = kn() ) ? e = [e, t, n] : ( e = null, o = r ), e } function Pn () { var e, t, r, i, u, l, c; return i = o, u = o, null !== ( e = P() ) ? ( l = o, 64 === n.charCodeAt( o ) ? ( t = "@", o++ ) : ( t = null, 0 === s && a( '"@"' ) ), null !== t && null !== ( r = P() ) ? t = [t, r] : ( t = null, o = l ), null !== ( t = null !== t ? t : "" ) ? e = [e, t] : ( e = null, o = u ) ) : ( e = null, o = u ), null !== e && ( c = i, e = void ( Fn.call_id = n.substring( o, c ) ) ), null === e && ( o = i ), e } function Un () { var e; return null === ( e = Dn() ) && null === ( e = Ln() ) && null === ( e = Mn() ) && ( e = Et() ), e } function Dn () { var e, t, r, i, u, l; return i = o, u = o, "to-tag" === n.substr( o, 6 ) ? ( e = "to-tag", o += 6 ) : ( e = null, 0 === s && a( '"to-tag"' ) ), null !== e && null !== ( t = L() ) && null !== ( r = x() ) ? e = [e, t, r] : ( e = null, o = u ), null !== e && ( l = e[2], e = void ( Fn.to_tag = l ) ), null === e && ( o = i ), e } function Ln () { var e, t, r, i, u, l; return i = o, u = o, "from-tag" === n.substr( o, 8 ) ? ( e = "from-tag", o += 8 ) : ( e = null, 0 === s && a( '"from-tag"' ) ), null !== e && null !== ( t = L() ) && null !== ( r = x() ) ? e = [e, t, r] : ( e = null, o = u ), null !== e && ( l = e[2], e = void ( Fn.from_tag = l ) ), null === e && ( o = i ), e } function Mn () { var e, t; return t = o, "early-only" === n.substr( o, 10 ) ? ( e = "early-only", o += 10 ) : ( e = null, 0 === s && a( '"early-only"' ) ), null !== e && ( e = void ( Fn.early_only = !0 ) ), null === e && ( o = t ), e } var qn = e( "./URI" ), Hn = e( "./NameAddrHeader" ), Fn = {}; if ( null === i[r]() || o !== n.length ) { var jn = Math.max( o, u ), Gn = jn < n.length ? n.charAt( jn ) : null, Wn = function () { for ( var e = 1, t = 1, r = !1, i = 0; i < Math.max( o, u ); i++ ) { var s = n.charAt( i ); "\n" === s ? ( r || e++, t = 1, r = !1 ) : "\r" === s || "\u2028" === s || "\u2029" === s ? ( e++, t = 1, r = !0 ) : ( t++, r = !1 ) } return { line: e, column: t } }(); return new this.SyntaxError( function ( e ) { e.sort(); for ( var t = null, n = [], r = 0; r < e.length; r++ )e[r] !== t && ( n.push( e[r] ), t = e[r] ); return n }( l ), Gn, jn, Wn.line, Wn.column ), -1 } return Fn }, toSource: function () { return this._source }, SyntaxError: function ( e, n, r, i, o ) { this.name = "SyntaxError", this.expected = e, this.found = n, this.message = function ( e, n ) { var r; switch ( e.length ) { case 0: r = "end of input"; break; case 1: r = e[0]; break; default: r = e.slice( 0, e.length - 1 ).join( ", " ) + " or " + e[e.length - 1] }return "Expected " + r + " but " + ( n ? t( n ) : "end of input" ) + " found." }( e, n ), this.offset = r, this.line = i, this.column = o } }; return n.SyntaxError.prototype = Error.prototype, n }() }, { "./NameAddrHeader": 10, "./URI": 25 }], 8: [function ( e, t, n ) { "use strict"; var r = e( "../package.json" ), i = e( "./Constants" ), o = e( "./Exceptions" ), s = e( "./Utils" ), u = e( "./UA" ), l = e( "./URI" ), a = e( "./NameAddrHeader" ), c = e( "./Grammar" ), f = e( "./WebSocketInterface" ); e( "debug" )( "PIOPIY" )( "version %s", r.version ), t.exports = { C: i, Exceptions: o, Utils: s, UA: u, URI: l, NameAddrHeader: a, WebSocketInterface: f, Grammar: c, debug: e( "debug" ), get name () { return r.title }, get version () { return r.version } } }, { "../package.json": 38, "./Constants": 2, "./Exceptions": 6, "./Grammar": 7, "./NameAddrHeader": 10, "./UA": 24, "./URI": 25, "./Utils": 26, "./WebSocketInterface": 27, debug: 30 }], 9: [function ( e, t, n ) { "use strict"; function r ( e ) { return ( r = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function ( e ) { return typeof e } : function ( e ) { return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e } )( e ) } function i ( e, t ) { for ( var n = 0; n < t.length; n++ ) { var r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && ( r.writable = !0 ), Object.defineProperty( e, r.key, r ) } } function o ( e, t ) { return !t || "object" !== r( t ) && "function" != typeof t ? function ( e ) { if ( void 0 === e ) throw new ReferenceError( "this hasn't been initialised - super() hasn't been called" ); return e }( e ) : t } function s ( e ) { return ( s = Object.setPrototypeOf ? Object.getPrototypeOf : function ( e ) { return e.__proto__ || Object.getPrototypeOf( e ) } )( e ) } function u ( e, t ) { return ( u = Object.setPrototypeOf || function ( e, t ) { return e.__proto__ = t, e } )( e, t ) } var l = e( "events" ).EventEmitter, a = e( "./Constants" ), c = e( "./SIPMessage" ), f = e( "./Utils" ), h = e( "./RequestSender" ), d = e( "./Exceptions" ), _ = e( "debug" )( "PIOPIY:Message" ); t.exports = function ( e ) { function t ( e ) { var n; return function ( e, t ) { if ( !( e instanceof t ) ) throw new TypeError( "Cannot call a class as a function" ) }( this, t ), ( n = o( this, s( t ).call( this ) ) )._ua = e, n._request = null, n._closed = !1, n._direction = null, n._local_identity = null, n._remote_identity = null, n._is_replied = !1, n._data = {}, n } var n, r; return function ( e, t ) { if ( "function" != typeof t && null !== t ) throw new TypeError( "Super expression must either be null or a function" ); e.prototype = Object.create( t && t.prototype, { constructor: { value: e, writable: !0, configurable: !0 } } ), t && u( e, t ) }( t, l ), n = t, ( r = [{ key: "send", value: function ( e, t ) { var n = this, r = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {}, i = e; if ( void 0 === e || void 0 === t ) throw new TypeError( "Not enough arguments" ); if ( !( e = this._ua.normalizeTarget( e ) ) ) throw new TypeError( "Invalid target: ".concat( i ) ); var o = f.cloneArray( r.extraHeaders ), s = r.eventHandlers || {}, u = r.contentType || "text/plain"; for ( var l in s ) Object.prototype.hasOwnProperty.call( s, l ) && this.on( l, s[l] ); o.push( "Content-Type: ".concat( u ) ), this._request = new c.OutgoingRequest( a.MESSAGE, e, this._ua, null, o ), t && ( this._request.body = t ); var d = new h( this._ua, this._request, { onRequestTimeout: function () { n._onRequestTimeout() }, onTransportError: function () { n._onTransportError() }, onReceiveResponse: function ( e ) { n._receiveResponse( e ) } } ); this._newMessage( "local", this._request ), d.send() } }, { key: "init_incoming", value: function ( e ) { this._request = e, this._newMessage( "remote", e ), this._is_replied || ( this._is_replied = !0, e.reply( 200 ) ), this._close() } }, { key: "accept", value: function () { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, t = f.cloneArray( e.extraHeaders ), n = e.body; if ( "incoming" !== this._direction ) throw new d.NotSupportedError( '"accept" not supported for outgoing Message' ); if ( this._is_replied ) throw new Error( "incoming Message already replied" ); this._is_replied = !0, this._request.reply( 200, null, t, n ) } }, { key: "reject", value: function () { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, t = e.status_code || 480, n = e.reason_phrase, r = f.cloneArray( e.extraHeaders ), i = e.body; if ( "incoming" !== this._direction ) throw new d.NotSupportedError( '"reject" not supported for outgoing Message' ); if ( this._is_replied ) throw new Error( "incoming Message already replied" ); if ( t < 300 || t >= 700 ) throw new TypeError( "Invalid status_code: ".concat( t ) ); this._is_replied = !0, this._request.reply( t, n, r, i ) } }, { key: "_receiveResponse", value: function ( e ) { if ( !this._closed ) switch ( !0 ) { case /^1[0-9]{2}$/.test( e.status_code ): break; case /^2[0-9]{2}$/.test( e.status_code ): this._succeeded( "remote", e ); break; default: var t = f.sipErrorCause( e.status_code ); this._failed( "remote", e, t ) } } }, { key: "_onRequestTimeout", value: function () { this._closed || this._failed( "system", null, a.causes.REQUEST_TIMEOUT ) } }, { key: "_onTransportError", value: function () { this._closed || this._failed( "system", null, a.causes.CONNECTION_ERROR ) } }, { key: "_close", value: function () { this._closed = !0, this._ua.destroyMessage( this ) } }, { key: "_newMessage", value: function ( e, t ) { "remote" === e ? ( this._direction = "incoming", this._local_identity = t.to, this._remote_identity = t.from ) : "local" === e && ( this._direction = "outgoing", this._local_identity = t.from, this._remote_identity = t.to ), this._ua.newMessage( this, { originator: e, message: this, request: t } ) } }, { key: "_failed", value: function ( e, t, n ) { _( "MESSAGE failed" ), this._close(), _( 'emit "failed"' ), this.emit( "failed", { originator: e, response: t || null, cause: n } ) } }, { key: "_succeeded", value: function ( e, t ) { _( "MESSAGE succeeded" ), this._close(), _( 'emit "succeeded"' ), this.emit( "succeeded", { originator: e, response: t } ) } }, { key: "direction", get: function () { return this._direction } }, { key: "local_identity", get: function () { return this._local_identity } }, { key: "remote_identity", get: function () { return this._remote_identity } }] ) && i( n.prototype, r ), t }() }, { "./Constants": 2, "./Exceptions": 6, "./RequestSender": 18, "./SIPMessage": 19, "./Utils": 26, debug: 30, events: 29 }], 10: [function ( e, t, n ) { "use strict"; function r ( e, t ) { for ( var n = 0; n < t.length; n++ ) { var r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && ( r.writable = !0 ), Object.defineProperty( e, r.key, r ) } } function i ( e, t, n ) { return t && r( e.prototype, t ), n && r( e, n ), e } var o = e( "./URI" ), s = e( "./Grammar" ); t.exports = function () { function e ( t, n, r ) { if ( function ( e, t ) { if ( !( e instanceof t ) ) throw new TypeError( "Cannot call a class as a function" ) }( this, e ), !( t && t instanceof o ) ) throw new TypeError( 'missing or invalid "uri" parameter' ); for ( var i in this._uri = t, this._parameters = {}, this.display_name = n, r ) Object.prototype.hasOwnProperty.call( r, i ) && this.setParam( i, r[i] ) } return i( e, null, [{ key: "parse", value: function ( e ) { return -1 !== ( e = s.parse( e, "Name_Addr_Header" ) ) ? e : void 0 } }] ), i( e, [{ key: "setParam", value: function ( e, t ) { e && ( this._parameters[e.toLowerCase()] = null == t ? null : t.toString() ) } }, { key: "getParam", value: function ( e ) { if ( e ) return this._parameters[e.toLowerCase()] } }, { key: "hasParam", value: function ( e ) { if ( e ) return !!this._parameters.hasOwnProperty( e.toLowerCase() ) } }, { key: "deleteParam", value: function ( e ) { if ( e = e.toLowerCase(), this._parameters.hasOwnProperty( e ) ) { var t = this._parameters[e]; return delete this._parameters[e], t } } }, { key: "clearParams", value: function () { this._parameters = {} } }, { key: "clone", value: function () { return new e( this._uri.clone(), this._display_name, JSON.parse( JSON.stringify( this._parameters ) ) ) } }, { key: "_quote", value: function ( e ) { return e.replace( /\\/g, "\\\\" ).replace( /"/g, '\\"' ) } }, { key: "toString", value: function () { var e = this._display_name ? '"'.concat( this._quote( this._display_name ), '" ' ) : ""; for ( var t in e += "<".concat( this._uri.toString(), ">" ), this._parameters ) Object.prototype.hasOwnProperty.call( this._parameters, t ) && ( e += ";".concat( t ), null !== this._parameters[t] && ( e += "=".concat( this._parameters[t] ) ) ); return e } }, { key: "uri", get: function () { return this._uri } }, { key: "display_name", get: function () { return this._display_name }, set: function ( e ) { this._display_name = 0 === e ? "0" : e } }] ), e }() }, { "./Grammar": 7, "./URI": 25 }], 11: [function ( e, t, n ) { "use strict"; var r = e( "./Grammar" ), i = e( "./SIPMessage" ), o = e( "debug" )( "PIOPIY:ERROR:Parser" ); function s ( e, t ) { var n = t, r = 0, i = 0; if ( e.substring( n, n + 2 ).match( /(^\r\n)/ ) ) return -2; for ( ; 0 === r; ) { if ( -1 === ( i = e.indexOf( "\r\n", n ) ) ) return i; !e.substring( i + 2, i + 4 ).match( /(^\r\n)/ ) && e.charAt( i + 2 ).match( /(^\s+)/ ) ? n = i + 2 : r = i } return r } function u ( e, t, n, o ) { var s, u = t.indexOf( ":", n ), l = t.substring( n, u ).trim(), a = t.substring( u + 1, o ).trim(); switch ( l.toLowerCase() ) { case "via": case "v": e.addHeader( "via", a ), 1 === e.getHeaders( "via" ).length ? ( s = e.parseHeader( "Via" ) ) && ( e.via = s, e.via_branch = s.branch ) : s = 0; break; case "from": case "f": e.setHeader( "from", a ), ( s = e.parseHeader( "from" ) ) && ( e.from = s, e.from_tag = s.getParam( "tag" ) ); break; case "to": case "t": e.setHeader( "to", a ), ( s = e.parseHeader( "to" ) ) && ( e.to = s, e.to_tag = s.getParam( "tag" ) ); break; case "record-route": if ( -1 === ( s = r.parse( a, "Record_Route" ) ) ) s = void 0; else { var c = !0, f = !1, h = void 0; try { for ( var d, _ = s[Symbol.iterator](); !( c = ( d = _.next() ).done ); c = !0 ) { var p = d.value; e.addHeader( "record-route", a.substring( p.possition, p.offset ) ), e.headers["Record-Route"][e.getHeaders( "record-route" ).length - 1].parsed = p.parsed } } catch ( e ) { f = !0, h = e } finally { try { c || null == _.return || _.return() } finally { if ( f ) throw h } } } break; case "call-id": case "i": e.setHeader( "call-id", a ), ( s = e.parseHeader( "call-id" ) ) && ( e.call_id = a ); break; case "contact": case "m": if ( -1 === ( s = r.parse( a, "Contact" ) ) ) s = void 0; else { var v = !0, m = !1, g = void 0; try { for ( var y, T = s[Symbol.iterator](); !( v = ( y = T.next() ).done ); v = !0 ) { var C = y.value; e.addHeader( "contact", a.substring( C.possition, C.offset ) ), e.headers.Contact[e.getHeaders( "contact" ).length - 1].parsed = C.parsed } } catch ( e ) { m = !0, g = e } finally { try { v || null == T.return || T.return() } finally { if ( m ) throw g } } } break; case "content-length": case "l": e.setHeader( "content-length", a ), s = e.parseHeader( "content-length" ); break; case "content-type": case "c": e.setHeader( "content-type", a ), s = e.parseHeader( "content-type" ); break; case "cseq": e.setHeader( "cseq", a ), ( s = e.parseHeader( "cseq" ) ) && ( e.cseq = s.value ), e instanceof i.IncomingResponse && ( e.method = s.method ); break; case "max-forwards": e.setHeader( "max-forwards", a ), s = e.parseHeader( "max-forwards" ); break; case "www-authenticate": e.setHeader( "www-authenticate", a ), s = e.parseHeader( "www-authenticate" ); break; case "proxy-authenticate": e.setHeader( "proxy-authenticate", a ), s = e.parseHeader( "proxy-authenticate" ); break; case "session-expires": case "x": e.setHeader( "session-expires", a ), ( s = e.parseHeader( "session-expires" ) ) && ( e.session_expires = s.expires, e.session_expires_refresher = s.refresher ); break; case "refer-to": case "r": e.setHeader( "refer-to", a ), ( s = e.parseHeader( "refer-to" ) ) && ( e.refer_to = s ); break; case "replaces": e.setHeader( "replaces", a ), ( s = e.parseHeader( "replaces" ) ) && ( e.replaces = s ); break; case "event": case "o": e.setHeader( "event", a ), ( s = e.parseHeader( "event" ) ) && ( e.event = s ); break; default: e.addHeader( l, a ), s = 0 }return void 0 !== s || { error: 'error parsing header "'.concat( l, '"' ) } } o.log = console.warn.bind( console ), n.parseMessage = function ( e, t ) { var n, l, a = e.indexOf( "\r\n" ); if ( -1 !== a ) { var c = e.substring( 0, a ), f = r.parse( c, "Request_Response" ); if ( -1 !== f ) { f.status_code ? ( ( n = new i.IncomingResponse ).status_code = f.status_code, n.reason_phrase = f.reason_phrase ) : ( ( n = new i.IncomingRequest( t ) ).method = f.method, n.ruri = f.uri ), n.data = e; for ( var h = a + 2; ; ) { if ( -2 === ( a = s( e, h ) ) ) { l = h + 2; break } if ( -1 === a ) return void o( "parseMessage() | malformed message" ); if ( !0 !== ( f = u( n, e, h, a ) ) ) return void o( "parseMessage() |", f.error ); h = a + 2 } if ( n.hasHeader( "content-length" ) ) { var d = n.getHeader( "content-length" ); n.body = e.substr( l, d ) } else n.body = e.substring( l ); return n } o( 'parseMessage() | error parsing first line of SIP message: "'.concat( c, '"' ) ) } else o( "parseMessage() | no CRLF found, not a SIP message" ) } }, { "./Grammar": 7, "./SIPMessage": 19, debug: 30 }], 12: [function ( e, t, n ) { "use strict"; function r ( e ) { return ( r = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function ( e ) { return typeof e } : function ( e ) { return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e } )( e ) } function i ( e ) { return ( i = Object.setPrototypeOf ? Object.getPrototypeOf : function ( e ) { return e.__proto__ || Object.getPrototypeOf( e ) } )( e ) } function o ( e, t ) { for ( var n = 0; n < t.length; n++ ) { var r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && ( r.writable = !0 ), Object.defineProperty( e, r.key, r ) } } function s ( e, t, n ) { return t && o( e.prototype, t ), n && o( e, n ), e } function u ( e, t ) { return ( u = Object.setPrototypeOf || function ( e, t ) { return e.__proto__ = t, e } )( e, t ) } var l = e( "events" ).EventEmitter, a = e( "sdp-transform" ), c = e( "./Constants" ), f = e( "./Exceptions" ), h = e( "./Transactions" ), d = e( "./Utils" ), _ = e( "./Timers" ), p = e( "./SIPMessage" ), v = e( "./Dialog" ), m = e( "./RequestSender" ), g = e( "./RTCSession/DTMF" ), y = e( "./RTCSession/Info" ), T = e( "./RTCSession/ReferNotifier" ), C = e( "./RTCSession/ReferSubscriber" ), b = e( "./URI" ), E = e( "debug" )( "PIOPIY:RTCSession" ), S = e( "debug" )( "PIOPIY:ERROR:RTCSession" ); S.log = console.warn.bind( console ); var A = { STATUS_NULL: 0, STATUS_INVITE_SENT: 1, STATUS_1XX_RECEIVED: 2, STATUS_INVITE_RECEIVED: 3, STATUS_WAITING_FOR_ANSWER: 4, STATUS_ANSWERED: 5, STATUS_WAITING_FOR_ACK: 6, STATUS_CANCELED: 7, STATUS_TERMINATED: 8, STATUS_CONFIRMED: 9 }, w = ["audio", "video"]; t.exports = function ( e ) { function t ( e ) { var n; return function ( e, t ) { if ( !( e instanceof t ) ) throw new TypeError( "Cannot call a class as a function" ) }( this, t ), E( "new" ), ( n = function ( e, t ) { return !t || "object" !== r( t ) && "function" != typeof t ? function ( e ) { if ( void 0 === e ) throw new ReferenceError( "this hasn't been initialised - super() hasn't been called" ); return e }( e ) : t }( this, i( t ).call( this ) ) )._id = null, n._ua = e, n._status = A.STATUS_NULL, n._dialog = null, n._earlyDialogs = {}, n._contact = null, n._from_tag = null, n._to_tag = null, n._connection = null, n._connectionPromiseQueue = Promise.resolve(), n._request = null, n._is_canceled = !1, n._cancel_reason = "", n._is_confirmed = !1, n._late_sdp = !1, n._rtcOfferConstraints = null, n._rtcAnswerConstraints = null, n._localMediaStream = null, n._localMediaStreamLocallyGenerated = !1, n._rtcReady = !0, n._timers = { ackTimer: null, expiresTimer: null, invite2xxTimer: null, userNoAnswerTimer: null }, n._direction = null, n._local_identity = null, n._remote_identity = null, n._start_time = null, n._end_time = null, n._tones = null, n._audioMuted = !1, n._videoMuted = !1, n._localHold = !1, n._remoteHold = !1, n._sessionTimers = { enabled: n._ua.configuration.session_timers, refreshMethod: n._ua.configuration.session_timers_refresh_method, defaultExpires: c.SESSION_EXPIRES, currentExpires: null, running: !1, refresher: !1, timer: null }, n._referSubscribers = {}, n._data = {}, n } return function ( e, t ) { if ( "function" != typeof t && null !== t ) throw new TypeError( "Super expression must either be null or a function" ); e.prototype = Object.create( t && t.prototype, { constructor: { value: e, writable: !0, configurable: !0 } } ), t && u( e, t ) }( t, l ), s( t, null, [{ key: "C", get: function () { return A } }] ), s( t, [{ key: "isInProgress", value: function () { switch ( this._status ) { case A.STATUS_NULL: case A.STATUS_INVITE_SENT: case A.STATUS_1XX_RECEIVED: case A.STATUS_INVITE_RECEIVED: case A.STATUS_WAITING_FOR_ANSWER: return !0; default: return !1 } } }, { key: "isEstablished", value: function () { switch ( this._status ) { case A.STATUS_ANSWERED: case A.STATUS_WAITING_FOR_ACK: case A.STATUS_CONFIRMED: return !0; default: return !1 } } }, { key: "isEnded", value: function () { switch ( this._status ) { case A.STATUS_CANCELED: case A.STATUS_TERMINATED: return !0; default: return !1 } } }, { key: "isMuted", value: function () { return { audio: this._audioMuted, video: this._videoMuted } } }, { key: "isOnHold", value: function () { return { local: this._localHold, remote: this._remoteHold } } }, { key: "connect", value: function ( e ) { var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}, n = arguments.length > 2 ? arguments[2] : void 0; E( "connect()" ); var r = e, i = t.eventHandlers || {}, o = d.cloneArray( t.extraHeaders ), s = t.mediaConstraints || { audio: !0, video: !0 }, u = t.mediaStream || null, l = t.pcConfig || { iceServers: [] }, a = t.rtcConstraints || null, h = t.rtcOfferConstraints || null; if ( this._rtcOfferConstraints = h, this._rtcAnswerConstraints = t.rtcAnswerConstraints || null, this._data = t.data || this._data, void 0 === e ) throw new TypeError( "Not enough arguments" ); if ( this._status !== A.STATUS_NULL ) throw new f.InvalidStateError( this._status ); if ( !window.RTCPeerConnection ) throw new f.NotSupportedError( "WebRTC not supported" ); if ( !( e = this._ua.normalizeTarget( e ) ) ) throw new TypeError( "Invalid target: ".concat( r ) ); for ( var _ in this._sessionTimers.enabled && d.isDecimal( t.sessionTimersExpires ) && ( t.sessionTimersExpires >= c.MIN_SESSION_EXPIRES ? this._sessionTimers.defaultExpires = t.sessionTimersExpires : this._sessionTimers.defaultExpires = c.SESSION_EXPIRES ), i ) Object.prototype.hasOwnProperty.call( i, _ ) && this.on( _, i[_] ); this._from_tag = d.newTag(); var v = t.anonymous || !1, m = { from_tag: this._from_tag }; this._contact = this._ua.contact.toString( { anonymous: v, outbound: !0 } ), v && ( m.from_display_name = "Anonymous", m.from_uri = new b( "sip", "anonymous", "anonymous.invalid" ), o.push( "P-Preferred-Identity: ".concat( this._ua.configuration.uri.toString() ) ), o.push( "Privacy: id" ) ), o.push( "Contact: ".concat( this._contact ) ), o.push( "Content-Type: application/sdp" ), this._sessionTimers.enabled && o.push( "Session-Expires: ".concat( this._sessionTimers.defaultExpires ) ), this._request = new p.InitialOutgoingInviteRequest( e, this._ua, m, o ), this._id = this._request.call_id + this._from_tag, this._createRTCConnection( l, a ), this._direction = "outgoing", this._local_identity = this._request.from, this._remote_identity = this._request.to, n && n( this ), this._newRTCSession( "local", this._request ), this._sendInitialRequest( s, h, u ) } }, { key: "init_incoming", value: function ( e, t ) { var n, r = this; E( "init_incoming()" ); var i = e.getHeader( "Content-Type" ); e.body && "application/sdp" !== i ? e.reply( 415 ) : ( this._status = A.STATUS_INVITE_RECEIVED, this._from_tag = e.from_tag, this._id = e.call_id + this._from_tag, this._request = e, this._contact = this._ua.contact.toString(), e.hasHeader( "expires" ) && ( n = 1e3 * e.getHeader( "expires" ) ), e.to_tag = d.newTag(), this._createDialog( e, "UAS", !0 ) ? ( e.body ? this._late_sdp = !1 : this._late_sdp = !0, this._status = A.STATUS_WAITING_FOR_ANSWER, this._timers.userNoAnswerTimer = setTimeout( ( function () { e.reply( 408 ), r._failed( "local", null, c.causes.NO_ANSWER ) } ), this._ua.configuration.no_answer_timeout ), n && ( this._timers.expiresTimer = setTimeout( ( function () { r._status === A.STATUS_WAITING_FOR_ANSWER && ( e.reply( 487 ), r._failed( "system", null, c.causes.EXPIRES ) ) } ), n ) ), this._direction = "incoming", this._local_identity = e.to, this._remote_identity = e.from, t && t( this ), this._newRTCSession( "remote", e ), this._status !== A.STATUS_TERMINATED && ( e.reply( 180, null, ["Contact: ".concat( this._contact )] ), this._progress( "local", null ) ) ) : e.reply( 500, "Missing Contact header field" ) ) } }, { key: "answer", value: function () { var e = this, t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}; E( "answer()" ); var n, r = this._request, i = d.cloneArray( t.extraHeaders ), o = t.mediaConstraints || {}, s = t.mediaStream || null, u = t.pcConfig || { iceServers: [] }, l = t.rtcConstraints || null, a = t.rtcAnswerConstraints || null, h = !1, _ = !1, p = !1, v = !1; if ( this._rtcAnswerConstraints = a, this._rtcOfferConstraints = t.rtcOfferConstraints || null, this._data = t.data || this._data, "incoming" !== this._direction ) throw new f.NotSupportedError( '"answer" not supported for outgoing RTCSession' ); if ( this._status !== A.STATUS_WAITING_FOR_ANSWER ) throw new f.InvalidStateError( this._status ); if ( this._sessionTimers.enabled && d.isDecimal( t.sessionTimersExpires ) && ( t.sessionTimersExpires >= c.MIN_SESSION_EXPIRES ? this._sessionTimers.defaultExpires = t.sessionTimersExpires : this._sessionTimers.defaultExpires = c.SESSION_EXPIRES ), this._status = A.STATUS_ANSWERED, this._createDialog( r, "UAS" ) ) { clearTimeout( this._timers.userNoAnswerTimer ), i.unshift( "Contact: ".concat( this._contact ) ); var m = r.parseSDP(); Array.isArray( m.media ) || ( m.media = [m.media] ); var g = !0, y = !1, T = void 0; try { for ( var C, b = m.media[Symbol.iterator](); !( g = ( C = b.next() ).done ); g = !0 ) { var w = C.value; "audio" === w.type && ( h = !0, w.direction && "sendrecv" !== w.direction || ( p = !0 ) ), "video" === w.type && ( _ = !0, w.direction && "sendrecv" !== w.direction || ( v = !0 ) ) } } catch ( e ) { y = !0, T = e } finally { try { g || null == b.return || b.return() } finally { if ( y ) throw T } } if ( s && !1 === o.audio ) { n = s.getAudioTracks(); var R = !0, I = !1, O = void 0; try { for ( var k, x = n[Symbol.iterator](); !( R = ( k = x.next() ).done ); R = !0 ) { var N = k.value; s.removeTrack( N ) } } catch ( e ) { I = !0, O = e } finally { try { R || null == x.return || x.return() } finally { if ( I ) throw O } } } if ( s && !1 === o.video ) { n = s.getVideoTracks(); var P = !0, U = !1, D = void 0; try { for ( var L, M = n[Symbol.iterator](); !( P = ( L = M.next() ).done ); P = !0 ) { var q = L.value; s.removeTrack( q ) } } catch ( e ) { U = !0, D = e } finally { try { P || null == M.return || M.return() } finally { if ( U ) throw D } } } s || void 0 !== o.audio || ( o.audio = p ), s || void 0 !== o.video || ( o.video = v ), s || h || ( o.audio = !1 ), s || _ || ( o.video = !1 ), this._createRTCConnection( u, l ), Promise.resolve().then( ( function () { return s || ( o.audio || o.video ? ( e._localMediaStreamLocallyGenerated = !0, navigator.mediaDevices.getUserMedia( o ).catch( ( function ( t ) { if ( e._status === A.STATUS_TERMINATED ) throw new Error( "terminated" ); throw r.reply( 480 ), e._failed( "local", null, c.causes.USER_DENIED_MEDIA_ACCESS ), S( 'emit "getusermediafailed" [error:%o]', t ), e.emit( "getusermediafailed", t ), new Error( "getUserMedia() failed" ) } ) ) ) : void 0 ) } ) ).then( ( function ( t ) { if ( e._status === A.STATUS_TERMINATED ) throw new Error( "terminated" ); e._localMediaStream = t, t && t.getTracks().forEach( ( function ( n ) { e._connection.addTrack( n, t ) } ) ) } ) ).then( ( function () { if ( !e._late_sdp ) { var t = { originator: "remote", type: "offer", sdp: r.body }; E( 'emit "sdp"' ), e.emit( "sdp", t ); var n = new RTCSessionDescription( { type: "offer", sdp: t.sdp } ); return e._connectionPromiseQueue = e._connectionPromiseQueue.then( ( function () { return e._connection.setRemoteDescription( n ) } ) ).catch( ( function ( t ) { throw r.reply( 488 ), e._failed( "system", null, c.causes.WEBRTC_ERROR ), S( 'emit "peerconnection:setremotedescriptionfailed" [error:%o]', t ), e.emit( "peerconnection:setremotedescriptionfailed", t ), new Error( "peerconnection.setRemoteDescription() failed" ) } ) ), e._connectionPromiseQueue } } ) ).then( ( function () { if ( e._status === A.STATUS_TERMINATED ) throw new Error( "terminated" ); return e._connecting( r ), e._late_sdp ? e._createLocalDescription( "offer", e._rtcOfferConstraints ).catch( ( function () { throw r.reply( 500 ), new Error( "_createLocalDescription() failed" ) } ) ) : e._createLocalDescription( "answer", a ).catch( ( function () { throw r.reply( 500 ), new Error( "_createLocalDescription() failed" ) } ) ) } ) ).then( ( function ( t ) { if ( e._status === A.STATUS_TERMINATED ) throw new Error( "terminated" ); e._handleSessionTimersInIncomingRequest( r, i ), r.reply( 200, null, i, t, ( function () { e._status = A.STATUS_WAITING_FOR_ACK, e._setInvite2xxTimer( r, t ), e._setACKTimer(), e._accepted( "local" ) } ), ( function () { e._failed( "system", null, c.causes.CONNECTION_ERROR ) } ) ) } ) ).catch( ( function ( t ) { e._status !== A.STATUS_TERMINATED && S( t ) } ) ) } else r.reply( 500, "Error creating dialog" ) } }, { key: "terminate", value: function () { var e = this, t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}; E( "terminate()" ); var n, r = t.cause || c.causes.BYE, i = d.cloneArray( t.extraHeaders ), o = t.body, s = t.status_code, u = t.reason_phrase; if ( this._status === A.STATUS_TERMINATED ) throw new f.InvalidStateError( this._status ); switch ( this._status ) { case A.STATUS_NULL: case A.STATUS_INVITE_SENT: case A.STATUS_1XX_RECEIVED: if ( E( "canceling session" ), s && ( s < 200 || s >= 700 ) ) throw new TypeError( "Invalid status_code: ".concat( s ) ); s && ( u = u || c.REASON_PHRASE[s] || "", n = "SIP ;cause=".concat( s, ' ;text="' ).concat( u, '"' ) ), this._status === A.STATUS_NULL || this._status === A.STATUS_INVITE_SENT ? ( this._is_canceled = !0, this._cancel_reason = n ) : this._status === A.STATUS_1XX_RECEIVED && this._request.cancel( n ), this._status = A.STATUS_CANCELED, this._failed( "local", null, c.causes.CANCELED ); break; case A.STATUS_WAITING_FOR_ANSWER: case A.STATUS_ANSWERED: if ( E( "rejecting session" ), ( s = s || 480 ) < 300 || s >= 700 ) throw new TypeError( "Invalid status_code: ".concat( s ) ); this._request.reply( s, u, i, o ), this._failed( "local", null, c.causes.REJECTED ); break; case A.STATUS_WAITING_FOR_ACK: case A.STATUS_CONFIRMED: if ( E( "terminating session" ), u = t.reason_phrase || c.REASON_PHRASE[s] || "", s && ( s < 200 || s >= 700 ) ) throw new TypeError( "Invalid status_code: ".concat( s ) ); if ( s && i.push( "Reason: SIP ;cause=".concat( s, '; text="' ).concat( u, '"' ) ), this._status === A.STATUS_WAITING_FOR_ACK && "incoming" === this._direction && this._request.server_transaction.state !== h.C.STATUS_TERMINATED ) { var l = this._dialog; this.receiveRequest = function ( t ) { t.method === c.ACK && ( e.sendRequest( c.BYE, { extraHeaders: i, body: o } ), l.terminate() ) }, this._request.server_transaction.on( "stateChanged", ( function () { e._request.server_transaction.state === h.C.STATUS_TERMINATED && ( e.sendRequest( c.BYE, { extraHeaders: i, body: o } ), l.terminate() ) } ) ), this._ended( "local", null, r ), this._dialog = l, this._ua.newDialog( l ) } else this.sendRequest( c.BYE, { extraHeaders: i, body: o } ), this._ended( "local", null, r ) } } }, { key: "sendDTMF", value: function ( e ) { var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}; E( "sendDTMF() | tones: %s", e ); var n = 0, r = t.duration || null, i = t.interToneGap || null; if ( void 0 === e ) throw new TypeError( "Not enough arguments" ); if ( this._status !== A.STATUS_CONFIRMED && this._status !== A.STATUS_WAITING_FOR_ACK ) throw new f.InvalidStateError( this._status ); if ( "number" == typeof e && ( e = e.toString() ), !e || "string" != typeof e || !e.match( /^[0-9A-DR#*,]+$/i ) ) throw new TypeError( "Invalid tones: ".concat( e ) ); if ( r && !d.isDecimal( r ) ) throw new TypeError( "Invalid tone duration: ".concat( r ) ); if ( r ? r < g.C.MIN_DURATION ? ( E( '"duration" value is lower than the minimum allowed, setting it to '.concat( g.C.MIN_DURATION, " milliseconds" ) ), r = g.C.MIN_DURATION ) : r > g.C.MAX_DURATION ? ( E( '"duration" value is greater than the maximum allowed, setting it to '.concat( g.C.MAX_DURATION, " milliseconds" ) ), r = g.C.MAX_DURATION ) : r = Math.abs( r ) : r = g.C.DEFAULT_DURATION, t.duration = r, i && !d.isDecimal( i ) ) throw new TypeError( "Invalid interToneGap: ".concat( i ) ); i ? i < g.C.MIN_INTER_TONE_GAP ? ( E( '"interToneGap" value is lower than the minimum allowed, setting it to '.concat( g.C.MIN_INTER_TONE_GAP, " milliseconds" ) ), i = g.C.MIN_INTER_TONE_GAP ) : i = Math.abs( i ) : i = g.C.DEFAULT_INTER_TONE_GAP, this._tones ? this._tones += e : ( this._tones = e, function e () { var o, s = this; if ( this._status === A.STATUS_TERMINATED || !this._tones || n >= this._tones.length ) this._tones = null; else { var u = this._tones[n]; if ( n += 1, "," === u ) o = 2e3; else { var l = new g( this ); t.eventHandlers = { onFailed: function () { s._tones = null } }, l.send( u, t ), o = r + i } setTimeout( e.bind( this ), o ) } }.call( this ) ) } }, { key: "sendInfo", value: function ( e, t ) { var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {}; if ( E( "sendInfo()" ), this._status !== A.STATUS_CONFIRMED && this._status !== A.STATUS_WAITING_FOR_ACK ) throw new f.InvalidStateError( this._status ); new y( this ).send( e, t, n ) } }, { key: "mute", value: function () { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : { audio: !0, video: !1 }; E( "mute()" ); var t = !1, n = !1; !1 === this._audioMuted && e.audio && ( t = !0, this._audioMuted = !0, this._toggleMuteAudio( !0 ) ), !1 === this._videoMuted && e.video && ( n = !0, this._videoMuted = !0, this._toggleMuteVideo( !0 ) ), !0 !== t && !0 !== n || this._onmute( { audio: t, video: n } ) } }, { key: "unmute", value: function () { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : { audio: !0, video: !0 }; E( "unmute()" ); var t = !1, n = !1; !0 === this._audioMuted && e.audio && ( t = !0, this._audioMuted = !1, !1 === this._localHold && this._toggleMuteAudio( !1 ) ), !0 === this._videoMuted && e.video && ( n = !0, this._videoMuted = !1, !1 === this._localHold && this._toggleMuteVideo( !1 ) ), !0 !== t && !0 !== n || this._onunmute( { audio: t, video: n } ) } }, { key: "hold", value: function () { var e = this, t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, n = arguments.length > 1 ? arguments[1] : void 0; if ( E( "hold()" ), this._status !== A.STATUS_WAITING_FOR_ACK && this._status !== A.STATUS_CONFIRMED ) return !1; if ( !0 === this._localHold ) return !1; if ( !this._isReadyToReOffer() ) return !1; this._localHold = !0, this._onhold( "local" ); var r = { succeeded: function () { n && n() }, failed: function () { e.terminate( { cause: c.causes.WEBRTC_ERROR, status_code: 500, reason_phrase: "Hold Failed" } ) } }; return t.useUpdate ? this._sendUpdate( { sdpOffer: !0, eventHandlers: r, extraHeaders: t.extraHeaders } ) : this._sendReinvite( { eventHandlers: r, extraHeaders: t.extraHeaders } ), !0 } }, { key: "unhold", value: function () { var e = this, t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, n = arguments.length > 1 ? arguments[1] : void 0; if ( E( "unhold()" ), this._status !== A.STATUS_WAITING_FOR_ACK && this._status !== A.STATUS_CONFIRMED ) return !1; if ( !1 === this._localHold ) return !1; if ( !this._isReadyToReOffer() ) return !1; this._localHold = !1, this._onunhold( "local" ); var r = { succeeded: function () { n && n() }, failed: function () { e.terminate( { cause: c.causes.WEBRTC_ERROR, status_code: 500, reason_phrase: "Unhold Failed" } ) } }; return t.useUpdate ? this._sendUpdate( { sdpOffer: !0, eventHandlers: r, extraHeaders: t.extraHeaders } ) : this._sendReinvite( { eventHandlers: r, extraHeaders: t.extraHeaders } ), !0 } }, { key: "renegotiate", value: function () { var e = this, t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, n = arguments.length > 1 ? arguments[1] : void 0; E( "renegotiate()" ); var r = t.rtcOfferConstraints || null; if ( this._status !== A.STATUS_WAITING_FOR_ACK && this._status !== A.STATUS_CONFIRMED ) return !1; if ( !this._isReadyToReOffer() ) return !1; var i = { succeeded: function () { n && n() }, failed: function () { e.terminate( { cause: c.causes.WEBRTC_ERROR, status_code: 500, reason_phrase: "Media Renegotiation Failed" } ) } }; return this._setLocalMediaStatus(), t.useUpdate ? this._sendUpdate( { sdpOffer: !0, eventHandlers: i, rtcOfferConstraints: r, extraHeaders: t.extraHeaders } ) : this._sendReinvite( { eventHandlers: i, rtcOfferConstraints: r, extraHeaders: t.extraHeaders } ), !0 } }, { key: "refer", value: function ( e, t ) { var n = this; E( "refer()" ); var r = e; if ( this._status !== A.STATUS_WAITING_FOR_ACK && this._status !== A.STATUS_CONFIRMED ) return !1; if ( !( e = this._ua.normalizeTarget( e ) ) ) throw new TypeError( "Invalid target: ".concat( r ) ); var i = new C( this ); i.sendRefer( e, t ); var o = i.id; return this._referSubscribers[o] = i, i.on( "requestFailed", ( function () { delete n._referSubscribers[o] } ) ), i.on( "accepted", ( function () { delete n._referSubscribers[o] } ) ), i.on( "failed", ( function () { delete n._referSubscribers[o] } ) ), i } }, { key: "sendRequest", value: function ( e, t ) { return E( "sendRequest()" ), this._dialog.sendRequest( e, t ) } }, { key: "receiveRequest", value: function ( e ) { var t = this; if ( E( "receiveRequest()" ), e.method === c.CANCEL ) this._status !== A.STATUS_WAITING_FOR_ANSWER && this._status !== A.STATUS_ANSWERED || ( this._status = A.STATUS_CANCELED, this._request.reply( 487 ), this._failed( "remote", e, c.causes.CANCELED ) ); else switch ( e.method ) { case c.ACK: if ( this._status !== A.STATUS_WAITING_FOR_ACK ) return; if ( this._status = A.STATUS_CONFIRMED, clearTimeout( this._timers.ackTimer ), clearTimeout( this._timers.invite2xxTimer ), this._late_sdp ) { if ( !e.body ) { this.terminate( { cause: c.causes.MISSING_SDP, status_code: 400 } ); break } var n = { originator: "remote", type: "answer", sdp: e.body }; E( 'emit "sdp"' ), this.emit( "sdp", n ); var r = new RTCSessionDescription( { type: "answer", sdp: n.sdp } ); this._connectionPromiseQueue = this._connectionPromiseQueue.then( ( function () { return t._connection.setRemoteDescription( r ) } ) ).then( ( function () { t._is_confirmed || t._confirmed( "remote", e ) } ) ).catch( ( function ( e ) { t.terminate( { cause: c.causes.BAD_MEDIA_DESCRIPTION, status_code: 488 } ), S( 'emit "peerconnection:setremotedescriptionfailed" [error:%o]', e ), t.emit( "peerconnection:setremotedescriptionfailed", e ) } ) ) } else this._is_confirmed || this._confirmed( "remote", e ); break; case c.BYE: this._status === A.STATUS_CONFIRMED || this._status === A.STATUS_WAITING_FOR_ACK ? ( e.reply( 200 ), this._ended( "remote", e, c.causes.BYE ) ) : this._status === A.STATUS_INVITE_RECEIVED ? ( e.reply( 200 ), this._request.reply( 487, "BYE Received" ), this._ended( "remote", e, c.causes.BYE ) ) : e.reply( 403, "Wrong Status" ); break; case c.INVITE: this._status === A.STATUS_CONFIRMED ? e.hasHeader( "replaces" ) ? this._receiveReplaces( e ) : this._receiveReinvite( e ) : e.reply( 403, "Wrong Status" ); break; case c.INFO: if ( this._status === A.STATUS_1XX_RECEIVED || this._status === A.STATUS_WAITING_FOR_ANSWER || this._status === A.STATUS_ANSWERED || this._status === A.STATUS_WAITING_FOR_ACK || this._status === A.STATUS_CONFIRMED ) { var i = e.getHeader( "content-type" ); i && i.match( /^application\/dtmf-relay/i ) ? new g( this ).init_incoming( e ) : void 0 !== i ? new y( this ).init_incoming( e ) : e.reply( 415 ) } else e.reply( 403, "Wrong Status" ); break; case c.UPDATE: this._status === A.STATUS_CONFIRMED ? this._receiveUpdate( e ) : e.reply( 403, "Wrong Status" ); break; case c.REFER: this._status === A.STATUS_CONFIRMED ? this._receiveRefer( e ) : e.reply( 403, "Wrong Status" ); break; case c.NOTIFY: this._status === A.STATUS_CONFIRMED ? this._receiveNotify( e ) : e.reply( 403, "Wrong Status" ); break; default: e.reply( 501 ) } } }, { key: "onTransportError", value: function () { S( "onTransportError()" ), this._status !== A.STATUS_TERMINATED && this.terminate( { status_code: 500, reason_phrase: c.causes.CONNECTION_ERROR, cause: c.causes.CONNECTION_ERROR } ) } }, { key: "onRequestTimeout", value: function () { S( "onRequestTimeout()" ), this._status !== A.STATUS_TERMINATED && this.terminate( { status_code: 408, reason_phrase: c.causes.REQUEST_TIMEOUT, cause: c.causes.REQUEST_TIMEOUT } ) } }, { key: "onDialogError", value: function () { S( "onDialogError()" ), this._status !== A.STATUS_TERMINATED && this.terminate( { status_code: 500, reason_phrase: c.causes.DIALOG_ERROR, cause: c.causes.DIALOG_ERROR } ) } }, { key: "newDTMF", value: function ( e ) { E( "newDTMF()" ), this.emit( "newDTMF", e ) } }, { key: "newInfo", value: function ( e ) { E( "newInfo()" ), this.emit( "newInfo", e ) } }, { key: "_isReadyToReOffer", value: function () { return this._rtcReady ? this._dialog ? !0 !== this._dialog.uac_pending_reply && !0 !== this._dialog.uas_pending_reply || ( E( "_isReadyToReOffer() | there is another INVITE/UPDATE transaction in progress" ), !1 ) : ( E( "_isReadyToReOffer() | session not established yet" ), !1 ) : ( E( "_isReadyToReOffer() | internal WebRTC status not ready" ), !1 ) } }, { key: "_close", value: function () { if ( E( "close()" ), this._status !== A.STATUS_TERMINATED ) { if ( this._status = A.STATUS_TERMINATED, this._connection ) try { this._connection.close() } catch ( e ) { S( "close() | error closing the RTCPeerConnection: %o", e ) } for ( var e in this._localMediaStream && this._localMediaStreamLocallyGenerated && ( E( "close() | closing local MediaStream" ), d.closeMediaStream( this._localMediaStream ) ), this._timers ) Object.prototype.hasOwnProperty.call( this._timers, e ) && clearTimeout( this._timers[e] ); for ( var t in clearTimeout( this._sessionTimers.timer ), this._dialog && ( this._dialog.terminate(), delete this._dialog ), this._earlyDialogs ) Object.prototype.hasOwnProperty.call( this._earlyDialogs, t ) && ( this._earlyDialogs[t].terminate(), delete this._earlyDialogs[t] ); for ( var n in this._referSubscribers ) Object.prototype.hasOwnProperty.call( this._referSubscribers, n ) && delete this._referSubscribers[n]; this._ua.destroyRTCSession( this ) } } }, { key: "_setInvite2xxTimer", value: function ( e, t ) { var n = _.T1; this._timers.invite2xxTimer = setTimeout( function r () { this._status === A.STATUS_WAITING_FOR_ACK && ( e.reply( 200, null, ["Contact: ".concat( this._contact )], t ), n < _.T2 && ( n *= 2 ) > _.T2 && ( n = _.T2 ), this._timers.invite2xxTimer = setTimeout( r.bind( this ), n ) ) }.bind( this ), n ) } }, { key: "_setACKTimer", value: function () { var e = this; this._timers.ackTimer = setTimeout( ( function () { e._status === A.STATUS_WAITING_FOR_ACK && ( E( "no ACK received, terminating the session" ), clearTimeout( e._timers.invite2xxTimer ), e.sendRequest( c.BYE ), e._ended( "remote", null, c.causes.NO_ACK ) ) } ), _.TIMER_H ) } }, { key: "_createRTCConnection", value: function ( e, t ) { var n = this; this._connection = new RTCPeerConnection( e, t ), this._connection.addEventListener( "iceconnectionstatechange", ( function () { "failed" === n._connection.iceConnectionState && n.terminate( { cause: c.causes.RTP_TIMEOUT, status_code: 408, reason_phrase: c.causes.RTP_TIMEOUT } ) } ) ), E( 'emit "peerconnection"' ), this.emit( "peerconnection", { peerconnection: this._connection } ) } }, { key: "_createLocalDescription", value: function ( e, t ) { var n = this; if ( E( "createLocalDescription()" ), "offer" !== e && "answer" !== e ) throw new Error( 'createLocalDescription() | invalid type "'.concat( e, '"' ) ); var r = this._connection; return this._rtcReady = !1, Promise.resolve().then( ( function () { return "offer" === e ? r.createOffer( t ).catch( ( function ( e ) { return S( 'emit "peerconnection:createofferfailed" [error:%o]', e ), n.emit( "peerconnection:createofferfailed", e ), Promise.reject( e ) } ) ) : r.createAnswer( t ).catch( ( function ( e ) { return S( 'emit "peerconnection:createanswerfailed" [error:%o]', e ), n.emit( "peerconnection:createanswerfailed", e ), Promise.reject( e ) } ) ) } ) ).then( ( function ( e ) { return r.setLocalDescription( e ).catch( ( function ( e ) { return n._rtcReady = !0, S( 'emit "peerconnection:setlocaldescriptionfailed" [error:%o]', e ), n.emit( "peerconnection:setlocaldescriptionfailed", e ), Promise.reject( e ) } ) ) } ) ).then( ( function () { if ( "complete" === r.iceGatheringState ) { n._rtcReady = !0; var t = { originator: "local", type: e, sdp: r.localDescription.sdp }; return E( 'emit "sdp"' ), n.emit( "sdp", t ), Promise.resolve( t.sdp ) } return new Promise( ( function ( t ) { var i, o, s = !1, u = function () { r.removeEventListener( "icecandidate", i ), r.removeEventListener( "icegatheringstatechange", o ), s = !0, n._rtcReady = !0; var u = { originator: "local", type: e, sdp: r.localDescription.sdp }; E( 'emit "sdp"' ), n.emit( "sdp", u ), t( u.sdp ) }; r.addEventListener( "icecandidate", i = function ( e ) { var t = e.candidate; t ? n.emit( "icecandidate", { candidate: t, ready: u } ) : s || u() } ), r.addEventListener( "icegatheringstatechange", o = function () { "complete" !== r.iceGatheringState || s || u() } ) } ) ) } ) ) } }, { key: "_createDialog", value: function ( e, t, n ) { var r = "UAS" === t ? e.to_tag : e.from_tag, i = "UAS" === t ? e.from_tag : e.to_tag, o = e.call_id + r + i, s = this._earlyDialogs[o]; if ( n ) return !!s || ( ( s = new v( this, e, t, v.C.STATUS_EARLY ) ).error ? ( E( s.error ), this._failed( "remote", e, c.causes.INTERNAL_ERROR ), !1 ) : ( this._earlyDialogs[o] = s, !0 ) ); if ( this._from_tag = e.from_tag, this._to_tag = e.to_tag, s ) return s.update( e, t ), this._dialog = s, delete this._earlyDialogs[o], !0; var u = new v( this, e, t ); return u.error ? ( E( u.error ), this._failed( "remote", e, c.causes.INTERNAL_ERROR ), !1 ) : ( this._dialog = u, !0 ) } }, { key: "_receiveReinvite", value: function ( e ) { var t = this; E( "receiveReinvite()" ); var n = e.getHeader( "Content-Type" ), r = { request: e, callback: void 0, reject: function () { var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}; i = !0; var n = t.status_code || 403, r = t.reason_phrase || "", o = d.cloneArray( t.extraHeaders ); if ( this._status !== A.STATUS_CONFIRMED ) return !1; if ( n < 300 || n >= 700 ) throw new TypeError( "Invalid status_code: ".concat( n ) ); e.reply( n, r, o ) }.bind( this ) }, i = !1; if ( this.emit( "reinvite", r ), !i ) { if ( this._late_sdp = !1, !e.body ) return this._late_sdp = !0, void ( this._connectionPromiseQueue = this._connectionPromiseQueue.then( ( function () { return t._createLocalDescription( "offer", t._rtcOfferConstraints ) } ) ).then( ( function ( e ) { o.call( t, e ) } ) ).catch( ( function () { e.reply( 500 ) } ) ) ); if ( "application/sdp" !== n ) return E( "invalid Content-Type" ), void e.reply( 415 ); this._processInDialogSdpOffer( e ).then( ( function ( e ) { t._status !== A.STATUS_TERMINATED && o.call( t, e ) } ) ).catch( ( function ( e ) { S( e ) } ) ) } function o ( t ) { var n = this, i = ["Contact: ".concat( this._contact )]; this._handleSessionTimersInIncomingRequest( e, i ), this._late_sdp && ( t = this._mangleOffer( t ) ), e.reply( 200, null, i, t, ( function () { n._status = A.STATUS_WAITING_FOR_ACK, n._setInvite2xxTimer( e, t ), n._setACKTimer() } ) ), "function" == typeof r.callback && r.callback() } } }, { key: "_receiveUpdate", value: function ( e ) { var t = this; E( "receiveUpdate()" ); var n = e.getHeader( "Content-Type" ), r = { request: e, callback: void 0, reject: function () { var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}; i = !0; var n = t.status_code || 403, r = t.reason_phrase || "", o = d.cloneArray( t.extraHeaders ); if ( this._status !== A.STATUS_CONFIRMED ) return !1; if ( n < 300 || n >= 700 ) throw new TypeError( "Invalid status_code: ".concat( n ) ); e.reply( n, r, o ) }.bind( this ) }, i = !1; if ( this.emit( "update", r ), !i ) if ( e.body ) { if ( "application/sdp" !== n ) return E( "invalid Content-Type" ), void e.reply( 415 ); this._processInDialogSdpOffer( e ).then( ( function ( e ) { t._status !== A.STATUS_TERMINATED && o.call( t, e ) } ) ).catch( ( function ( e ) { S( e ) } ) ) } else o.call( this, null ); function o ( t ) { var n = ["Contact: ".concat( this._contact )]; this._handleSessionTimersInIncomingRequest( e, n ), e.reply( 200, null, n, t ), "function" == typeof r.callback && r.callback() } } }, { key: "_processInDialogSdpOffer", value: function ( e ) { var t = this; E( "_processInDialogSdpOffer()" ); var n = e.parseSDP(), r = !1, i = !0, o = !1, s = void 0; try { for ( var u, l = n.media[Symbol.iterator](); !( i = ( u = l.next() ).done ); i = !0 ) { var a = u.value; if ( -1 !== w.indexOf( a.type ) ) { var c = a.direction || n.direction || "sendrecv"; if ( "sendonly" !== c && "inactive" !== c ) { r = !1; break } r = !0 } } } catch ( e ) { o = !0, s = e } finally { try { i || null == l.return || l.return() } finally { if ( o ) throw s } } var f = { originator: "remote", type: "offer", sdp: e.body }; E( 'emit "sdp"' ), this.emit( "sdp", f ); var h = new RTCSessionDescription( { type: "offer", sdp: f.sdp } ); return this._connectionPromiseQueue = this._connectionPromiseQueue.then( ( function () { if ( t._status === A.STATUS_TERMINATED ) throw new Error( "terminated" ); return t._connection.setRemoteDescription( h ).catch( ( function ( n ) { throw e.reply( 488 ), S( 'emit "peerconnection:setremotedescriptionfailed" [error:%o]', n ), t.emit( "peerconnection:setremotedescriptionfailed", n ), new Error( "peerconnection.setRemoteDescription() failed" ) } ) ) } ) ).then( ( function () { if ( t._status === A.STATUS_TERMINATED ) throw new Error( "terminated" ); !0 === t._remoteHold && !1 === r ? ( t._remoteHold = !1, t._onunhold( "remote" ) ) : !1 === t._remoteHold && !0 === r && ( t._remoteHold = !0, t._onhold( "remote" ) ) } ) ).then( ( function () { if ( t._status === A.STATUS_TERMINATED ) throw new Error( "terminated" ); return t._createLocalDescription( "answer", t._rtcAnswerConstraints ).catch( ( function () { throw e.reply( 500 ), new Error( "_createLocalDescription() failed" ) } ) ) } ) ), this._connectionPromiseQueue } }, { key: "_receiveRefer", value: function ( e ) { var n = this; if ( E( "receiveRefer()" ), !e.refer_to ) return E( "no Refer-To header field present in REFER" ), void e.reply( 400 ); if ( e.refer_to.uri.scheme !== c.SIP ) return E( "Refer-To header field points to a non-SIP URI scheme" ), void e.reply( 416 ); e.reply( 202 ); var r = new T( this, e.cseq ); E( 'emit "refer"' ), this.emit( "refer", { request: e, accept: function ( i, o ) { ( function ( n ) { var i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}; if ( n = "function" == typeof n ? n : null, this._status !== A.STATUS_WAITING_FOR_ACK && this._status !== A.STATUS_CONFIRMED ) return !1; var o = new t( this._ua ); if ( o.on( "progress", ( function ( e ) { var t = e.response; r.notify( t.status_code, t.reason_phrase ) } ) ), o.on( "accepted", ( function ( e ) { var t = e.response; r.notify( t.status_code, t.reason_phrase ) } ) ), o.on( "_failed", ( function ( e ) { var t = e.message, n = e.cause; t ? r.notify( t.status_code, t.reason_phrase ) : r.notify( 487, n ) } ) ), e.refer_to.uri.hasHeader( "replaces" ) ) { var s = decodeURIComponent( e.refer_to.uri.getHeader( "replaces" ) ); i.extraHeaders = d.cloneArray( i.extraHeaders ), i.extraHeaders.push( "Replaces: ".concat( s ) ) } o.connect( e.refer_to.uri.toAor(), i, n ) } ).call( n, i, o ) }, reject: function () { ( function () { r.notify( 603 ) } ).call( n ) } } ) } }, { key: "_receiveNotify", value: function ( e ) { switch ( E( "receiveNotify()" ), e.event || e.reply( 400 ), e.event.event ) { case "refer": var t, n; if ( e.event.params && e.event.params.id ) t = e.event.params.id, n = this._referSubscribers[t]; else { if ( 1 !== Object.keys( this._referSubscribers ).length ) return void e.reply( 400, "Missing event id parameter" ); n = this._referSubscribers[Object.keys( this._referSubscribers )[0]] } if ( !n ) return void e.reply( 481, "Subscription does not exist" ); n.receiveNotify( e ), e.reply( 200 ); break; default: e.reply( 489 ) } } }, { key: "_receiveReplaces", value: function ( e ) { var n = this; E( "receiveReplaces()" ), this.emit( "replaces", { request: e, accept: function ( r ) { ( function ( n ) { var r = this; if ( this._status !== A.STATUS_WAITING_FOR_ACK && this._status !== A.STATUS_CONFIRMED ) return !1; var i = new t( this._ua ); i.on( "confirmed", ( function () { r.terminate() } ) ), i.init_incoming( e, n ) } ).call( n, r ) }, reject: function () { ( function () { E( "Replaced INVITE rejected by the user" ), e.reply( 486 ) } ).call( n ) } } ) } }, { key: "_sendInitialRequest", value: function ( e, t, n ) { var r = this, i = new m( this._ua, this._request, { onRequestTimeout: function () { r.onRequestTimeout() }, onTransportError: function () { r.onTransportError() }, onAuthenticated: function ( e ) { r._request = e }, onReceiveResponse: function ( e ) { r._receiveInviteResponse( e ) } } ); Promise.resolve().then( ( function () { return n || ( e.audio || e.video ? ( r._localMediaStreamLocallyGenerated = !0, navigator.mediaDevices.getUserMedia( e ).catch( ( function ( e ) { if ( r._status === A.STATUS_TERMINATED ) throw new Error( "terminated" ); throw r._failed( "local", null, c.causes.USER_DENIED_MEDIA_ACCESS ), S( 'emit "getusermediafailed" [error:%o]', e ), r.emit( "getusermediafailed", e ), e } ) ) ) : void 0 ) } ) ).then( ( function ( e ) { if ( r._status === A.STATUS_TERMINATED ) throw new Error( "terminated" ); return r._localMediaStream = e, e && e.getTracks().forEach( ( function ( t ) { r._connection.addTrack( t, e ) } ) ), r._connecting( r._request ), r._createLocalDescription( "offer", t ).catch( ( function ( e ) { throw r._failed( "local", null, c.causes.WEBRTC_ERROR ), e } ) ) } ) ).then( ( function ( e ) { if ( r._is_canceled || r._status === A.STATUS_TERMINATED ) throw new Error( "terminated" ); r._request.body = e, r._status = A.STATUS_INVITE_SENT, E( 'emit "sending" [request:%o]', r._request ), r.emit( "sending", { request: r._request } ), i.send() } ) ).catch( ( function ( e ) { r._status !== A.STATUS_TERMINATED && S( e ) } ) ) } }, { key: "_receiveInviteResponse", value: function ( e ) { var t = this; if ( E( "receiveInviteResponse()" ), this._dialog && e.status_code >= 200 && e.status_code <= 299 ) { if ( this._dialog.id.call_id === e.call_id && this._dialog.id.local_tag === e.from_tag && this._dialog.id.remote_tag === e.to_tag ) return void this.sendRequest( c.ACK ); var n = new v( this, e, "UAC" ); return void 0 !== n.error ? void E( n.error ) : ( this.sendRequest( c.ACK ), void this.sendRequest( c.BYE ) ) } if ( this._is_canceled ) e.status_code >= 100 && e.status_code < 200 ? this._request.cancel( this._cancel_reason ) : e.status_code >= 200 && e.status_code < 299 && this._acceptAndTerminate( e ); else if ( this._status === A.STATUS_INVITE_SENT || this._status === A.STATUS_1XX_RECEIVED ) switch ( !0 ) { case /^100$/.test( e.status_code ): this._status = A.STATUS_1XX_RECEIVED; break; case /^1[0-9]{2}$/.test( e.status_code ): if ( !e.to_tag ) { E( "1xx response received without to tag" ); break } if ( e.hasHeader( "contact" ) && !this._createDialog( e, "UAC", !0 ) ) break; if ( this._status = A.STATUS_1XX_RECEIVED, this._progress( "remote", e ), !e.body ) break; var r = { originator: "remote", type: "answer", sdp: e.body }; E( 'emit "sdp"' ), this.emit( "sdp", r ); var i = new RTCSessionDescription( { type: "answer", sdp: r.sdp } ); this._connectionPromiseQueue = this._connectionPromiseQueue.then( ( function () { return t._connection.setRemoteDescription( i ) } ) ).catch( ( function ( e ) { S( 'emit "peerconnection:setremotedescriptionfailed" [error:%o]', e ), t.emit( "peerconnection:setremotedescriptionfailed", e ) } ) ); break; case /^2[0-9]{2}$/.test( e.status_code ): if ( this._status = A.STATUS_CONFIRMED, !e.body ) { this._acceptAndTerminate( e, 400, c.causes.MISSING_SDP ), this._failed( "remote", e, c.causes.BAD_MEDIA_DESCRIPTION ); break } if ( !this._createDialog( e, "UAC" ) ) break; var o = { originator: "remote", type: "answer", sdp: e.body }; E( 'emit "sdp"' ), this.emit( "sdp", o ); var s = new RTCSessionDescription( { type: "answer", sdp: o.sdp } ); this._connectionPromiseQueue = this._connectionPromiseQueue.then( ( function () { if ( "stable" === t._connection.signalingState ) return t._connection.createOffer( t._rtcOfferConstraints ).then( ( function ( e ) { return t._connection.setLocalDescription( e ) } ) ).catch( ( function ( n ) { t._acceptAndTerminate( e, 500, n.toString() ), t._failed( "local", e, c.causes.WEBRTC_ERROR ) } ) ) } ) ).then( ( function () { t._connection.setRemoteDescription( s ).then( ( function () { t._handleSessionTimersInIncomingResponse( e ), t._accepted( "remote", e ), t.sendRequest( c.ACK ), t._confirmed( "local", null ) } ) ).catch( ( function ( n ) { t._acceptAndTerminate( e, 488, "Not Acceptable Here" ), t._failed( "remote", e, c.causes.BAD_MEDIA_DESCRIPTION ), S( 'emit "peerconnection:setremotedescriptionfailed" [error:%o]', n ), t.emit( "peerconnection:setremotedescriptionfailed", n ) } ) ) } ) ); break; default: var u = d.sipErrorCause( e.status_code ); this._failed( "remote", e, u ) } } }, { key: "_sendReinvite", value: function () { var e = this, t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}; E( "sendReinvite()" ); var n = d.cloneArray( t.extraHeaders ), r = t.eventHandlers || {}, i = t.rtcOfferConstraints || this._rtcOfferConstraints || null, o = !1; function s ( e ) { r.failed && r.failed( e ) } n.push( "Contact: ".concat( this._contact ) ), n.push( "Content-Type: application/sdp" ), this._sessionTimers.running && n.push( "Session-Expires: ".concat( this._sessionTimers.currentExpires, ";refresher=" ).concat( this._sessionTimers.refresher ? "uac" : "uas" ) ), this._connectionPromiseQueue = this._connectionPromiseQueue.then( ( function () { return e._createLocalDescription( "offer", i ) } ) ).then( ( function ( t ) { var i = { originator: "local", type: "offer", sdp: t = e._mangleOffer( t ) }; E( 'emit "sdp"' ), e.emit( "sdp", i ), e.sendRequest( c.INVITE, { extraHeaders: n, body: t, eventHandlers: { onSuccessResponse: function ( t ) { ( function ( e ) { var t = this; if ( this._status !== A.STATUS_TERMINATED && ( this.sendRequest( c.ACK ), !o ) ) if ( this._handleSessionTimersInIncomingResponse( e ), e.body ) if ( "application/sdp" === e.getHeader( "Content-Type" ) ) { var n = { originator: "remote", type: "answer", sdp: e.body }; E( 'emit "sdp"' ), this.emit( "sdp", n ); var i = new RTCSessionDescription( { type: "answer", sdp: n.sdp } ); this._connectionPromiseQueue = this._connectionPromiseQueue.then( ( function () { return t._connection.setRemoteDescription( i ) } ) ).then( ( function () { r.succeeded && r.succeeded( e ) } ) ).catch( ( function ( e ) { s.call( t ), S( 'emit "peerconnection:setremotedescriptionfailed" [error:%o]', e ), t.emit( "peerconnection:setremotedescriptionfailed", e ) } ) ) } else s.call( this ); else s.call( this ) } ).call( e, t ), o = !0 }, onErrorResponse: function ( t ) { s.call( e, t ) }, onTransportError: function () { e.onTransportError() }, onRequestTimeout: function () { e.onRequestTimeout() }, onDialogError: function () { e.onDialogError() } } } ) } ) ).catch( ( function () { s() } ) ) } }, { key: "_sendUpdate", value: function () { var e = this, t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}; E( "sendUpdate()" ); var n = d.cloneArray( t.extraHeaders ), r = t.eventHandlers || {}, i = t.rtcOfferConstraints || this._rtcOfferConstraints || null, o = t.sdpOffer || !1, s = !1; function u ( e ) { var t = this; if ( this._status !== A.STATUS_TERMINATED && !s ) if ( this._handleSessionTimersInIncomingResponse( e ), o ) { if ( !e.body ) return void l.call( this ); if ( "application/sdp" !== e.getHeader( "Content-Type" ) ) return void l.call( this ); var n = { originator: "remote", type: "answer", sdp: e.body }; E( 'emit "sdp"' ), this.emit( "sdp", n ); var i = new RTCSessionDescription( { type: "answer", sdp: n.sdp } ); this._connectionPromiseQueue = this._connectionPromiseQueue.then( ( function () { return t._connection.setRemoteDescription( i ) } ) ).then( ( function () { r.succeeded && r.succeeded( e ) } ) ).catch( ( function ( e ) { l.call( t ), S( 'emit "peerconnection:setremotedescriptionfailed" [error:%o]', e ), t.emit( "peerconnection:setremotedescriptionfailed", e ) } ) ) } else r.succeeded && r.succeeded( e ) } function l ( e ) { r.failed && r.failed( e ) } n.push( "Contact: ".concat( this._contact ) ), this._sessionTimers.running && n.push( "Session-Expires: ".concat( this._sessionTimers.currentExpires, ";refresher=" ).concat( this._sessionTimers.refresher ? "uac" : "uas" ) ), o ? ( n.push( "Content-Type: application/sdp" ), this._connectionPromiseQueue = this._connectionPromiseQueue.then( ( function () { return e._createLocalDescription( "offer", i ) } ) ).then( ( function ( t ) { var r = { originator: "local", type: "offer", sdp: t = e._mangleOffer( t ) }; E( 'emit "sdp"' ), e.emit( "sdp", r ), e.sendRequest( c.UPDATE, { extraHeaders: n, body: t, eventHandlers: { onSuccessResponse: function ( t ) { u.call( e, t ), s = !0 }, onErrorResponse: function ( t ) { l.call( e, t ) }, onTransportError: function () { e.onTransportError() }, onRequestTimeout: function () { e.onRequestTimeout() }, onDialogError: function () { e.onDialogError() } } } ) } ) ).catch( ( function () { l.call( e ) } ) ) ) : this.sendRequest( c.UPDATE, { extraHeaders: n, eventHandlers: { onSuccessResponse: function ( t ) { u.call( e, t ) }, onErrorResponse: function ( t ) { l.call( e, t ) }, onTransportError: function () { e.onTransportError() }, onRequestTimeout: function () { e.onRequestTimeout() }, onDialogError: function () { e.onDialogError() } } } ) } }, { key: "_acceptAndTerminate", value: function ( e, t, n ) { E( "acceptAndTerminate()" ); var r = []; t && ( n = n || c.REASON_PHRASE[t] || "", r.push( "Reason: SIP ;cause=".concat( t, '; text="' ).concat( n, '"' ) ) ), ( this._dialog || this._createDialog( e, "UAC" ) ) && ( this.sendRequest( c.ACK ), this.sendRequest( c.BYE, { extraHeaders: r } ) ), this._status = A.STATUS_TERMINATED } }, { key: "_mangleOffer", value: function ( e ) { if ( !this._localHold && !this._remoteHold ) return e; if ( e = a.parse( e ), this._localHold && !this._remoteHold ) { E( "mangleOffer() | me on hold, mangling offer" ); var t = !0, n = !1, r = void 0; try { for ( var i, o = e.media[Symbol.iterator](); !( t = ( i = o.next() ).done ); t = !0 ) { var s = i.value; -1 !== w.indexOf( s.type ) && ( s.direction ? "sendrecv" === s.direction ? s.direction = "sendonly" : "recvonly" === s.direction && ( s.direction = "inactive" ) : s.direction = "sendonly" ) } } catch ( e ) { n = !0, r = e } finally { try { t || null == o.return || o.return() } finally { if ( n ) throw r } } } else if ( this._localHold && this._remoteHold ) { E( "mangleOffer() | both on hold, mangling offer" ); var u = !0, l = !1, c = void 0; try { for ( var f, h = e.media[Symbol.iterator](); !( u = ( f = h.next() ).done ); u = !0 ) { var d = f.value; -1 !== w.indexOf( d.type ) && ( d.direction = "inactive" ) } } catch ( e ) { l = !0, c = e } finally { try { u || null == h.return || h.return() } finally { if ( l ) throw c } } } else if ( this._remoteHold ) { E( "mangleOffer() | remote on hold, mangling offer" ); var _ = !0, p = !1, v = void 0; try { for ( var m, g = e.media[Symbol.iterator](); !( _ = ( m = g.next() ).done ); _ = !0 ) { var y = m.value; -1 !== w.indexOf( y.type ) && ( y.direction ? "sendrecv" === y.direction ? y.direction = "recvonly" : "recvonly" === y.direction && ( y.direction = "inactive" ) : y.direction = "recvonly" ) } } catch ( e ) { p = !0, v = e } finally { try { _ || null == g.return || g.return() } finally { if ( p ) throw v } } } return a.write( e ) } }, { key: "_setLocalMediaStatus", value: function () { var e = !0, t = !0; ( this._localHold || this._remoteHold ) && ( e = !1, t = !1 ), this._audioMuted && ( e = !1 ), this._videoMuted && ( t = !1 ), this._toggleMuteAudio( !e ), this._toggleMuteVideo( !t ) } }, { key: "_handleSessionTimersInIncomingRequest", value: function ( e, t ) { var n; this._sessionTimers.enabled && ( e.session_expires && e.session_expires >= c.MIN_SESSION_EXPIRES ? ( this._sessionTimers.currentExpires = e.session_expires, n = e.session_expires_refresher || "uas" ) : ( this._sessionTimers.currentExpires = this._sessionTimers.defaultExpires, n = "uas" ), t.push( "Session-Expires: ".concat( this._sessionTimers.currentExpires, ";refresher=" ).concat( n ) ), this._sessionTimers.refresher = "uas" === n, this._runSessionTimer() ) } }, { key: "_handleSessionTimersInIncomingResponse", value: function ( e ) { var t; this._sessionTimers.enabled && ( e.session_expires && e.session_expires >= c.MIN_SESSION_EXPIRES ? ( this._sessionTimers.currentExpires = e.session_expires, t = e.session_expires_refresher || "uac" ) : ( this._sessionTimers.currentExpires = this._sessionTimers.defaultExpires, t = "uac" ), this._sessionTimers.refresher = "uac" === t, this._runSessionTimer() ) } }, { key: "_runSessionTimer", value: function () { var e = this, t = this._sessionTimers.currentExpires; this._sessionTimers.running = !0, clearTimeout( this._sessionTimers.timer ), this._sessionTimers.refresher ? this._sessionTimers.timer = setTimeout( ( function () { e._status !== A.STATUS_TERMINATED && ( E( "runSessionTimer() | sending session refresh request" ), e._sessionTimers.refreshMethod === c.UPDATE ? e._sendUpdate() : e._sendReinvite() ) } ), 500 * t ) : this._sessionTimers.timer = setTimeout( ( function () { e._status !== A.STATUS_TERMINATED && ( S( "runSessionTimer() | timer expired, terminating the session" ), e.terminate( { cause: c.causes.REQUEST_TIMEOUT, status_code: 408, reason_phrase: "Session Timer Expired" } ) ) } ), 1100 * t ) } }, { key: "_toggleMuteAudio", value: function ( e ) { var t = this._connection.getSenders().filter( ( function ( e ) { return e.track && "audio" === e.track.kind } ) ), n = !0, r = !1, i = void 0; try { for ( var o, s = t[Symbol.iterator](); !( n = ( o = s.next() ).done ); n = !0 )o.value.track.enabled = !e } catch ( e ) { r = !0, i = e } finally { try { n || null == s.return || s.return() } finally { if ( r ) throw i } } } }, { key: "_toggleMuteVideo", value: function ( e ) { var t = this._connection.getSenders().filter( ( function ( e ) { return e.track && "video" === e.track.kind } ) ), n = !0, r = !1, i = void 0; try { for ( var o, s = t[Symbol.iterator](); !( n = ( o = s.next() ).done ); n = !0 )o.value.track.enabled = !e } catch ( e ) { r = !0, i = e } finally { try { n || null == s.return || s.return() } finally { if ( r ) throw i } } } }, { key: "_newRTCSession", value: function ( e, t ) { E( "newRTCSession()" ), this._ua.newRTCSession( this, { originator: e, session: this, request: t } ) } }, { key: "_connecting", value: function ( e ) { E( "session connecting" ), E( 'emit "connecting"' ), this.emit( "connecting", { request: e } ) } }, { key: "_progress", value: function ( e, t ) { E( "session progress" ), E( 'emit "progress"' ), this.emit( "progress", { originator: e, response: t || null } ) } }, { key: "_accepted", value: function ( e, t ) { E( "session accepted" ), this._start_time = new Date, E( 'emit "accepted"' ), this.emit( "accepted", { originator: e, response: t || null } ) } }, { key: "_confirmed", value: function ( e, t ) { E( "session confirmed" ), this._is_confirmed = !0, E( 'emit "confirmed"' ), this.emit( "confirmed", { originator: e, ack: t || null } ) } }, { key: "_ended", value: function ( e, t, n ) { E( "session ended" ), this._end_time = new Date, this._close(), E( 'emit "ended"' ), this.emit( "ended", { originator: e, message: t || null, cause: n } ) } }, { key: "_failed", value: function ( e, t, n ) { E( "session failed" ), E( 'emit "_failed"' ), this.emit( "_failed", { originator: e, message: t || null, cause: n } ), this._close(), E( 'emit "failed"' ), this.emit( "failed", { originator: e, message: t || null, cause: n } ) } }, { key: "_onhold", value: function ( e ) { E( "session onhold" ), this._setLocalMediaStatus(), E( 'emit "hold"' ), this.emit( "hold", { originator: e } ) } }, { key: "_onunhold", value: function ( e ) { E( "session onunhold" ), this._setLocalMediaStatus(), E( 'emit "unhold"' ), this.emit( "unhold", { originator: e } ) } }, { key: "_onmute", value: function ( e ) { var t = e.audio, n = e.video; E( "session onmute" ), this._setLocalMediaStatus(), E( 'emit "muted"' ), this.emit( "muted", { audio: t, video: n } ) } }, { key: "_onunmute", value: function ( e ) { var t = e.audio, n = e.video; E( "session onunmute" ), this._setLocalMediaStatus(), E( 'emit "unmuted"' ), this.emit( "unmuted", { audio: t, video: n } ) } }, { key: "C", get: function () { return A } }, { key: "causes", get: function () { return c.causes } }, { key: "id", get: function () { return this._id } }, { key: "connection", get: function () { return this._connection } }, { key: "contact", get: function () { return this._contact } }, { key: "direction", get: function () { return this._direction } }, { key: "local_identity", get: function () { return this._local_identity } }, { key: "remote_identity", get: function () { return this._remote_identity } }, { key: "start_time", get: function () { return this._start_time } }, { key: "end_time", get: function () { return this._end_time } }, { key: "data", get: function () { return this._data }, set: function ( e ) { this._data = e } }, { key: "status", get: function () { return this._status } }] ), t }() }, { "./Constants": 2, "./Dialog": 3, "./Exceptions": 6, "./RTCSession/DTMF": 13, "./RTCSession/Info": 14, "./RTCSession/ReferNotifier": 15, "./RTCSession/ReferSubscriber": 16, "./RequestSender": 18, "./SIPMessage": 19, "./Timers": 21, "./Transactions": 22, "./URI": 25, "./Utils": 26, debug: 30, events: 29, "sdp-transform": 35 }], 13: [function ( e, t, n ) { "use strict"; function r ( e ) { return ( r = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function ( e ) { return typeof e } : function ( e ) { return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e } )( e ) } function i ( e, t ) { for ( var n = 0; n < t.length; n++ ) { var r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && ( r.writable = !0 ), Object.defineProperty( e, r.key, r ) } } function o ( e, t ) { return !t || "object" !== r( t ) && "function" != typeof t ? function ( e ) { if ( void 0 === e ) throw new ReferenceError( "this hasn't been initialised - super() hasn't been called" ); return e }( e ) : t } function s ( e ) { return ( s = Object.setPrototypeOf ? Object.getPrototypeOf : function ( e ) { return e.__proto__ || Object.getPrototypeOf( e ) } )( e ) } function u ( e, t ) { return ( u = Object.setPrototypeOf || function ( e, t ) { return e.__proto__ = t, e } )( e, t ) } var l = e( "events" ).EventEmitter, a = e( "../Constants" ), c = e( "../Exceptions" ), f = e( "../Utils" ), h = e( "debug" )( "PIOPIY:RTCSession:DTMF" ); e( "debug" )( "PIOPIY:ERROR:RTCSession:DTMF" ).log = console.warn.bind( console ); var d = { MIN_DURATION: 70, MAX_DURATION: 6e3, DEFAULT_DURATION: 100, MIN_INTER_TONE_GAP: 50, DEFAULT_INTER_TONE_GAP: 500 }; t.exports = function ( e ) { function t ( e ) { var n; return function ( e, t ) { if ( !( e instanceof t ) ) throw new TypeError( "Cannot call a class as a function" ) }( this, t ), ( n = o( this, s( t ).call( this ) ) )._session = e, n._direction = null, n._tone = null, n._duration = null, n._request = null, n } var n, r; return function ( e, t ) { if ( "function" != typeof t && null !== t ) throw new TypeError( "Super expression must either be null or a function" ); e.prototype = Object.create( t && t.prototype, { constructor: { value: e, writable: !0, configurable: !0 } } ), t && u( e, t ) }( t, l ), n = t, ( r = [{ key: "send", value: function ( e ) { var t = this, n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}; if ( void 0 === e ) throw new TypeError( "Not enough arguments" ); if ( this._direction = "outgoing", this._session.status !== this._session.C.STATUS_CONFIRMED && this._session.status !== this._session.C.STATUS_WAITING_FOR_ACK ) throw new c.InvalidStateError( this._session.status ); var r = f.cloneArray( n.extraHeaders ); if ( this.eventHandlers = n.eventHandlers || {}, "string" == typeof e ) e = e.toUpperCase(); else { if ( "number" != typeof e ) throw new TypeError( "Invalid tone: ".concat( e ) ); e = e.toString() } if ( !e.match( /^[0-9A-DR#*]$/ ) ) throw new TypeError( "Invalid tone: ".concat( e ) ); this._tone = e, this._duration = n.duration, r.push( "Content-Type: application/dtmf-relay" ); var i = "Signal=".concat( this._tone, "\r\n" ); i += "Duration=".concat( this._duration ), this._session.newDTMF( { originator: "local", dtmf: this, request: this._request } ), this._session.sendRequest( a.INFO, { extraHeaders: r, eventHandlers: { onSuccessResponse: function ( e ) { t.emit( "succeeded", { originator: "remote", response: e } ) }, onErrorResponse: function ( e ) { t.eventHandlers.onFailed && t.eventHandlers.onFailed(), t.emit( "failed", { originator: "remote", response: e } ) }, onRequestTimeout: function () { t._session.onRequestTimeout() }, onTransportError: function () { t._session.onTransportError() }, onDialogError: function () { t._session.onDialogError() } }, body: i } ) } }, { key: "init_incoming", value: function ( e ) { var t = /^(Signal\s*?=\s*?)([0-9A-D#*]{1})(\s)?.*/, n = /^(Duration\s?=\s?)([0-9]{1,4})(\s)?.*/; if ( this._direction = "incoming", this._request = e, e.reply( 200 ), e.body ) { var r = e.body.split( "\n" ); r.length >= 1 && t.test( r[0] ) && ( this._tone = r[0].replace( t, "$2" ) ), r.length >= 2 && n.test( r[1] ) && ( this._duration = parseInt( r[1].replace( n, "$2" ), 10 ) ) } this._duration || ( this._duration = d.DEFAULT_DURATION ), this._tone ? this._session.newDTMF( { originator: "remote", dtmf: this, request: e } ) : h( "invalid INFO DTMF received, discarded" ) } }, { key: "tone", get: function () { return this._tone } }, { key: "duration", get: function () { return this._duration } }] ) && i( n.prototype, r ), t }(), t.exports.C = d }, { "../Constants": 2, "../Exceptions": 6, "../Utils": 26, debug: 30, events: 29 }], 14: [function ( e, t, n ) { "use strict"; function r ( e ) { return ( r = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function ( e ) { return typeof e } : function ( e ) { return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e } )( e ) } function i ( e, t ) { for ( var n = 0; n < t.length; n++ ) { var r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && ( r.writable = !0 ), Object.defineProperty( e, r.key, r ) } } function o ( e, t ) { return !t || "object" !== r( t ) && "function" != typeof t ? function ( e ) { if ( void 0 === e ) throw new ReferenceError( "this hasn't been initialised - super() hasn't been called" ); return e }( e ) : t } function s ( e ) { return ( s = Object.setPrototypeOf ? Object.getPrototypeOf : function ( e ) { return e.__proto__ || Object.getPrototypeOf( e ) } )( e ) } function u ( e, t ) { return ( u = Object.setPrototypeOf || function ( e, t ) { return e.__proto__ = t, e } )( e, t ) } var l = e( "events" ).EventEmitter; e( "debug" )( "PIOPIY:ERROR:RTCSession:Info" ).log = console.warn.bind( console ); var a = e( "../Constants" ), c = e( "../Exceptions" ), f = e( "../Utils" ); t.exports = function ( e ) { function t ( e ) { var n; return function ( e, t ) { if ( !( e instanceof t ) ) throw new TypeError( "Cannot call a class as a function" ) }( this, t ), ( n = o( this, s( t ).call( this ) ) )._session = e, n._direction = null, n._contentType = null, n._body = null, n } var n, r; return function ( e, t ) { if ( "function" != typeof t && null !== t ) throw new TypeError( "Super expression must either be null or a function" ); e.prototype = Object.create( t && t.prototype, { constructor: { value: e, writable: !0, configurable: !0 } } ), t && u( e, t ) }( t, l ), n = t, ( r = [{ key: "send", value: function ( e, t ) { var n = this, r = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {}; if ( this._direction = "outgoing", void 0 === e ) throw new TypeError( "Not enough arguments" ); if ( this._session.status !== this._session.C.STATUS_CONFIRMED && this._session.status !== this._session.C.STATUS_WAITING_FOR_ACK ) throw new c.InvalidStateError( this._session.status ); this._contentType = e, this._body = t; var i = f.cloneArray( r.extraHeaders ); i.push( "Content-Type: ".concat( e ) ), this._session.newInfo( { originator: "local", info: this, request: this.request } ), this._session.sendRequest( a.INFO, { extraHeaders: i, eventHandlers: { onSuccessResponse: function ( e ) { n.emit( "succeeded", { originator: "remote", response: e } ) }, onErrorResponse: function ( e ) { n.emit( "failed", { originator: "remote", response: e } ) }, onTransportError: function () { n._session.onTransportError() }, onRequestTimeout: function () { n._session.onRequestTimeout() }, onDialogError: function () { n._session.onDialogError() } }, body: t } ) } }, { key: "init_incoming", value: function ( e ) { this._direction = "incoming", this.request = e, e.reply( 200 ), this._contentType = e.getHeader( "content-type" ), this._body = e.body, this._session.newInfo( { originator: "remote", info: this, request: e } ) } }, { key: "contentType", get: function () { return this._contentType } }, { key: "body", get: function () { return this._body } }] ) && i( n.prototype, r ), t }() }, { "../Constants": 2, "../Exceptions": 6, "../Utils": 26, debug: 30, events: 29 }], 15: [function ( e, t, n ) { "use strict"; function r ( e, t ) { for ( var n = 0; n < t.length; n++ ) { var r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && ( r.writable = !0 ), Object.defineProperty( e, r.key, r ) } } var i = e( "../Constants" ), o = e( "debug" )( "PIOPIY:RTCSession:ReferNotifier" ), s = "refer", u = "message/sipfrag;version=2.0", l = 300; t.exports = function () { function e ( t, n, r ) { !function ( e, t ) { if ( !( e instanceof t ) ) throw new TypeError( "Cannot call a class as a function" ) }( this, e ), this._session = t, this._id = n, this._expires = r || l, this._active = !0, this.notify( 100 ) } var t, n; return t = e, ( n = [{ key: "notify", value: function ( e, t ) { var n; o( "notify()" ), !1 !== this._active && ( t = t || i.REASON_PHRASE[e] || "", n = e >= 200 ? "terminated;reason=noresource" : "active;expires=".concat( this._expires ), this._session.sendRequest( i.NOTIFY, { extraHeaders: ["Event: ".concat( s, ";id=" ).concat( this._id ), "Subscription-State: ".concat( n ), "Content-Type: ".concat( u )], body: "SIP/2.0 ".concat( e, " " ).concat( t ), eventHandlers: { onErrorResponse: function () { this._active = !1 } } } ) ) } }] ) && r( t.prototype, n ), e }() }, { "../Constants": 2, debug: 30 }], 16: [function ( e, t, n ) { "use strict"; function r ( e ) { return ( r = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function ( e ) { return typeof e } : function ( e ) { return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e } )( e ) } function i ( e, t ) { for ( var n = 0; n < t.length; n++ ) { var r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && ( r.writable = !0 ), Object.defineProperty( e, r.key, r ) } } function o ( e, t ) { return !t || "object" !== r( t ) && "function" != typeof t ? function ( e ) { if ( void 0 === e ) throw new ReferenceError( "this hasn't been initialised - super() hasn't been called" ); return e }( e ) : t } function s ( e ) { return ( s = Object.setPrototypeOf ? Object.getPrototypeOf : function ( e ) { return e.__proto__ || Object.getPrototypeOf( e ) } )( e ) } function u ( e, t ) { return ( u = Object.setPrototypeOf || function ( e, t ) { return e.__proto__ = t, e } )( e, t ) } var l = e( "events" ).EventEmitter, a = e( "../Constants" ), c = e( "../Grammar" ), f = e( "../Utils" ), h = e( "debug" )( "PIOPIY:RTCSession:ReferSubscriber" ); t.exports = function ( e ) { function t ( e ) { var n; return function ( e, t ) { if ( !( e instanceof t ) ) throw new TypeError( "Cannot call a class as a function" ) }( this, t ), ( n = o( this, s( t ).call( this ) ) )._id = null, n._session = e, n } var n, r; return function ( e, t ) { if ( "function" != typeof t && null !== t ) throw new TypeError( "Super expression must either be null or a function" ); e.prototype = Object.create( t && t.prototype, { constructor: { value: e, writable: !0, configurable: !0 } } ), t && u( e, t ) }( t, l ), n = t, ( r = [{ key: "sendRefer", value: function ( e ) { var t = this, n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}; h( "sendRefer()" ); var r = f.cloneArray( n.extraHeaders ), i = n.eventHandlers || {}; for ( var o in i ) Object.prototype.hasOwnProperty.call( i, o ) && this.on( o, i[o] ); var s = null; n.replaces && ( s = n.replaces._request.call_id, s += ";to-tag=".concat( n.replaces._to_tag ), s += ";from-tag=".concat( n.replaces._from_tag ), s = encodeURIComponent( s ) ); var u = "Refer-To: <".concat( e ).concat( s ? "?Replaces=".concat( s ) : "", ">" ); r.push( u ); var l = "Referred-By: <".concat( this._session._ua._configuration.uri._scheme, ":" ).concat( this._session._ua._configuration.uri._user, "@" ).concat( this._session._ua._configuration.uri._host, ">" ); r.push( l ), r.push( "Contact: ".concat( this._session.contact ) ); var c = this._session.sendRequest( a.REFER, { extraHeaders: r, eventHandlers: { onSuccessResponse: function ( e ) { t._requestSucceeded( e ) }, onErrorResponse: function ( e ) { t._requestFailed( e, a.causes.REJECTED ) }, onTransportError: function () { t._requestFailed( null, a.causes.CONNECTION_ERROR ) }, onRequestTimeout: function () { t._requestFailed( null, a.causes.REQUEST_TIMEOUT ) }, onDialogError: function () { t._requestFailed( null, a.causes.DIALOG_ERROR ) } } } ); this._id = c.cseq } }, { key: "receiveNotify", value: function ( e ) { if ( h( "receiveNotify()" ), e.body ) { var t = c.parse( e.body.trim(), "Status_Line" ); if ( -1 !== t ) switch ( !0 ) { case /^100$/.test( t.status_code ): this.emit( "trying", { request: e, status_line: t } ); break; case /^1[0-9]{2}$/.test( t.status_code ): this.emit( "progress", { request: e, status_line: t } ); break; case /^2[0-9]{2}$/.test( t.status_code ): this.emit( "accepted", { request: e, status_line: t } ); break; default: this.emit( "failed", { request: e, status_line: t } ) } else h( 'receiveNotify() | error parsing NOTIFY body: "'.concat( e.body, '"' ) ) } } }, { key: "_requestSucceeded", value: function ( e ) { h( "REFER succeeded" ), h( 'emit "requestSucceeded"' ), this.emit( "requestSucceeded", { response: e } ) } }, { key: "_requestFailed", value: function ( e, t ) { h( "REFER failed" ), h( 'emit "requestFailed"' ), this.emit( "requestFailed", { response: e || null, cause: t } ) } }, { key: "id", get: function () { return this._id } }] ) && i( n.prototype, r ), t }() }, { "../Constants": 2, "../Grammar": 7, "../Utils": 26, debug: 30, events: 29 }], 17: [function ( e, t, n ) { "use strict"; function r ( e, t ) { for ( var n = 0; n < t.length; n++ ) { var r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && ( r.writable = !0 ), Object.defineProperty( e, r.key, r ) } } var i = e( "./Utils" ), o = e( "./Constants" ), s = e( "./SIPMessage" ), u = e( "./RequestSender" ), l = e( "debug" )( "PIOPIY:Registrator" ); t.exports = function () { function e ( t, n ) { !function ( e, t ) { if ( !( e instanceof t ) ) throw new TypeError( "Cannot call a class as a function" ) }( this, e ), this._ua = t, this._transport = n, this._registrar = t.configuration.registrar_server, this._expires = t.configuration.register_expires, this._call_id = i.createRandomToken( 22 ), this._cseq = 0, this._to_uri = t.configuration.uri, this._registrationTimer = null, this._registering = !1, this._registered = !1, this._contact = this._ua.contact.toString(), this._contact += ";+sip.ice", this._extraHeaders = [], this._extraContactParams = "", this._contact += ";reg-id=".concat( 1 ), this._contact += ';+sip.instance="<urn:uuid:'.concat( this._ua.configuration.instance_id, '>"' ) } var t, n; return t = e, ( n = [{ key: "setExtraHeaders", value: function ( e ) { Array.isArray( e ) || ( e = [] ), this._extraHeaders = e.slice() } }, { key: "setExtraContactParams", value: function ( e ) { for ( var t in e instanceof Object || ( e = {} ), this._extraContactParams = "", e ) if ( Object.prototype.hasOwnProperty.call( e, t ) ) { var n = e[t]; this._extraContactParams += ";".concat( t ), n && ( this._extraContactParams += "=".concat( n ) ) } } }, { key: "register", value: function () { var e = this; if ( this._registering ) l( "Register request in progress..." ); else { var t = this._extraHeaders.slice(); t.push( "Contact: ".concat( this._contact, ";expires=" ).concat( this._expires ).concat( this._extraContactParams ) ), t.push( "Expires: ".concat( this._expires ) ); var n = new s.OutgoingRequest( o.REGISTER, this._registrar, this._ua, { to_uri: this._to_uri, call_id: this._call_id, cseq: this._cseq += 1 }, t ), r = new u( this._ua, n, { onRequestTimeout: function () { e._registrationFailure( null, o.causes.REQUEST_TIMEOUT ) }, onTransportError: function () { e._registrationFailure( null, o.causes.CONNECTION_ERROR ) }, onAuthenticated: function () { e._cseq += 1 }, onReceiveResponse: function ( t ) { if ( t.cseq === e._cseq ) switch ( null !== e._registrationTimer && ( clearTimeout( e._registrationTimer ), e._registrationTimer = null ), !0 ) { case /^1[0-9]{2}$/.test( t.status_code ): break; case /^2[0-9]{2}$/.test( t.status_code ): if ( e._registering = !1, !t.hasHeader( "Contact" ) ) { l( "no Contact header in response to REGISTER, response ignored" ); break } var n = t.headers.Contact.reduce( ( function ( e, t ) { return e.concat( t.parsed ) } ), [] ).find( ( function ( t ) { return t.uri.user === e._ua.contact.uri.user } ) ); if ( !n ) { l( "no Contact header pointing to us, response ignored" ); break } var r = n.getParam( "expires" ); !r && t.hasHeader( "expires" ) && ( r = t.getHeader( "expires" ) ), r || ( r = e._expires ), ( r = Number( r ) ) < 10 && ( r = 10 ), e._registrationTimer = setTimeout( ( function () { e._registrationTimer = null, 0 === e._ua.listeners( "registrationExpiring" ).length ? e.register() : e._ua.emit( "registrationExpiring" ) } ), 1e3 * r - 5e3 ), n.hasParam( "temp-gruu" ) && ( e._ua.contact.temp_gruu = n.getParam( "temp-gruu" ).replace( /"/g, "" ) ), n.hasParam( "pub-gruu" ) && ( e._ua.contact.pub_gruu = n.getParam( "pub-gruu" ).replace( /"/g, "" ) ), e._registered || ( e._registered = !0, e._ua.registered( { response: t } ) ); break; case /^423$/.test( t.status_code ): t.hasHeader( "min-expires" ) ? ( e._expires = Number( t.getHeader( "min-expires" ) ), e._expires < 10 && ( e._expires = 10 ), e.register() ) : ( l( "423 response received for REGISTER without Min-Expires" ), e._registrationFailure( t, o.causes.SIP_FAILURE_CODE ) ); break; default: var s = i.sipErrorCause( t.status_code ); e._registrationFailure( t, s ) } } } ); this._registering = !0, r.send() } } }, { key: "unregister", value: function () { var e = this, t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}; if ( this._registered ) { this._registered = !1, null !== this._registrationTimer && ( clearTimeout( this._registrationTimer ), this._registrationTimer = null ); var n = this._extraHeaders.slice(); t.all ? n.push( "Contact: *".concat( this._extraContactParams ) ) : n.push( "Contact: ".concat( this._contact, ";expires=0" ).concat( this._extraContactParams ) ), n.push( "Expires: 0" ); var r = new s.OutgoingRequest( o.REGISTER, this._registrar, this._ua, { to_uri: this._to_uri, call_id: this._call_id, cseq: this._cseq += 1 }, n ); new u( this._ua, r, { onRequestTimeout: function () { e._unregistered( null, o.causes.REQUEST_TIMEOUT ) }, onTransportError: function () { e._unregistered( null, o.causes.CONNECTION_ERROR ) }, onAuthenticated: function () { e._cseq += 1 }, onReceiveResponse: function ( t ) { switch ( !0 ) { case /^1[0-9]{2}$/.test( t.status_code ): break; case /^2[0-9]{2}$/.test( t.status_code ): e._unregistered( t ); break; default: var n = i.sipErrorCause( t.status_code ); e._unregistered( t, n ) } } } ).send() } else l( "already unregistered" ) } }, { key: "close", value: function () { this._registered && this.unregister() } }, { key: "onTransportClosed", value: function () { this._registering = !1, null !== this._registrationTimer && ( clearTimeout( this._registrationTimer ), this._registrationTimer = null ), this._registered && ( this._registered = !1, this._ua.unregistered( {} ) ) } }, { key: "_registrationFailure", value: function ( e, t ) { this._registering = !1, this._ua.registrationFailed( { response: e || null, cause: t } ), this._registered && ( this._registered = !1, this._ua.unregistered( { response: e || null, cause: t } ) ) } }, { key: "_unregistered", value: function ( e, t ) { this._registering = !1, this._registered = !1, this._ua.unregistered( { response: e || null, cause: t || null } ) } }, { key: "registered", get: function () { return this._registered } }] ) && r( t.prototype, n ), e }() }, { "./Constants": 2, "./RequestSender": 18, "./SIPMessage": 19, "./Utils": 26, debug: 30 }], 18: [function ( e, t, n ) { "use strict"; function r ( e, t ) { for ( var n = 0; n < t.length; n++ ) { var r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && ( r.writable = !0 ), Object.defineProperty( e, r.key, r ) } } var i = e( "./Constants" ), o = e( "./DigestAuthentication" ), s = e( "./Transactions" ), u = e( "debug" )( "PIOPIY:RequestSender" ), l = { onRequestTimeout: function () { }, onTransportError: function () { }, onReceiveResponse: function () { }, onAuthenticated: function () { } }; t.exports = function () { function e ( t, n, r ) { for ( var o in function ( e, t ) { if ( !( e instanceof t ) ) throw new TypeError( "Cannot call a class as a function" ) }( this, e ), this._ua = t, this._eventHandlers = r, this._method = n.method, this._request = n, this._auth = null, this._challenged = !1, this._staled = !1, l ) Object.prototype.hasOwnProperty.call( l, o ) && ( this._eventHandlers[o] || ( this._eventHandlers[o] = l[o] ) ); t.status !== t.C.STATUS_USER_CLOSED || this._method === i.BYE && this._method === i.ACK || this._eventHandlers.onTransportError() } var t, n; return t = e, ( n = [{ key: "send", value: function () { var e = this, t = { onRequestTimeout: function () { e._eventHandlers.onRequestTimeout() }, onTransportError: function () { e._eventHandlers.onTransportError() }, onReceiveResponse: function ( t ) { e._receiveResponse( t ) } }; switch ( this._method ) { case "INVITE": this.clientTransaction = new s.InviteClientTransaction( this._ua, this._ua.transport, this._request, t ); break; case "ACK": this.clientTransaction = new s.AckClientTransaction( this._ua, this._ua.transport, this._request, t ); break; default: this.clientTransaction = new s.NonInviteClientTransaction( this._ua, this._ua.transport, this._request, t ) }this.clientTransaction.send() } }, { key: "_receiveResponse", value: function ( e ) { var t, n, r = e.status_code; if ( 401 !== r && 407 !== r || null === this._ua.configuration.password && null === this._ua.configuration.ha1 ) this._eventHandlers.onReceiveResponse( e ); else { if ( 401 === e.status_code ? ( t = e.parseHeader( "www-authenticate" ), n = "authorization" ) : ( t = e.parseHeader( "proxy-authenticate" ), n = "proxy-authorization" ), !t ) return u( "".concat( e.status_code, " with wrong or missing challenge, cannot authenticate" ) ), void this._eventHandlers.onReceiveResponse( e ); if ( !this._challenged || !this._staled && !0 === t.stale ) { if ( this._auth || ( this._auth = new o( { username: this._ua.configuration.authorization_user, password: this._ua.configuration.password, realm: this._ua.configuration.realm, ha1: this._ua.configuration.ha1 } ) ), !this._auth.authenticate( this._request, t ) ) return void this._eventHandlers.onReceiveResponse( e ); this._challenged = !0, this._ua.set( "realm", this._auth.get( "realm" ) ), this._ua.set( "ha1", this._auth.get( "ha1" ) ), t.stale && ( this._staled = !0 ), this._request = this._request.clone(), this._request.cseq += 1, this._request.setHeader( "cseq", "".concat( this._request.cseq, " " ).concat( this._method ) ), this._request.setHeader( n, this._auth.toString() ), this._eventHandlers.onAuthenticated( this._request ), this.send() } else this._eventHandlers.onReceiveResponse( e ) } } }] ) && r( t.prototype, n ), e }() }, { "./Constants": 2, "./DigestAuthentication": 5, "./Transactions": 22, debug: 30 }], 19: [function ( e, t, n ) { "use strict"; function r ( e ) { return ( r = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function ( e ) { return typeof e } : function ( e ) { return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e } )( e ) } function i ( e, t ) { return !t || "object" !== r( t ) && "function" != typeof t ? function ( e ) { if ( void 0 === e ) throw new ReferenceError( "this hasn't been initialised - super() hasn't been called" ); return e }( e ) : t } function o ( e ) { return ( o = Object.setPrototypeOf ? Object.getPrototypeOf : function ( e ) { return e.__proto__ || Object.getPrototypeOf( e ) } )( e ) } function s ( e, t ) { if ( "function" != typeof t && null !== t ) throw new TypeError( "Super expression must either be null or a function" ); e.prototype = Object.create( t && t.prototype, { constructor: { value: e, writable: !0, configurable: !0 } } ), t && function ( e, t ) { ( Object.setPrototypeOf || function ( e, t ) { return e.__proto__ = t, e } )( e, t ) }( e, t ) } function u ( e, t ) { if ( !( e instanceof t ) ) throw new TypeError( "Cannot call a class as a function" ) } function l ( e, t ) { for ( var n = 0; n < t.length; n++ ) { var r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && ( r.writable = !0 ), Object.defineProperty( e, r.key, r ) } } function a ( e, t, n ) { return t && l( e.prototype, t ), n && l( e, n ), e } var c = e( "sdp-transform" ), f = e( "./Constants" ), h = e( "./Utils" ), d = e( "./NameAddrHeader" ), _ = e( "./Grammar" ), p = e( "debug" )( "PIOPY:SIPMessage" ), v = function () { function e ( t, n, r, i, o, s ) { if ( u( this, e ), !t || !n || !r ) return null; i = i || {}, this.ua = r, this.headers = {}, this.method = t, this.ruri = n, this.body = s, this.extraHeaders = h.cloneArray( o ), i.route_set ? this.setHeader( "route", i.route_set ) : r.configuration.use_preloaded_route && this.setHeader( "route", "<".concat( r.transport.sip_uri, ";lr>" ) ), this.setHeader( "via", "" ), this.setHeader( "max-forwards", f.MAX_FORWARDS ); var l = i.to_uri || n, a = i.to_tag ? { tag: i.to_tag } : null, c = void 0 !== i.to_display_name ? i.to_display_name : null; this.to = new d( l, c, a ), this.setHeader( "to", this.to.toString() ); var _, p = i.from_uri || r.configuration.uri, v = { tag: i.from_tag || h.newTag() }; _ = void 0 !== i.from_display_name ? i.from_display_name : r.configuration.display_name ? r.configuration.display_name : null, this.from = new d( p, _, v ), this.setHeader( "from", this.from.toString() ); var m = i.call_id || r.configuration.jssip_id + h.createRandomToken( 15 ); this.call_id = m, this.setHeader( "call-id", m ); var g = i.cseq || Math.floor( 1e4 * Math.random() ); this.cseq = g, this.setHeader( "cseq", "".concat( g, " " ).concat( t ) ) } return a( e, [{ key: "setHeader", value: function ( e, t ) { for ( var n = new RegExp( "^\\s*".concat( e, "\\s*:" ), "i" ), r = 0; r < this.extraHeaders.length; r++ )n.test( this.extraHeaders[r] ) && this.extraHeaders.splice( r, 1 ); this.headers[h.headerize( e )] = Array.isArray( t ) ? t : [t] } }, { key: "getHeader", value: function ( e ) { var t = this.headers[h.headerize( e )]; if ( t ) { if ( t[0] ) return t[0] } else { var n = new RegExp( "^\\s*".concat( e, "\\s*:" ), "i" ), r = !0, i = !1, o = void 0; try { for ( var s, u = this.extraHeaders[Symbol.iterator](); !( r = ( s = u.next() ).done ); r = !0 ) { var l = s.value; if ( n.test( l ) ) return l.substring( l.indexOf( ":" ) + 1 ).trim() } } catch ( e ) { i = !0, o = e } finally { try { r || null == u.return || u.return() } finally { if ( i ) throw o } } } } }, { key: "getHeaders", value: function ( e ) { var t = this.headers[h.headerize( e )], n = []; if ( t ) { var r = !0, i = !1, o = void 0; try { for ( var s, u = t[Symbol.iterator](); !( r = ( s = u.next() ).done ); r = !0 ) { var l = s.value; n.push( l ) } } catch ( e ) { i = !0, o = e } finally { try { r || null == u.return || u.return() } finally { if ( i ) throw o } } return n } var a = new RegExp( "^\\s*".concat( e, "\\s*:" ), "i" ), c = !0, f = !1, d = void 0; try { for ( var _, p = this.extraHeaders[Symbol.iterator](); !( c = ( _ = p.next() ).done ); c = !0 ) { var v = _.value; a.test( v ) && n.push( v.substring( v.indexOf( ":" ) + 1 ).trim() ) } } catch ( e ) { f = !0, d = e } finally { try { c || null == p.return || p.return() } finally { if ( f ) throw d } } return n } }, { key: "hasHeader", value: function ( e ) { if ( this.headers[h.headerize( e )] ) return !0; var t = new RegExp( "^\\s*".concat( e, "\\s*:" ), "i" ), n = !0, r = !1, i = void 0; try { for ( var o, s = this.extraHeaders[Symbol.iterator](); !( n = ( o = s.next() ).done ); n = !0 ) { var u = o.value; if ( t.test( u ) ) return !0 } } catch ( e ) { r = !0, i = e } finally { try { n || null == s.return || s.return() } finally { if ( r ) throw i } } return !1 } }, { key: "parseSDP", value: function ( e ) { return !e && this.sdp || ( this.sdp = c.parse( this.body || "" ) ), this.sdp } }, { key: "toString", value: function () { var e = "".concat( this.method, " " ).concat( this.ruri, " SIP/2.0\r\n" ); for ( var t in this.headers ) if ( Object.prototype.hasOwnProperty.call( this.headers, t ) ) { var n = !0, r = !1, i = void 0; try { for ( var o, s = this.headers[t][Symbol.iterator](); !( n = ( o = s.next() ).done ); n = !0 ) { var u = o.value; e += "".concat( t, ": " ).concat( u, "\r\n" ) } } catch ( e ) { r = !0, i = e } finally { try { n || null == s.return || s.return() } finally { if ( r ) throw i } } } var l = !0, a = !1, c = void 0; try { for ( var d, _ = this.extraHeaders[Symbol.iterator](); !( l = ( d = _.next() ).done ); l = !0 ) { var p = d.value; e += "".concat( p.trim(), "\r\n" ) } } catch ( e ) { a = !0, c = e } finally { try { l || null == _.return || _.return() } finally { if ( a ) throw c } } var v = []; switch ( this.method ) { case f.REGISTER: v.push( "path", "gruu" ); break; case f.INVITE: this.ua.configuration.session_timers && v.push( "timer" ), ( this.ua.contact.pub_gruu || this.ua.contact.temp_gruu ) && v.push( "gruu" ), v.push( "ice", "replaces" ); break; case f.UPDATE: this.ua.configuration.session_timers && v.push( "timer" ), v.push( "ice" ) }v.push( "outbound" ); var m = this.ua.configuration.user_agent || f.USER_AGENT; if ( e += "Allow: ".concat( f.ALLOWED_METHODS, "\r\n" ), e += "Supported: ".concat( v, "\r\n" ), e += "User-Agent: ".concat( m, "\r\n" ), this.body ) { var g = h.str_utf8_length( this.body ); e += "Content-Length: ".concat( g, "\r\n\r\n" ), e += this.body } else e += "Content-Length: 0\r\n\r\n"; return e } }, { key: "clone", value: function () { var t = new e( this.method, this.ruri, this.ua ); return Object.keys( this.headers ).forEach( ( function ( e ) { t.headers[e] = this.headers[e].slice() } ), this ), t.body = this.body, t.extraHeaders = h.cloneArray( this.extraHeaders ), t.to = this.to, t.from = this.from, t.call_id = this.call_id, t.cseq = this.cseq, t } }] ), e }(), m = function ( e ) { function t ( e, n, r, s, l ) { var a; return u( this, t ), ( a = i( this, o( t ).call( this, f.INVITE, e, n, r, s, l ) ) ).transaction = null, a } return s( t, v ), a( t, [{ key: "cancel", value: function ( e ) { this.transaction.cancel( e ) } }, { key: "clone", value: function () { var e = new t( this.ruri, this.ua ); return Object.keys( this.headers ).forEach( ( function ( t ) { e.headers[t] = this.headers[t].slice() } ), this ), e.body = this.body, e.extraHeaders = h.cloneArray( this.extraHeaders ), e.to = this.to, e.from = this.from, e.call_id = this.call_id, e.cseq = this.cseq, e.transaction = this.transaction, e } }] ), t }(), g = function () { function e () { u( this, e ), this.data = null, this.headers = null, this.method = null, this.via = null, this.via_branch = null, this.call_id = null, this.cseq = null, this.from = null, this.from_tag = null, this.to = null, this.to_tag = null, this.body = null, this.sdp = null } return a( e, [{ key: "addHeader", value: function ( e, t ) { var n = { raw: t }; e = h.headerize( e ), this.headers[e] ? this.headers[e].push( n ) : this.headers[e] = [n] } }, { key: "getHeader", value: function ( e ) { var t = this.headers[h.headerize( e )]; if ( t ) return t[0] ? t[0].raw : void 0 } }, { key: "getHeaders", value: function ( e ) { var t = this.headers[h.headerize( e )], n = []; if ( !t ) return []; var r = !0, i = !1, o = void 0; try { for ( var s, u = t[Symbol.iterator](); !( r = ( s = u.next() ).done ); r = !0 ) { var l = s.value; n.push( l.raw ) } } catch ( e ) { i = !0, o = e } finally { try { r || null == u.return || u.return() } finally { if ( i ) throw o } } return n } }, { key: "hasHeader", value: function ( e ) { return !!this.headers[h.headerize( e )] } }, { key: "parseHeader", value: function ( e ) { var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0; if ( e = h.headerize( e ), this.headers[e] ) { if ( !( t >= this.headers[e].length ) ) { var n = this.headers[e][t], r = n.raw; if ( n.parsed ) return n.parsed; var i = _.parse( r, e.replace( /-/g, "_" ) ); return -1 === i ? ( this.headers[e].splice( t, 1 ), void p( 'error parsing "'.concat( e, '" header field with value "' ).concat( r, '"' ) ) ) : ( n.parsed = i, i ) } p( 'not so many "'.concat( e, '" headers present' ) ) } else p( 'header "'.concat( e, '" not present' ) ) } }, { key: "s", value: function ( e, t ) { return this.parseHeader( e, t ) } }, { key: "setHeader", value: function ( e, t ) { var n = { raw: t }; this.headers[h.headerize( e )] = [n] } }, { key: "parseSDP", value: function ( e ) { return !e && this.sdp || ( this.sdp = c.parse( this.body || "" ) ), this.sdp } }, { key: "toString", value: function () { return this.data } }] ), e }(), y = function ( e ) { function t ( e ) { var n; return u( this, t ), ( n = i( this, o( t ).call( this ) ) ).ua = e, n.headers = {}, n.ruri = null, n.transport = null, n.server_transaction = null, n } return s( t, g ), a( t, [{ key: "reply", value: function ( e, t, n, r, i, o ) { var s = [], u = this.getHeader( "To" ); if ( t = t || null, !( e = e || null ) || e < 100 || e > 699 ) throw new TypeError( "Invalid status_code: ".concat( e ) ); if ( t && "string" != typeof t && !( t instanceof String ) ) throw new TypeError( "Invalid reason_phrase: ".concat( t ) ); t = t || f.REASON_PHRASE[e] || "", n = h.cloneArray( n ); var l = "SIP/2.0 ".concat( e, " " ).concat( t, "\r\n" ); if ( this.method === f.INVITE && e > 100 && e <= 200 ) { var a = this.getHeaders( "record-route" ), c = !0, d = !1, _ = void 0; try { for ( var p, v = a[Symbol.iterator](); !( c = ( p = v.next() ).done ); c = !0 ) { var m = p.value; l += "Record-Route: ".concat( m, "\r\n" ) } } catch ( e ) { d = !0, _ = e } finally { try { c || null == v.return || v.return() } finally { if ( d ) throw _ } } } var g = this.getHeaders( "via" ), y = !0, T = !1, C = void 0; try { for ( var b, E = g[Symbol.iterator](); !( y = ( b = E.next() ).done ); y = !0 ) { var S = b.value; l += "Via: ".concat( S, "\r\n" ) } } catch ( e ) { T = !0, C = e } finally { try { y || null == E.return || E.return() } finally { if ( T ) throw C } } !this.to_tag && e > 100 ? u += ";tag=".concat( h.newTag() ) : this.to_tag && !this.s( "to" ).hasParam( "tag" ) && ( u += ";tag=".concat( this.to_tag ) ), l += "To: ".concat( u, "\r\n" ), l += "From: ".concat( this.getHeader( "From" ), "\r\n" ), l += "Call-ID: ".concat( this.call_id, "\r\n" ), l += "CSeq: ".concat( this.cseq, " " ).concat( this.method, "\r\n" ); var A = !0, w = !1, R = void 0; try { for ( var I, O = n[Symbol.iterator](); !( A = ( I = O.next() ).done ); A = !0 ) { var k = I.value; l += "".concat( k.trim(), "\r\n" ) } } catch ( e ) { w = !0, R = e } finally { try { A || null == O.return || O.return() } finally { if ( w ) throw R } } switch ( this.method ) { case f.INVITE: this.ua.configuration.session_timers && s.push( "timer" ), ( this.ua.contact.pub_gruu || this.ua.contact.temp_gruu ) && s.push( "gruu" ), s.push( "ice", "replaces" ); break; case f.UPDATE: this.ua.configuration.session_timers && s.push( "timer" ), r && s.push( "ice" ), s.push( "replaces" ) }if ( s.push( "outbound" ), this.method === f.OPTIONS ? ( l += "Allow: ".concat( f.ALLOWED_METHODS, "\r\n" ), l += "Accept: ".concat( f.ACCEPTED_BODY_TYPES, "\r\n" ) ) : 405 === e ? l += "Allow: ".concat( f.ALLOWED_METHODS, "\r\n" ) : 415 === e && ( l += "Accept: ".concat( f.ACCEPTED_BODY_TYPES, "\r\n" ) ), l += "Supported: ".concat( s, "\r\n" ), r ) { var x = h.str_utf8_length( r ); l += "Content-Type: application/sdp\r\n", l += "Content-Length: ".concat( x, "\r\n\r\n" ), l += r } else l += "Content-Length: ".concat( 0, "\r\n\r\n" ); this.server_transaction.receiveResponse( e, l, i, o ) } }, { key: "reply_sl", value: function () { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : null, t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : null, n = this.getHeaders( "via" ); if ( !e || e < 100 || e > 699 ) throw new TypeError( "Invalid status_code: ".concat( e ) ); if ( t && "string" != typeof t && !( t instanceof String ) ) throw new TypeError( "Invalid reason_phrase: ".concat( t ) ); t = t || f.REASON_PHRASE[e] || ""; var r = "SIP/2.0 ".concat( e, " " ).concat( t, "\r\n" ), i = !0, o = !1, s = void 0; try { for ( var u, l = n[Symbol.iterator](); !( i = ( u = l.next() ).done ); i = !0 ) { var a = u.value; r += "Via: ".concat( a, "\r\n" ) } } catch ( e ) { o = !0, s = e } finally { try { i || null == l.return || l.return() } finally { if ( o ) throw s } } var c = this.getHeader( "To" ); !this.to_tag && e > 100 ? c += ";tag=".concat( h.newTag() ) : this.to_tag && !this.s( "to" ).hasParam( "tag" ) && ( c += ";tag=".concat( this.to_tag ) ), r += "To: ".concat( c, "\r\n" ), r += "From: ".concat( this.getHeader( "From" ), "\r\n" ), r += "Call-ID: ".concat( this.call_id, "\r\n" ), r += "CSeq: ".concat( this.cseq, " " ).concat( this.method, "\r\n" ), r += "Content-Length: ".concat( 0, "\r\n\r\n" ), this.transport.send( r ) } }] ), t }(), T = function ( e ) { function t () { var e; return u( this, t ), ( e = i( this, o( t ).call( this ) ) ).headers = {}, e.status_code = null, e.reason_phrase = null, e } return s( t, g ), t }(); t.exports = { OutgoingRequest: v, InitialOutgoingInviteRequest: m, IncomingRequest: y, IncomingResponse: T } }, { "./Constants": 2, "./Grammar": 7, "./NameAddrHeader": 10, "./Utils": 26, debug: 30, "sdp-transform": 35 }], 20: [function ( e, t, n ) { "use strict"; var r = e( "./Utils" ), i = e( "./Grammar" ), o = e( "debug" )( "PIOPIY:ERROR:Socket" ); o.log = console.warn.bind( console ), n.isSocket = function ( e ) { if ( Array.isArray( e ) ) return !1; if ( void 0 === e ) return o( "undefined JsSIP.Socket instance" ), !1; try { if ( !r.isString( e.url ) ) throw o( "missing or invalid JsSIP.Socket url property" ), new Error; if ( !r.isString( e.via_transport ) ) throw o( "missing or invalid JsSIP.Socket via_transport property" ), new Error; if ( -1 === i.parse( e.sip_uri, "SIP_URI" ) ) throw o( "missing or invalid JsSIP.Socket sip_uri property" ), new Error } catch ( e ) { return !1 } try { ["connect", "disconnect", "send"].forEach( ( function ( t ) { if ( !r.isFunction( e[t] ) ) throw o( "missing or invalid JsSIP.Socket method: ".concat( t ) ), new Error } ) ) } catch ( e ) { return !1 } return !0 } }, { "./Grammar": 7, "./Utils": 26, debug: 30 }], 21: [function ( e, t, n ) { "use strict"; t.exports = { T1: 500, T2: 4e3, T4: 5e3, TIMER_B: 32e3, TIMER_D: 0, TIMER_F: 32e3, TIMER_H: 32e3, TIMER_I: 0, TIMER_J: 0, TIMER_K: 0, TIMER_L: 32e3, TIMER_M: 32e3, PROVISIONAL_RESPONSE_INTERVAL: 6e4 } }, {}], 22: [function ( e, t, n ) { "use strict"; function r ( e ) { return ( r = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function ( e ) { return typeof e } : function ( e ) { return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e } )( e ) } function i ( e, t ) { if ( !( e instanceof t ) ) throw new TypeError( "Cannot call a class as a function" ) } function o ( e, t ) { for ( var n = 0; n < t.length; n++ ) { var r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && ( r.writable = !0 ), Object.defineProperty( e, r.key, r ) } } function s ( e, t, n ) { return t && o( e.prototype, t ), n && o( e, n ), e } function u ( e, t ) { return !t || "object" !== r( t ) && "function" != typeof t ? a( e ) : t } function l ( e ) { return ( l = Object.setPrototypeOf ? Object.getPrototypeOf : function ( e ) { return e.__proto__ || Object.getPrototypeOf( e ) } )( e ) } function a ( e ) { if ( void 0 === e ) throw new ReferenceError( "this hasn't been initialised - super() hasn't been called" ); return e } function c ( e, t ) { if ( "function" != typeof t && null !== t ) throw new TypeError( "Super expression must either be null or a function" ); e.prototype = Object.create( t && t.prototype, { constructor: { value: e, writable: !0, configurable: !0 } } ), t && function ( e, t ) { ( Object.setPrototypeOf || function ( e, t ) { return e.__proto__ = t, e } )( e, t ) }( e, t ) } var f = e( "events" ).EventEmitter, h = e( "./Constants" ), d = e( "./SIPMessage" ), _ = e( "./Timers" ), p = e( "debug" )( "PIOPIY:NonInviteClientTransaction" ), v = e( "debug" )( "PIOPIY:InviteClientTransaction" ), m = e( "debug" )( "PIOPIY:AckClientTransaction" ), g = e( "debug" )( "PIOPIY:NonInviteServerTransaction" ), y = e( "debug" )( "PIOPIY:InviteServerTransaction" ), T = { STATUS_TRYING: 1, STATUS_PROCEEDING: 2, STATUS_CALLING: 3, STATUS_ACCEPTED: 4, STATUS_COMPLETED: 5, STATUS_TERMINATED: 6, STATUS_CONFIRMED: 7, NON_INVITE_CLIENT: "nict", NON_INVITE_SERVER: "nist", INVITE_CLIENT: "ict", INVITE_SERVER: "ist" }, C = function ( e ) { function t ( e, n, r, o ) { var s; i( this, t ), ( s = u( this, l( t ).call( this ) ) ).type = T.NON_INVITE_CLIENT, s.id = "z9hG4bK".concat( Math.floor( 1e7 * Math.random() ) ), s.ua = e, s.transport = n, s.request = r, s.eventHandlers = o; var c = "SIP/2.0/".concat( n.via_transport ); return c += " ".concat( e.configuration.via_host, ";branch=" ).concat( s.id ), s.request.setHeader( "via", c ), s.ua.newTransaction( a( s ) ), s } return c( t, f ), s( t, [{ key: "stateChanged", value: function ( e ) { this.state = e, this.emit( "stateChanged" ) } }, { key: "send", value: function () { var e = this; this.stateChanged( T.STATUS_TRYING ), this.F = setTimeout( ( function () { e.timer_F() } ), _.TIMER_F ), this.transport.send( this.request ) || this.onTransportError() } }, { key: "onTransportError", value: function () { p( "transport error occurred, deleting transaction ".concat( this.id ) ), clearTimeout( this.F ), clearTimeout( this.K ), this.stateChanged( T.STATUS_TERMINATED ), this.ua.destroyTransaction( this ), this.eventHandlers.onTransportError() } }, { key: "timer_F", value: function () { p( "Timer F expired for transaction ".concat( this.id ) ), this.stateChanged( T.STATUS_TERMINATED ), this.ua.destroyTransaction( this ), this.eventHandlers.onRequestTimeout() } }, { key: "timer_K", value: function () { this.stateChanged( T.STATUS_TERMINATED ), this.ua.destroyTransaction( this ) } }, { key: "receiveResponse", value: function ( e ) { var t = this, n = e.status_code; if ( n < 200 ) switch ( this.state ) { case T.STATUS_TRYING: case T.STATUS_PROCEEDING: this.stateChanged( T.STATUS_PROCEEDING ), this.eventHandlers.onReceiveResponse( e ) } else switch ( this.state ) { case T.STATUS_TRYING: case T.STATUS_PROCEEDING: this.stateChanged( T.STATUS_COMPLETED ), clearTimeout( this.F ), 408 === n ? this.eventHandlers.onRequestTimeout() : this.eventHandlers.onReceiveResponse( e ), this.K = setTimeout( ( function () { t.timer_K() } ), _.TIMER_K ) } } }, { key: "C", get: function () { return T } }] ), t }(), b = function ( e ) { function t ( e, n, r, o ) { var s; i( this, t ), ( s = u( this, l( t ).call( this ) ) ).type = T.INVITE_CLIENT, s.id = "z9hG4bK".concat( Math.floor( 1e7 * Math.random() ) ), s.ua = e, s.transport = n, s.request = r, s.eventHandlers = o, r.transaction = a( s ); var c = "SIP/2.0/".concat( n.via_transport ); return c += " ".concat( e.configuration.via_host, ";branch=" ).concat( s.id ), s.request.setHeader( "via", c ), s.ua.newTransaction( a( s ) ), s } return c( t, f ), s( t, [{ key: "stateChanged", value: function ( e ) { this.state = e, this.emit( "stateChanged" ) } }, { key: "send", value: function () { var e = this; this.stateChanged( T.STATUS_CALLING ), this.B = setTimeout( ( function () { e.timer_B() } ), _.TIMER_B ), this.transport.send( this.request ) || this.onTransportError() } }, { key: "onTransportError", value: function () { clearTimeout( this.B ), clearTimeout( this.D ), clearTimeout( this.M ), this.state !== T.STATUS_ACCEPTED && ( v( "transport error occurred, deleting transaction ".concat( this.id ) ), this.eventHandlers.onTransportError() ), this.stateChanged( T.STATUS_TERMINATED ), this.ua.destroyTransaction( this ) } }, { key: "timer_M", value: function () { v( "Timer M expired for transaction ".concat( this.id ) ), this.state === T.STATUS_ACCEPTED && ( clearTimeout( this.B ), this.stateChanged( T.STATUS_TERMINATED ), this.ua.destroyTransaction( this ) ) } }, { key: "timer_B", value: function () { v( "Timer B expired for transaction ".concat( this.id ) ), this.state === T.STATUS_CALLING && ( this.stateChanged( T.STATUS_TERMINATED ), this.ua.destroyTransaction( this ), this.eventHandlers.onRequestTimeout() ) } }, { key: "timer_D", value: function () { v( "Timer D expired for transaction ".concat( this.id ) ), clearTimeout( this.B ), this.stateChanged( T.STATUS_TERMINATED ), this.ua.destroyTransaction( this ) } }, { key: "sendACK", value: function ( e ) { var t = this, n = new d.OutgoingRequest( h.ACK, this.request.ruri, this.ua, { route_set: this.request.getHeaders( "route" ), call_id: this.request.getHeader( "call-id" ), cseq: this.request.cseq } ); n.setHeader( "from", this.request.getHeader( "from" ) ), n.setHeader( "via", this.request.getHeader( "via" ) ), n.setHeader( "to", e.getHeader( "to" ) ), this.D = setTimeout( ( function () { t.timer_D() } ), _.TIMER_D ), this.transport.send( n ) } }, { key: "cancel", value: function ( e ) { if ( this.state === T.STATUS_PROCEEDING ) { var t = new d.OutgoingRequest( h.CANCEL, this.request.ruri, this.ua, { route_set: this.request.getHeaders( "route" ), call_id: this.request.getHeader( "call-id" ), cseq: this.request.cseq } ); t.setHeader( "from", this.request.getHeader( "from" ) ), t.setHeader( "via", this.request.getHeader( "via" ) ), t.setHeader( "to", this.request.getHeader( "to" ) ), e && t.setHeader( "reason", e ), this.transport.send( t ) } } }, { key: "receiveResponse", value: function ( e ) { var t = this, n = e.status_code; if ( n >= 100 && n <= 199 ) switch ( this.state ) { case T.STATUS_CALLING: this.stateChanged( T.STATUS_PROCEEDING ), this.eventHandlers.onReceiveResponse( e ); break; case T.STATUS_PROCEEDING: this.eventHandlers.onReceiveResponse( e ) } else if ( n >= 200 && n <= 299 ) switch ( this.state ) { case T.STATUS_CALLING: case T.STATUS_PROCEEDING: this.stateChanged( T.STATUS_ACCEPTED ), this.M = setTimeout( ( function () { t.timer_M() } ), _.TIMER_M ), this.eventHandlers.onReceiveResponse( e ); break; case T.STATUS_ACCEPTED: this.eventHandlers.onReceiveResponse( e ) } else if ( n >= 300 && n <= 699 ) switch ( this.state ) { case T.STATUS_CALLING: case T.STATUS_PROCEEDING: this.stateChanged( T.STATUS_COMPLETED ), this.sendACK( e ), this.eventHandlers.onReceiveResponse( e ); break; case T.STATUS_COMPLETED: this.sendACK( e ) } } }, { key: "C", get: function () { return T } }] ), t }(), E = function ( e ) { function t ( e, n, r, o ) { var s; i( this, t ), ( s = u( this, l( t ).call( this ) ) ).id = "z9hG4bK".concat( Math.floor( 1e7 * Math.random() ) ), s.transport = n, s.request = r, s.eventHandlers = o; var a = "SIP/2.0/".concat( n.via_transport ); return a += " ".concat( e.configuration.via_host, ";branch=" ).concat( s.id ), s.request.setHeader( "via", a ), s } return c( t, f ), s( t, [{ key: "send", value: function () { this.transport.send( this.request ) || this.onTransportError() } }, { key: "onTransportError", value: function () { m( "transport error occurred for transaction ".concat( this.id ) ), this.eventHandlers.onTransportError() } }, { key: "C", get: function () { return T } }] ), t }(), S = function ( e ) { function t ( e, n, r ) { var o; return i( this, t ), ( o = u( this, l( t ).call( this ) ) ).type = T.NON_INVITE_SERVER, o.id = r.via_branch, o.ua = e, o.transport = n, o.request = r, o.last_response = "", r.server_transaction = a( o ), o.state = T.STATUS_TRYING, e.newTransaction( a( o ) ), o } return c( t, f ), s( t, [{ key: "stateChanged", value: function ( e ) { this.state = e, this.emit( "stateChanged" ) } }, { key: "timer_J", value: function () { g( "Timer J expired for transaction ".concat( this.id ) ), this.stateChanged( T.STATUS_TERMINATED ), this.ua.destroyTransaction( this ) } }, { key: "onTransportError", value: function () { this.transportError || ( this.transportError = !0, g( "transport error occurred, deleting transaction ".concat( this.id ) ), clearTimeout( this.J ), this.stateChanged( T.STATUS_TERMINATED ), this.ua.destroyTransaction( this ) ) } }, { key: "receiveResponse", value: function ( e, t, n, r ) { var i = this; if ( 100 === e ) switch ( this.state ) { case T.STATUS_TRYING: this.stateChanged( T.STATUS_PROCEEDING ), this.transport.send( t ) || this.onTransportError(); break; case T.STATUS_PROCEEDING: this.last_response = t, this.transport.send( t ) ? n && n() : ( this.onTransportError(), r && r() ) } else if ( e >= 200 && e <= 699 ) switch ( this.state ) { case T.STATUS_TRYING: case T.STATUS_PROCEEDING: this.stateChanged( T.STATUS_COMPLETED ), this.last_response = t, this.J = setTimeout( ( function () { i.timer_J() } ), _.TIMER_J ), this.transport.send( t ) ? n && n() : ( this.onTransportError(), r && r() ) } } }, { key: "C", get: function () { return T } }] ), t }(), A = function ( e ) { function t ( e, n, r ) { var o; return i( this, t ), ( o = u( this, l( t ).call( this ) ) ).type = T.INVITE_SERVER, o.id = r.via_branch, o.ua = e, o.transport = n, o.request = r, o.last_response = "", r.server_transaction = a( o ), o.state = T.STATUS_PROCEEDING, e.newTransaction( a( o ) ), o.resendProvisionalTimer = null, r.reply( 100 ), o } return c( t, f ), s( t, [{ key: "stateChanged", value: function ( e ) { this.state = e, this.emit( "stateChanged" ) } }, { key: "timer_H", value: function () { y( "Timer H expired for transaction ".concat( this.id ) ), this.state === T.STATUS_COMPLETED && y( "ACK not received, dialog will be terminated" ), this.stateChanged( T.STATUS_TERMINATED ), this.ua.destroyTransaction( this ) } }, { key: "timer_I", value: function () { this.stateChanged( T.STATUS_TERMINATED ) } }, { key: "timer_L", value: function () { y( "Timer L expired for transaction ".concat( this.id ) ), this.state === T.STATUS_ACCEPTED && ( this.stateChanged( T.STATUS_TERMINATED ), this.ua.destroyTransaction( this ) ) } }, { key: "onTransportError", value: function () { this.transportError || ( this.transportError = !0, y( "transport error occurred, deleting transaction ".concat( this.id ) ), null !== this.resendProvisionalTimer && ( clearInterval( this.resendProvisionalTimer ), this.resendProvisionalTimer = null ), clearTimeout( this.L ), clearTimeout( this.H ), clearTimeout( this.I ), this.stateChanged( T.STATUS_TERMINATED ), this.ua.destroyTransaction( this ) ) } }, { key: "resend_provisional", value: function () { this.transport.send( this.last_response ) || this.onTransportError() } }, { key: "receiveResponse", value: function ( e, t, n, r ) { var i = this; if ( e >= 100 && e <= 199 ) switch ( this.state ) { case T.STATUS_PROCEEDING: this.transport.send( t ) || this.onTransportError(), this.last_response = t }if ( e > 100 && e <= 199 && this.state === T.STATUS_PROCEEDING ) null === this.resendProvisionalTimer && ( this.resendProvisionalTimer = setInterval( ( function () { i.resend_provisional() } ), _.PROVISIONAL_RESPONSE_INTERVAL ) ); else if ( e >= 200 && e <= 299 ) switch ( this.state ) { case T.STATUS_PROCEEDING: this.stateChanged( T.STATUS_ACCEPTED ), this.last_response = t, this.L = setTimeout( ( function () { i.timer_L() } ), _.TIMER_L ), null !== this.resendProvisionalTimer && ( clearInterval( this.resendProvisionalTimer ), this.resendProvisionalTimer = null ); case T.STATUS_ACCEPTED: this.transport.send( t ) ? n && n() : ( this.onTransportError(), r && r() ) } else if ( e >= 300 && e <= 699 ) switch ( this.state ) { case T.STATUS_PROCEEDING: null !== this.resendProvisionalTimer && ( clearInterval( this.resendProvisionalTimer ), this.resendProvisionalTimer = null ), this.transport.send( t ) ? ( this.stateChanged( T.STATUS_COMPLETED ), this.H = setTimeout( ( function () { i.timer_H() } ), _.TIMER_H ), n && n() ) : ( this.onTransportError(), r && r() ) } } }, { key: "C", get: function () { return T } }] ), t }(); t.exports = { C: T, NonInviteClientTransaction: C, InviteClientTransaction: b, AckClientTransaction: E, NonInviteServerTransaction: S, InviteServerTransaction: A, checkTransaction: function ( e, t ) { var n, r = e._transactions; switch ( t.method ) { case h.INVITE: if ( n = r.ist[t.via_branch] ) { switch ( n.state ) { case T.STATUS_PROCEEDING: n.transport.send( n.last_response ) }return !0 } break; case h.ACK: if ( !( n = r.ist[t.via_branch] ) ) return !1; if ( n.state === T.STATUS_ACCEPTED ) return !1; if ( n.state === T.STATUS_COMPLETED ) return n.state = T.STATUS_CONFIRMED, n.I = setTimeout( ( function () { n.timer_I() } ), _.TIMER_I ), !0; break; case h.CANCEL: return ( n = r.ist[t.via_branch] ) ? ( t.reply_sl( 200 ), n.state !== T.STATUS_PROCEEDING ) : ( t.reply_sl( 481 ), !0 ); default: if ( n = r.nist[t.via_branch] ) { switch ( n.state ) { case T.STATUS_TRYING: break; case T.STATUS_PROCEEDING: case T.STATUS_COMPLETED: n.transport.send( n.last_response ) }return !0 } } } } }, { "./Constants": 2, "./SIPMessage": 19, "./Timers": 21, debug: 30, events: 29 }], 23: [function ( e, t, n ) { "use strict"; function r ( e, t ) { for ( var n = 0; n < t.length; n++ ) { var r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && ( r.writable = !0 ), Object.defineProperty( e, r.key, r ) } } var i = e( "./Socket" ), o = e( "debug" )( "PIOPIY:Transport" ), s = e( "debug" )( "PIOPIY:ERROR:Transport" ), u = e( "./Constants" ); s.log = console.warn.bind( console ); var l = { STATUS_CONNECTED: 0, STATUS_CONNECTING: 1, STATUS_DISCONNECTED: 2, SOCKET_STATUS_READY: 0, SOCKET_STATUS_ERROR: 1, recovery_options: { min_interval: u.CONNECTION_RECOVERY_MIN_INTERVAL, max_interval: u.CONNECTION_RECOVERY_MAX_INTERVAL } }; t.exports = function () { function e ( t ) { var n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : l.recovery_options; if ( function ( e, t ) { if ( !( e instanceof t ) ) throw new TypeError( "Cannot call a class as a function" ) }( this, e ), o( "new()" ), this.status = l.STATUS_DISCONNECTED, this.socket = null, this.sockets = [], this.recovery_options = n, this.recover_attempts = 0, this.recovery_timer = null, this.close_requested = !1, void 0 === t ) throw new TypeError( "Invalid argument. undefined 'sockets' argument" ); t instanceof Array || ( t = [t] ), t.forEach( ( function ( e ) { if ( !i.isSocket( e.socket ) ) throw new TypeError( "Invalid argument. invalid 'JsSIP.Socket' instance" ); if ( e.weight && !Number( e.weight ) ) throw new TypeError( "Invalid argument. 'weight' attribute is not a number" ); this.sockets.push( { socket: e.socket, weight: e.weight || 0, status: l.SOCKET_STATUS_READY } ) } ), this ), this._getSocket() } var t, n; return t = e, ( n = [{ key: "connect", value: function () { o( "connect()" ), this.isConnected() ? o( "Transport is already connected" ) : this.isConnecting() ? o( "Transport is connecting" ) : ( this.close_requested = !1, this.status = l.STATUS_CONNECTING, this.onconnecting( { socket: this.socket, attempts: this.recover_attempts } ), this.close_requested || ( this.socket.onconnect = this._onConnect.bind( this ), this.socket.ondisconnect = this._onDisconnect.bind( this ), this.socket.ondata = this._onData.bind( this ), this.socket.connect() ) ) } }, { key: "disconnect", value: function () { o( "close()" ), this.close_requested = !0, this.recover_attempts = 0, this.status = l.STATUS_DISCONNECTED, null !== this.recovery_timer && ( clearTimeout( this.recovery_timer ), this.recovery_timer = null ), this.socket.onconnect = function () { }, this.socket.ondisconnect = function () { }, this.socket.ondata = function () { }, this.socket.disconnect(), this.ondisconnect( { socket: this.socket, error: !1 } ) } }, { key: "send", value: function ( e ) { if ( o( "send()" ), !this.isConnected() ) return s( "unable to send message, transport is not connected" ), !1; var t = e.toString(); return o( "sending message:\n\n".concat( t, "\n" ) ), this.socket.send( t ) } }, { key: "isConnected", value: function () { return this.status === l.STATUS_CONNECTED } }, { key: "isConnecting", value: function () { return this.status === l.STATUS_CONNECTING } }, { key: "_reconnect", value: function () { var e = this; this.recover_attempts += 1; var t = Math.floor( Math.random() * Math.pow( 2, this.recover_attempts ) + 1 ); t < this.recovery_options.min_interval ? t = this.recovery_options.min_interval : t > this.recovery_options.max_interval && ( t = this.recovery_options.max_interval ), o( "reconnection attempt: ".concat( this.recover_attempts, ". next connection attempt in " ).concat( t, " seconds" ) ), this.recovery_timer = setTimeout( ( function () { e.close_requested || e.isConnected() || e.isConnecting() || ( e._getSocket(), e.connect() ) } ), 1e3 * t ) } }, { key: "_getSocket", value: function () { var e = []; if ( this.sockets.forEach( ( function ( t ) { t.status !== l.SOCKET_STATUS_ERROR && ( 0 === e.length ? e.push( t ) : t.weight > e[0].weight ? e = [t] : t.weight === e[0].weight && e.push( t ) ) } ) ), 0 === e.length ) return this.sockets.forEach( ( function ( e ) { e.status = l.SOCKET_STATUS_READY } ) ), void this._getSocket(); var t = Math.floor( Math.random() * e.length ); this.socket = e[t].socket } }, { key: "_onConnect", value: function () { this.recover_attempts = 0, this.status = l.STATUS_CONNECTED, null !== this.recovery_timer && ( clearTimeout( this.recovery_timer ), this.recovery_timer = null ), this.onconnect( { socket: this } ) } }, { key: "_onDisconnect", value: function ( e, t, n ) { this.status = l.STATUS_DISCONNECTED, this.ondisconnect( { socket: this.socket, error: e, code: t, reason: n } ), this.close_requested || ( this.sockets.forEach( ( function ( e ) { this.socket === e.socket && ( e.status = l.SOCKET_STATUS_ERROR ) } ), this ), this._reconnect( e ) ) } }, { key: "_onData", value: function ( e ) { if ( "\r\n" !== e ) { if ( "string" != typeof e ) { try { e = String.fromCharCode.apply( null, new Uint8Array( e ) ) } catch ( e ) { return void o( "received binary message failed to be converted into string, message discarded" ) } o( "received binary message:\n\n".concat( e, "\n" ) ) } else o( "received text message:\n\n".concat( e, "\n" ) ); this.ondata( { transport: this, message: e } ) } else o( "received message with CRLF Keep Alive response" ) } }, { key: "via_transport", get: function () { return this.socket.via_transport } }, { key: "url", get: function () { return this.socket.url } }, { key: "sip_uri", get: function () { return this.socket.sip_uri } }] ) && r( t.prototype, n ), e }() }, { "./Constants": 2, "./Socket": 20, debug: 30 }], 24: [function ( e, t, n ) { "use strict"; function r ( e ) { return ( r = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function ( e ) { return typeof e } : function ( e ) { return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e } )( e ) } function i ( e ) { return ( i = Object.setPrototypeOf ? Object.getPrototypeOf : function ( e ) { return e.__proto__ || Object.getPrototypeOf( e ) } )( e ) } function o ( e ) { if ( void 0 === e ) throw new ReferenceError( "this hasn't been initialised - super() hasn't been called" ); return e } function s ( e, t ) { for ( var n = 0; n < t.length; n++ ) { var r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && ( r.writable = !0 ), Object.defineProperty( e, r.key, r ) } } function u ( e, t, n ) { return t && s( e.prototype, t ), n && s( e, n ), e } function l ( e, t ) { return ( l = Object.setPrototypeOf || function ( e, t ) { return e.__proto__ = t, e } )( e, t ) } var a = e( "events" ).EventEmitter, c = e( "./Constants" ), f = e( "./Registrator" ), h = e( "./RTCSession" ), d = e( "./Message" ), _ = e( "./Transactions" ), p = e( "./Transport" ), v = e( "./Utils" ), m = e( "./Exceptions" ), g = e( "./URI" ), y = e( "./Parser" ), T = e( "./SIPMessage" ), C = e( "./sanityCheck" ), b = e( "./Config" ), E = e( "debug" )( "PIOPIY:UA" ), S = e( "debug" )( "PIOPIY:ERROR:UA" ); S.log = console.warn.bind( console ); var A = { STATUS_INIT: 0, STATUS_READY: 1, STATUS_USER_CLOSED: 2, STATUS_NOT_READY: 3, CONFIGURATION_ERROR: 1, NETWORK_ERROR: 2 }; t.exports = function ( e ) { function t ( e ) { var n, s; if ( function ( e, t ) { if ( !( e instanceof t ) ) throw new TypeError( "Cannot call a class as a function" ) }( this, t ), E( "new() [configuration:%o]", e ), ( n = !( s = i( t ).call( this ) ) || "object" !== r( s ) && "function" != typeof s ? o( this ) : s )._cache = { credentials: {} }, n._configuration = Object.assign( {}, b.settings ), n._dynConfiguration = {}, n._dialogs = {}, n._applicants = {}, n._sessions = {}, n._transport = null, n._contact = null, n._status = A.STATUS_INIT, n._error = null, n._transactions = { nist: {}, nict: {}, ist: {}, ict: {} }, n._data = {}, n._closeTimer = null, void 0 === e ) throw new TypeError( "Not enough arguments" ); try { n._loadConfig( e ) } catch ( e ) { throw n._status = A.STATUS_NOT_READY, n._error = A.CONFIGURATION_ERROR, e } return n._registrator = new f( o( n ) ), n } return function ( e, t ) { if ( "function" != typeof t && null !== t ) throw new TypeError( "Super expression must either be null or a function" ); e.prototype = Object.create( t && t.prototype, { constructor: { value: e, writable: !0, configurable: !0 } } ), t && l( e, t ) }( t, a ), u( t, null, [{ key: "C", get: function () { return A } }] ), u( t, [{ key: "start", value: function () { E( "start()" ), this._status === A.STATUS_INIT ? this._transport.connect() : this._status === A.STATUS_USER_CLOSED ? ( E( "restarting UA" ), null !== this._closeTimer && ( clearTimeout( this._closeTimer ), this._closeTimer = null, this._transport.disconnect() ), this._status = A.STATUS_INIT, this._transport.connect() ) : this._status === A.STATUS_READY ? E( "UA is in READY status, not restarted" ) : E( "ERROR: connection is down, Auto-Recovery system is trying to reconnect" ), this._dynConfiguration.register = this._configuration.register } }, { key: "register", value: function () { E( "register()" ), this._dynConfiguration.register = !0, this._registrator.register() } }, { key: "unregister", value: function ( e ) { E( "unregister()" ), this._dynConfiguration.register = !1, this._registrator.unregister( e ) } }, { key: "registrator", value: function () { return this._registrator } }, { key: "isRegistered", value: function () { return this._registrator.registered } }, { key: "isConnected", value: function () { return this._transport.isConnected() } }, { key: "call", value: function ( e, t ) { E( "call()" ); var n = new h( this ); return n.connect( e, t ), n } }, { key: "sendMessage", value: function ( e, t, n ) { E( "sendMessage()" ); var r = new d( this ); return r.send( e, t, n ), r } }, { key: "terminateSessions", value: function ( e ) { for ( var t in E( "terminateSessions()" ), this._sessions ) this._sessions[t].isEnded() || this._sessions[t].terminate( e ) } }, { key: "stop", value: function () { var e = this; if ( E( "stop()" ), this._dynConfiguration = {}, this._status !== A.STATUS_USER_CLOSED ) { this._registrator.close(); var t = Object.keys( this._sessions ).length; for ( var n in this._sessions ) if ( Object.prototype.hasOwnProperty.call( this._sessions, n ) ) { E( "closing session ".concat( n ) ); try { this._sessions[n].terminate() } catch ( e ) { } } for ( var r in this._applicants ) if ( Object.prototype.hasOwnProperty.call( this._applicants, r ) ) try { this._applicants[r].close() } catch ( e ) { } this._status = A.STATUS_USER_CLOSED, 0 === Object.keys( this._transactions.nict ).length + Object.keys( this._transactions.nist ).length + Object.keys( this._transactions.ict ).length + Object.keys( this._transactions.ist ).length && 0 === t ? this._transport.disconnect() : this._closeTimer = setTimeout( ( function () { e._closeTimer = null, e._transport.disconnect() } ), 2e3 ) } else E( "UA already closed" ) } }, { key: "normalizeTarget", value: function ( e ) { return v.normalizeTarget( e, this._configuration.hostport_params ) } }, { key: "get", value: function ( e ) { switch ( e ) { case "realm": return this._configuration.realm; case "ha1": return this._configuration.ha1; default: return void S( 'get() | cannot get "%s" parameter in runtime', e ) } } }, { key: "set", value: function ( e, t ) { switch ( e ) { case "password": this._configuration.password = String( t ); break; case "realm": this._configuration.realm = String( t ); break; case "ha1": this._configuration.ha1 = String( t ), this._configuration.password = null; break; case "display_name": this._configuration.display_name = t; break; default: return S( 'set() | cannot set "%s" parameter in runtime', e ), !1 }return !0 } }, { key: "newTransaction", value: function ( e ) { this._transactions[e.type][e.id] = e, this.emit( "newTransaction", { transaction: e } ) } }, { key: "destroyTransaction", value: function ( e ) { delete this._transactions[e.type][e.id], this.emit( "transactionDestroyed", { transaction: e } ) } }, { key: "newDialog", value: function ( e ) { this._dialogs[e.id] = e } }, { key: "destroyDialog", value: function ( e ) { delete this._dialogs[e.id] } }, { key: "newMessage", value: function ( e, t ) { this._applicants[e] = e, this.emit( "newMessage", t ) } }, { key: "destroyMessage", value: function ( e ) { delete this._applicants[e] } }, { key: "newRTCSession", value: function ( e, t ) { this._sessions[e.id] = e, this.emit( "newRTCSession", t ) } }, { key: "destroyRTCSession", value: function ( e ) { delete this._sessions[e.id] } }, { key: "registered", value: function ( e ) { this.emit( "registered", e ) } }, { key: "unregistered", value: function ( e ) { this.emit( "unregistered", e ) } }, { key: "registrationFailed", value: function ( e ) { this.emit( "registrationFailed", e ) } }, { key: "receiveRequest", value: function ( e ) { var t = e.method; if ( e.ruri.user !== this._configuration.uri.user && e.ruri.user !== this._contact.uri.user ) return E( "Request-URI does not point to us" ), void ( e.method !== c.ACK && e.reply_sl( 404 ) ); if ( e.ruri.scheme !== c.SIPS ) { if ( !_.checkTransaction( this, e ) ) { if ( t === c.INVITE ? new _.InviteServerTransaction( this, this._transport, e ) : t !== c.ACK && t !== c.CANCEL && new _.NonInviteServerTransaction( this, this._transport, e ), t === c.OPTIONS ) e.reply( 200 ); else if ( t === c.MESSAGE ) { if ( 0 === this.listeners( "newMessage" ).length ) return void e.reply( 405 ); new d( this ).init_incoming( e ) } else if ( t === c.INVITE && !e.to_tag && 0 === this.listeners( "newRTCSession" ).length ) return void e.reply( 405 ); var n, r; if ( e.to_tag ) ( n = this._findDialog( e.call_id, e.from_tag, e.to_tag ) ) ? n.receiveRequest( e ) : t === c.NOTIFY ? ( r = this._findSession( e ) ) ? r.receiveRequest( e ) : ( E( "received NOTIFY request for a non existent subscription" ), e.reply( 481, "Subscription does not exist" ) ) : t !== c.ACK && e.reply( 481 ); else switch ( t ) { case c.INVITE: if ( window.RTCPeerConnection ) if ( e.hasHeader( "replaces" ) ) { var i = e.replaces; ( n = this._findDialog( i.call_id, i.from_tag, i.to_tag ) ) ? ( r = n.owner ).isEnded() ? e.reply( 603 ) : r.receiveRequest( e ) : e.reply( 481 ) } else ( r = new h( this ) ).init_incoming( e ); else S( "INVITE received but WebRTC is not supported" ), e.reply( 488 ); break; case c.BYE: e.reply( 481 ); break; case c.CANCEL: ( r = this._findSession( e ) ) ? r.receiveRequest( e ) : E( "received CANCEL request for a non existent session" ); break; case c.ACK: break; case c.NOTIFY: this.emit( "sipEvent", { event: e.event, request: e } ), e.reply( 200 ); break; default: e.reply( 405 ) } } } else e.reply_sl( 416 ) } }, { key: "_findSession", value: function ( e ) { var t = e.call_id, n = e.from_tag, r = e.to_tag, i = t + n, o = this._sessions[i], s = t + r, u = this._sessions[s]; return o || u || null } }, { key: "_findDialog", value: function ( e, t, n ) { var r = e + t + n, i = this._dialogs[r]; return i || ( r = e + n + t, ( i = this._dialogs[r] ) || null ) } }, { key: "_loadConfig", value: function ( e ) { try { b.load( this._configuration, e ) } catch ( e ) { throw e } 0 === this._configuration.display_name && ( this._configuration.display_name = "0" ), this._configuration.instance_id || ( this._configuration.instance_id = v.newUUID() ), this._configuration.jssip_id = v.createRandomToken( 5 ); var t = this._configuration.uri.clone(); t.user = null, this._configuration.hostport_params = t.toString().replace( /^sip:/i, "" ); try { this._transport = new p( this._configuration.sockets, { max_interval: this._configuration.connection_recovery_max_interval, min_interval: this._configuration.connection_recovery_min_interval } ), this._transport.onconnecting = function ( e ) { this.emit( "connecting", e ) }.bind( this ), this._transport.onconnect = function ( e ) { this._status !== A.STATUS_USER_CLOSED && ( this._status = A.STATUS_READY, this._error = null, this.emit( "connected", e ), this._dynConfiguration.register && this._registrator.register() ) }.bind( this ), this._transport.ondisconnect = function ( e ) { for ( var t = 0, n = ["nict", "ict", "nist", "ist"]; t < n.length; t++ ) { var r = n[t]; for ( var i in this._transactions[r] ) Object.prototype.hasOwnProperty.call( this._transactions[r], i ) && this._transactions[r][i].onTransportError() } this.emit( "disconnected", e ), this._registrator.onTransportClosed(), this._status !== A.STATUS_USER_CLOSED && ( this._status = A.STATUS_NOT_READY, this._error = A.NETWORK_ERROR ) }.bind( this ), this._transport.ondata = function ( e ) { var t = e.transport, n = e.message; if ( ( n = y.parseMessage( n, this ) ) && !( this._status === A.STATUS_USER_CLOSED && n instanceof T.IncomingRequest ) && C( n, this, t ) ) if ( n instanceof T.IncomingRequest ) n.transport = t, this.receiveRequest( n ); else if ( n instanceof T.IncomingResponse ) { var r; switch ( n.method ) { case c.INVITE: ( r = this._transactions.ict[n.via_branch] ) && r.receiveResponse( n ); break; case c.ACK: break; default: ( r = this._transactions.nict[n.via_branch] ) && r.receiveResponse( n ) } } }.bind( this ) } catch ( e ) { throw S( e ), new m.ConfigurationError( "sockets", this._configuration.sockets ) } if ( delete this._configuration.sockets, this._configuration.authorization_user || ( this._configuration.authorization_user = this._configuration.uri.user ), !this._configuration.registrar_server ) { var n = this._configuration.uri.clone(); n.user = null, n.clearParams(), n.clearHeaders(), this._configuration.registrar_server = n } this._configuration.no_answer_timeout *= 1e3, this._configuration.contact_uri ? this._configuration.via_host = this._configuration.contact_uri.host : this._configuration.contact_uri = new g( "sip", v.createRandomToken( 8 ), this._configuration.via_host, null, { transport: "ws" } ), this._contact = { pub_gruu: null, temp_gruu: null, uri: this._configuration.contact_uri, toString: function () { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, t = e.anonymous || null, n = e.outbound || null, r = "<"; return r += t ? this.temp_gruu || "sip:anonymous@anonymous.invalid;transport=ws" : this.pub_gruu || this.uri.toString(), !n || ( t ? this.temp_gruu : this.pub_gruu ) || ( r += ";ob" ), r + ">" } }; var r = ["password", "realm", "ha1", "display_name", "register"]; for ( var i in this._configuration ) Object.prototype.hasOwnProperty.call( this._configuration, i ) && ( -1 !== r.indexOf( i ) ? Object.defineProperty( this._configuration, i, { writable: !0, configurable: !1 } ) : Object.defineProperty( this._configuration, i, { writable: !1, configurable: !1 } ) ); for ( var o in E( "configuration parameters after validation:" ), this._configuration ) if ( Object.prototype.hasOwnProperty.call( b.settings, o ) ) switch ( o ) { case "uri": case "registrar_server": E( "- ".concat( o, ": " ).concat( this._configuration[o] ) ); break; case "password": case "ha1": E( "- ".concat( o, ": NOT SHOWN" ) ); break; default: E( "- ".concat( o, ": " ).concat( JSON.stringify( this._configuration[o] ) ) ) } } }, { key: "C", get: function () { return A } }, { key: "status", get: function () { return this._status } }, { key: "contact", get: function () { return this._contact } }, { key: "configuration", get: function () { return this._configuration } }, { key: "transport", get: function () { return this._transport } }] ), t }() }, { "./Config": 1, "./Constants": 2, "./Exceptions": 6, "./Message": 9, "./Parser": 11, "./RTCSession": 12, "./Registrator": 17, "./SIPMessage": 19, "./Transactions": 22, "./Transport": 23, "./URI": 25, "./Utils": 26, "./sanityCheck": 28, debug: 30, events: 29 }], 25: [function ( e, t, n ) { "use strict"; function r ( e, t ) { for ( var n = 0; n < t.length; n++ ) { var r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && ( r.writable = !0 ), Object.defineProperty( e, r.key, r ) } } function i ( e, t, n ) { return t && r( e.prototype, t ), n && r( e, n ), e } var o = e( "./Constants" ), s = e( "./Utils" ), u = e( "./Grammar" ); t.exports = function () { function e ( t, n, r, i ) { var s = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : {}, u = arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : {}; if ( function ( e, t ) { if ( !( e instanceof t ) ) throw new TypeError( "Cannot call a class as a function" ) }( this, e ), !r ) throw new TypeError( 'missing or invalid "host" parameter' ); for ( var l in this._parameters = {}, this._headers = {}, this._scheme = t || o.SIP, this._user = n, this._host = r, this._port = i, s ) Object.prototype.hasOwnProperty.call( s, l ) && this.setParam( l, s[l] ); for ( var a in u ) Object.prototype.hasOwnProperty.call( u, a ) && this.setHeader( a, u[a] ) } return i( e, null, [{ key: "parse", value: function ( e ) { return -1 !== ( e = u.parse( e, "SIP_URI" ) ) ? e : void 0 } }] ), i( e, [{ key: "setParam", value: function ( e, t ) { e && ( this._parameters[e.toLowerCase()] = null == t ? null : t.toString() ) } }, { key: "getParam", value: function ( e ) { if ( e ) return this._parameters[e.toLowerCase()] } }, { key: "hasParam", value: function ( e ) { if ( e ) return !!this._parameters.hasOwnProperty( e.toLowerCase() ) } }, { key: "deleteParam", value: function ( e ) { if ( e = e.toLowerCase(), this._parameters.hasOwnProperty( e ) ) { var t = this._parameters[e]; return delete this._parameters[e], t } } }, { key: "clearParams", value: function () { this._parameters = {} } }, { key: "setHeader", value: function ( e, t ) { this._headers[s.headerize( e )] = Array.isArray( t ) ? t : [t] } }, { key: "getHeader", value: function ( e ) { if ( e ) return this._headers[s.headerize( e )] } }, { key: "hasHeader", value: function ( e ) { if ( e ) return !!this._headers.hasOwnProperty( s.headerize( e ) ) } }, { key: "deleteHeader", value: function ( e ) { if ( e = s.headerize( e ), this._headers.hasOwnProperty( e ) ) { var t = this._headers[e]; return delete this._headers[e], t } } }, { key: "clearHeaders", value: function () { this._headers = {} } }, { key: "clone", value: function () { return new e( this._scheme, this._user, this._host, this._port, JSON.parse( JSON.stringify( this._parameters ) ), JSON.parse( JSON.stringify( this._headers ) ) ) } }, { key: "toString", value: function () { var e = [], t = "".concat( this._scheme, ":" ); for ( var n in this._user && ( t += "".concat( s.escapeUser( this._user ), "@" ) ), t += this._host, ( this._port || 0 === this._port ) && ( t += ":".concat( this._port ) ), this._parameters ) Object.prototype.hasOwnProperty.call( this._parameters, n ) && ( t += ";".concat( n ), null !== this._parameters[n] && ( t += "=".concat( this._parameters[n] ) ) ); for ( var r in this._headers ) if ( Object.prototype.hasOwnProperty.call( this._headers, r ) ) { var i = !0, o = !1, u = void 0; try { for ( var l, a = this._headers[r][Symbol.iterator](); !( i = ( l = a.next() ).done ); i = !0 ) { var c = l.value; e.push( "".concat( r, "=" ).concat( c ) ) } } catch ( e ) { o = !0, u = e } finally { try { i || null == a.return || a.return() } finally { if ( o ) throw u } } } return e.length > 0 && ( t += "?".concat( e.join( "&" ) ) ), t } }, { key: "toAor", value: function ( e ) { var t = "".concat( this._scheme, ":" ); return this._user && ( t += "".concat( s.escapeUser( this._user ), "@" ) ), t += this._host, e && ( this._port || 0 === this._port ) && ( t += ":".concat( this._port ) ), t } }, { key: "scheme", get: function () { return this._scheme }, set: function ( e ) { this._scheme = e.toLowerCase() } }, { key: "user", get: function () { return this._user }, set: function ( e ) { this._user = e } }, { key: "host", get: function () { return this._host }, set: function ( e ) { this._host = e.toLowerCase() } }, { key: "port", get: function () { return this._port }, set: function ( e ) { this._port = 0 === e ? e : parseInt( e, 10 ) || null } }] ), e }() }, { "./Constants": 2, "./Grammar": 7, "./Utils": 26 }], 26: [function ( e, t, n ) { "use strict"; function r ( e ) { return ( r = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function ( e ) { return typeof e } : function ( e ) { return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e } )( e ) } var i = e( "./Constants" ), o = e( "./URI" ), s = e( "./Grammar" ); n.str_utf8_length = function ( e ) { return unescape( encodeURIComponent( e ) ).length }; var u = n.isFunction = function ( e ) { return void 0 !== e && "[object Function]" === Object.prototype.toString.call( e ) }; n.isString = function ( e ) { return void 0 !== e && "[object String]" === Object.prototype.toString.call( e ) }, n.isDecimal = function ( e ) { return !isNaN( e ) && parseFloat( e ) === parseInt( e, 10 ) }, n.isEmpty = function ( e ) { return null === e || "" === e || void 0 === e || Array.isArray( e ) && 0 === e.length || "number" == typeof e && isNaN( e ) }, n.hasMethods = function ( e ) { for ( var t = arguments.length, n = new Array( t > 1 ? t - 1 : 0 ), r = 1; r < t; r++ )n[r - 1] = arguments[r]; for ( var i = 0, o = n; i < o.length; i++ ) { var s = o[i]; if ( u( e[s] ) ) return !1 } return !0 }; var l = n.createRandomToken = function ( e ) { var t, n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 32, r = ""; for ( t = 0; t < e; t++ )r += ( Math.random() * n | 0 ).toString( n ); return r }; n.newTag = function () { return l( 10 ) }, n.newUUID = function () { return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace( /[xy]/g, ( function ( e ) { var t = 16 * Math.random() | 0; return ( "x" === e ? t : 3 & t | 8 ).toString( 16 ) } ) ) }, n.hostType = function ( e ) { if ( e ) return -1 !== ( e = s.parse( e, "host" ) ) ? e.host_type : void 0 }; var a = n.escapeUser = function ( e ) { return encodeURIComponent( decodeURIComponent( e ) ).replace( /%3A/gi, ":" ).replace( /%2B/gi, "+" ).replace( /%3F/gi, "?" ).replace( /%2F/gi, "/" ) }; n.normalizeTarget = function ( e, t ) { if ( e ) { if ( e instanceof o ) return e; if ( "string" == typeof e ) { var n, r, s, u = e.split( "@" ); switch ( u.length ) { case 1: if ( !t ) return; n = e, r = t; break; case 2: n = u[0], r = u[1]; break; default: n = u.slice( 0, u.length - 1 ).join( "@" ), r = u[u.length - 1] }return n = n.replace( /^(sips?|tel):/i, "" ), /^[-.()]*\+?[0-9\-.()]+$/.test( n ) && ( n = n.replace( /[-.()]/g, "" ) ), e = "".concat( i.SIP, ":" ).concat( a( n ), "@" ).concat( r ), ( s = o.parse( e ) ) ? s : void 0 } } }, n.headerize = function ( e ) { var t, n = { "Call-Id": "Call-ID", Cseq: "CSeq", "Www-Authenticate": "WWW-Authenticate" }, r = e.toLowerCase().replace( /_/g, "-" ).split( "-" ), i = "", o = r.length; for ( t = 0; t < o; t++ )0 !== t && ( i += "-" ), i += r[t].charAt( 0 ).toUpperCase() + r[t].substring( 1 ); return n[i] && ( i = n[i] ), i }, n.sipErrorCause = function ( e ) { for ( var t in i.SIP_ERROR_CAUSES ) if ( -1 !== i.SIP_ERROR_CAUSES[t].indexOf( e ) ) return i.causes[t]; return i.causes.SIP_FAILURE_CODE }, n.getRandomTestNetIP = function () { return "192.0.2.".concat( Math.floor( 254 * Math.random() + 1 ) ) }, n.calculateMD5 = function ( e ) { function t ( e, t ) { return e << t | e >>> 32 - t } function n ( e, t ) { var n = 2147483648 & e, r = 2147483648 & t, i = 1073741824 & e, o = 1073741824 & t, s = ( 1073741823 & e ) + ( 1073741823 & t ); return i & o ? 2147483648 ^ s ^ n ^ r : i | o ? 1073741824 & s ? 3221225472 ^ s ^ n ^ r : 1073741824 ^ s ^ n ^ r : s ^ n ^ r } function r ( e, r, i, o, s, u, l ) { return e = n( e, n( n( function ( e, t, n ) { return e & t | ~e & n }( r, i, o ), s ), l ) ), n( t( e, u ), r ) } function i ( e, r, i, o, s, u, l ) { return e = n( e, n( n( function ( e, t, n ) { return e & n | t & ~n }( r, i, o ), s ), l ) ), n( t( e, u ), r ) } function o ( e, r, i, o, s, u, l ) { return e = n( e, n( n( function ( e, t, n ) { return e ^ t ^ n }( r, i, o ), s ), l ) ), n( t( e, u ), r ) } function s ( e, r, i, o, s, u, l ) { return e = n( e, n( n( function ( e, t, n ) { return t ^ ( e | ~n ) }( r, i, o ), s ), l ) ), n( t( e, u ), r ) } function u ( e ) { var t, n = "", r = ""; for ( t = 0; t <= 3; t++ )n += ( r = "0".concat( ( e >>> 8 * t & 255 ).toString( 16 ) ) ).substr( r.length - 2, 2 ); return n } var l, a, c, f, h, d, _, p, v, m; for ( l = function ( e ) { for ( var t, n = e.length, r = n + 8, i = 16 * ( ( r - r % 64 ) / 64 + 1 ), o = new Array( i - 1 ), s = 0, u = 0; u < n; )s = u % 4 * 8, o[t = ( u - u % 4 ) / 4] = o[t] | e.charCodeAt( u ) << s, u++; return s = u % 4 * 8, o[t = ( u - u % 4 ) / 4] = o[t] | 128 << s, o[i - 2] = n << 3, o[i - 1] = n >>> 29, o }( e = function ( e ) { e = e.replace( /\r\n/g, "\n" ); for ( var t = "", n = 0; n < e.length; n++ ) { var r = e.charCodeAt( n ); r < 128 ? t += String.fromCharCode( r ) : r > 127 && r < 2048 ? ( t += String.fromCharCode( r >> 6 | 192 ), t += String.fromCharCode( 63 & r | 128 ) ) : ( t += String.fromCharCode( r >> 12 | 224 ), t += String.fromCharCode( r >> 6 & 63 | 128 ), t += String.fromCharCode( 63 & r | 128 ) ) } return t }( e ) ), _ = 1732584193, p = 4023233417, v = 2562383102, m = 271733878, a = 0; a < l.length; a += 16 )c = _, f = p, h = v, d = m, _ = r( _, p, v, m, l[a + 0], 7, 3614090360 ), m = r( m, _, p, v, l[a + 1], 12, 3905402710 ), v = r( v, m, _, p, l[a + 2], 17, 606105819 ), p = r( p, v, m, _, l[a + 3], 22, 3250441966 ), _ = r( _, p, v, m, l[a + 4], 7, 4118548399 ), m = r( m, _, p, v, l[a + 5], 12, 1200080426 ), v = r( v, m, _, p, l[a + 6], 17, 2821735955 ), p = r( p, v, m, _, l[a + 7], 22, 4249261313 ), _ = r( _, p, v, m, l[a + 8], 7, 1770035416 ), m = r( m, _, p, v, l[a + 9], 12, 2336552879 ), v = r( v, m, _, p, l[a + 10], 17, 4294925233 ), p = r( p, v, m, _, l[a + 11], 22, 2304563134 ), _ = r( _, p, v, m, l[a + 12], 7, 1804603682 ), m = r( m, _, p, v, l[a + 13], 12, 4254626195 ), v = r( v, m, _, p, l[a + 14], 17, 2792965006 ), _ = i( _, p = r( p, v, m, _, l[a + 15], 22, 1236535329 ), v, m, l[a + 1], 5, 4129170786 ), m = i( m, _, p, v, l[a + 6], 9, 3225465664 ), v = i( v, m, _, p, l[a + 11], 14, 643717713 ), p = i( p, v, m, _, l[a + 0], 20, 3921069994 ), _ = i( _, p, v, m, l[a + 5], 5, 3593408605 ), m = i( m, _, p, v, l[a + 10], 9, 38016083 ), v = i( v, m, _, p, l[a + 15], 14, 3634488961 ), p = i( p, v, m, _, l[a + 4], 20, 3889429448 ), _ = i( _, p, v, m, l[a + 9], 5, 568446438 ), m = i( m, _, p, v, l[a + 14], 9, 3275163606 ), v = i( v, m, _, p, l[a + 3], 14, 4107603335 ), p = i( p, v, m, _, l[a + 8], 20, 1163531501 ), _ = i( _, p, v, m, l[a + 13], 5, 2850285829 ), m = i( m, _, p, v, l[a + 2], 9, 4243563512 ), v = i( v, m, _, p, l[a + 7], 14, 1735328473 ), _ = o( _, p = i( p, v, m, _, l[a + 12], 20, 2368359562 ), v, m, l[a + 5], 4, 4294588738 ), m = o( m, _, p, v, l[a + 8], 11, 2272392833 ), v = o( v, m, _, p, l[a + 11], 16, 1839030562 ), p = o( p, v, m, _, l[a + 14], 23, 4259657740 ), _ = o( _, p, v, m, l[a + 1], 4, 2763975236 ), m = o( m, _, p, v, l[a + 4], 11, 1272893353 ), v = o( v, m, _, p, l[a + 7], 16, 4139469664 ), p = o( p, v, m, _, l[a + 10], 23, 3200236656 ), _ = o( _, p, v, m, l[a + 13], 4, 681279174 ), m = o( m, _, p, v, l[a + 0], 11, 3936430074 ), v = o( v, m, _, p, l[a + 3], 16, 3572445317 ), p = o( p, v, m, _, l[a + 6], 23, 76029189 ), _ = o( _, p, v, m, l[a + 9], 4, 3654602809 ), m = o( m, _, p, v, l[a + 12], 11, 3873151461 ), v = o( v, m, _, p, l[a + 15], 16, 530742520 ), _ = s( _, p = o( p, v, m, _, l[a + 2], 23, 3299628645 ), v, m, l[a + 0], 6, 4096336452 ), m = s( m, _, p, v, l[a + 7], 10, 1126891415 ), v = s( v, m, _, p, l[a + 14], 15, 2878612391 ), p = s( p, v, m, _, l[a + 5], 21, 4237533241 ), _ = s( _, p, v, m, l[a + 12], 6, 1700485571 ), m = s( m, _, p, v, l[a + 3], 10, 2399980690 ), v = s( v, m, _, p, l[a + 10], 15, 4293915773 ), p = s( p, v, m, _, l[a + 1], 21, 2240044497 ), _ = s( _, p, v, m, l[a + 8], 6, 1873313359 ), m = s( m, _, p, v, l[a + 15], 10, 4264355552 ), v = s( v, m, _, p, l[a + 6], 15, 2734768916 ), p = s( p, v, m, _, l[a + 13], 21, 1309151649 ), _ = s( _, p, v, m, l[a + 4], 6, 4149444226 ), m = s( m, _, p, v, l[a + 11], 10, 3174756917 ), v = s( v, m, _, p, l[a + 2], 15, 718787259 ), p = s( p, v, m, _, l[a + 9], 21, 3951481745 ), _ = n( _, c ), p = n( p, f ), v = n( v, h ), m = n( m, d ); return ( u( _ ) + u( p ) + u( v ) + u( m ) ).toLowerCase() }, n.closeMediaStream = function ( e ) { if ( e ) try { var t; if ( e.getTracks ) { t = e.getTracks(); var n = !0, i = !1, o = void 0; try { for ( var s, u = t[Symbol.iterator](); !( n = ( s = u.next() ).done ); n = !0 )s.value.stop() } catch ( e ) { i = !0, o = e } finally { try { n || null == u.return || u.return() } finally { if ( i ) throw o } } } else { t = e.getAudioTracks(); var l = !0, a = !1, c = void 0; try { for ( var f, h = t[Symbol.iterator](); !( l = ( f = h.next() ).done ); l = !0 )f.value.stop() } catch ( e ) { a = !0, c = e } finally { try { l || null == h.return || h.return() } finally { if ( a ) throw c } } t = e.getVideoTracks(); var d = !0, _ = !1, p = void 0; try { for ( var v, m = t[Symbol.iterator](); !( d = ( v = m.next() ).done ); d = !0 )v.value.stop() } catch ( e ) { _ = !0, p = e } finally { try { d || null == m.return || m.return() } finally { if ( _ ) throw p } } } } catch ( t ) { "function" != typeof e.stop && "object" !== r( e.stop ) || e.stop() } }, n.cloneArray = function ( e ) { return e && e.slice() || [] } }, { "./Constants": 2, "./Grammar": 7, "./URI": 25 }], 27: [function ( e, t, n ) { "use strict"; function r ( e, t ) { for ( var n = 0; n < t.length; n++ ) { var r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && ( r.writable = !0 ), Object.defineProperty( e, r.key, r ) } } var i = e( "./Grammar" ), o = e( "debug" )( "PIOPIY:WebSocketInterface" ), s = e( "debug" )( "PIOPIY:ERROR:WebSocketInterface" ); s.log = console.warn.bind( console ), t.exports = function () { function e ( t ) { !function ( e, t ) { if ( !( e instanceof t ) ) throw new TypeError( "Cannot call a class as a function" ) }( this, e ), o( 'new() [url:"%s"]', t ), this._url = t, this._sip_uri = null, this._via_transport = null, this._ws = null; var n = i.parse( t, "absoluteURI" ); if ( -1 === n ) throw s( "invalid WebSocket URI: ".concat( t ) ), new TypeError( "Invalid argument: ".concat( t ) ); if ( "wss" !== n.scheme && "ws" !== n.scheme ) throw s( "invalid WebSocket URI scheme: ".concat( n.scheme ) ), new TypeError( "Invalid argument: ".concat( t ) ); this._sip_uri = "sip:".concat( n.host ).concat( n.port ? ":".concat( n.port ) : "", ";transport=ws" ), this._via_transport = n.scheme.toUpperCase() } var t, n; return t = e, ( n = [{ key: "connect", value: function () { if ( o( "connect()" ), this.isConnected() ) o( "WebSocket ".concat( this._url, " is already connected" ) ); else if ( this.isConnecting() ) o( "WebSocket ".concat( this._url, " is connecting" ) ); else { this._ws && this.disconnect(), o( "connecting to WebSocket ".concat( this._url ) ); try { this._ws = new WebSocket( this._url, "sip" ), this._ws.binaryType = "arraybuffer", this._ws.onopen = this._onOpen.bind( this ), this._ws.onclose = this._onClose.bind( this ), this._ws.onmessage = this._onMessage.bind( this ), this._ws.onerror = this._onError.bind( this ) } catch ( e ) { this._onError( e ) } } } }, { key: "disconnect", value: function () { o( "disconnect()" ), this._ws && ( this._ws.onopen = function () { }, this._ws.onclose = function () { }, this._ws.onmessage = function () { }, this._ws.onerror = function () { }, this._ws.close(), this._ws = null ) } }, { key: "send", value: function ( e ) { return o( "send()" ), this.isConnected() ? ( this._ws.send( e ), !0 ) : ( s( "unable to send message, WebSocket is not open" ), !1 ) } }, { key: "isConnected", value: function () { return this._ws && this._ws.readyState === this._ws.OPEN } }, { key: "isConnecting", value: function () { return this._ws && this._ws.readyState === this._ws.CONNECTING } }, { key: "_onOpen", value: function () { o( "WebSocket ".concat( this._url, " connected" ) ), this.onconnect() } }, { key: "_onClose", value: function ( e ) { var t = e.wasClean, n = e.code, r = e.reason; o( "WebSocket ".concat( this._url, " closed" ) ), !1 === t && o( "WebSocket abrupt disconnection" ); var i = { socket: this, error: !t, code: n, reason: r }; this.ondisconnect( i ) } }, { key: "_onMessage", value: function ( e ) { var t = e.data; o( "received WebSocket message" ), this.ondata( t ) } }, { key: "_onError", value: function ( e ) { s( "WebSocket ".concat( this._url, " error: " ).concat( e ) ) } }, { key: "via_transport", get: function () { return this._via_transport }, set: function ( e ) { this._via_transport = e.toUpperCase() } }, { key: "sip_uri", get: function () { return this._sip_uri } }, { key: "url", get: function () { return this._url } }] ) && r( t.prototype, n ), e }() }, { "./Grammar": 7, debug: 30 }], 28: [function ( e, t, n ) { "use strict"; var r, i, o, s = e( "./Constants" ), u = e( "./SIPMessage" ), l = e( "./Utils" ), a = e( "debug" )( "PIOPIY:sanityCheck" ), c = [function () { for ( var e = 0, t = ["from", "to", "call_id", "cseq", "via"]; e < t.length; e++ ) { var n = t[e]; if ( !r.hasHeader( n ) ) return a( "missing mandatory header field : ".concat( n, ", dropping the response" ) ), !1 } }], f = [function () { if ( "sip" !== r.s( "to" ).uri.scheme ) return d( 416 ), !1 }, function () { if ( !r.to_tag && r.call_id.substr( 0, 5 ) === i.configuration.jssip_id ) return d( 482 ), !1 }, function () { if ( l.str_utf8_length( r.body ) < r.getHeader( "content-length" ) ) return d( 400 ), !1 }, function () { var e, t = r.from_tag, n = r.call_id, o = r.cseq; if ( !r.to_tag ) if ( r.method === s.INVITE ) { if ( i._transactions.ist[r.via_branch] ) return !1; for ( var u in i._transactions.ist ) if ( Object.prototype.hasOwnProperty.call( i._transactions.ist, u ) && ( e = i._transactions.ist[u] ).request.from_tag === t && e.request.call_id === n && e.request.cseq === o ) return d( 482 ), !1 } else { if ( i._transactions.nist[r.via_branch] ) return !1; for ( var l in i._transactions.nist ) if ( Object.prototype.hasOwnProperty.call( i._transactions.nist, l ) && ( e = i._transactions.nist[l] ).request.from_tag === t && e.request.call_id === n && e.request.cseq === o ) return d( 482 ), !1 } }], h = [function () { if ( r.getHeaders( "via" ).length > 1 ) return a( "more than one Via header field present in the response, dropping the response" ), !1 }, function () { if ( l.str_utf8_length( r.body ) < r.getHeader( "content-length" ) ) return a( "message body length is lower than the value in Content-Length header field, dropping the response" ), !1 }]; function d ( e ) { var t, n = r.getHeaders( "via" ), i = "SIP/2.0 ".concat( e, " " ).concat( s.REASON_PHRASE[e], "\r\n" ), u = !0, a = !1, c = void 0; try { for ( var f, h = n[Symbol.iterator](); !( u = ( f = h.next() ).done ); u = !0 ) { var d = f.value; i += "Via: ".concat( d, "\r\n" ) } } catch ( e ) { a = !0, c = e } finally { try { u || null == h.return || h.return() } finally { if ( a ) throw c } } t = r.getHeader( "To" ), r.to_tag || ( t += ";tag=".concat( l.newTag() ) ), i += "To: ".concat( t, "\r\n" ), i += "From: ".concat( r.getHeader( "From" ), "\r\n" ), i += "Call-ID: ".concat( r.call_id, "\r\n" ), i += "CSeq: ".concat( r.cseq, " " ).concat( r.method, "\r\n" ), i += "\r\n", o.send( i ) } t.exports = function ( e, t, n ) { r = e, i = t, o = n; var s = !0, l = !1, a = void 0; try { for ( var d, _ = c[Symbol.iterator](); !( s = ( d = _.next() ).done ); s = !0 )if ( !1 === ( 0, d.value )() ) return !1 } catch ( e ) { l = !0, a = e } finally { try { s || null == _.return || _.return() } finally { if ( l ) throw a } } if ( r instanceof u.IncomingRequest ) { var p = !0, v = !1, m = void 0; try { for ( var g, y = f[Symbol.iterator](); !( p = ( g = y.next() ).done ); p = !0 )if ( !1 === ( 0, g.value )() ) return !1 } catch ( e ) { v = !0, m = e } finally { try { p || null == y.return || y.return() } finally { if ( v ) throw m } } } else if ( r instanceof u.IncomingResponse ) { var T = !0, C = !1, b = void 0; try { for ( var E, S = h[Symbol.iterator](); !( T = ( E = S.next() ).done ); T = !0 )if ( !1 === ( 0, E.value )() ) return !1 } catch ( e ) { C = !0, b = e } finally { try { T || null == S.return || S.return() } finally { if ( C ) throw b } } } return !0 } }, { "./Constants": 2, "./SIPMessage": 19, "./Utils": 26, debug: 30 }], 29: [function ( e, t, n ) { var r = Object.create || function ( e ) { var t = function () { }; return t.prototype = e, new t }, i = Object.keys || function ( e ) { var t = []; for ( var n in e ) Object.prototype.hasOwnProperty.call( e, n ) && t.push( n ); return n }, o = Function.prototype.bind || function ( e ) { var t = this; return function () { return t.apply( e, arguments ) } }; function s () { this._events && Object.prototype.hasOwnProperty.call( this, "_events" ) || ( this._events = r( null ), this._eventsCount = 0 ), this._maxListeners = this._maxListeners || void 0 } t.exports = s, s.EventEmitter = s, s.prototype._events = void 0, s.prototype._maxListeners = void 0; var u, l = 10; try { var a = {}; Object.defineProperty && Object.defineProperty( a, "x", { value: 0 } ), u = 0 === a.x } catch ( e ) { u = !1 } function c ( e ) { return void 0 === e._maxListeners ? s.defaultMaxListeners : e._maxListeners } function f ( e, t, n, i ) { var o, s, u; if ( "function" != typeof n ) throw new TypeError( '"listener" argument must be a function' ); if ( ( s = e._events ) ? ( s.newListener && ( e.emit( "newListener", t, n.listener ? n.listener : n ), s = e._events ), u = s[t] ) : ( s = e._events = r( null ), e._eventsCount = 0 ), u ) { if ( "function" == typeof u ? u = s[t] = i ? [n, u] : [u, n] : i ? u.unshift( n ) : u.push( n ), !u.warned && ( o = c( e ) ) && o > 0 && u.length > o ) { u.warned = !0; var l = new Error( "Possible EventEmitter memory leak detected. " + u.length + ' "' + String( t ) + '" listeners added. Use emitter.setMaxListeners() to increase limit.' ); l.name = "MaxListenersExceededWarning", l.emitter = e, l.type = t, l.count = u.length, "object" == typeof console && console.warn && console.warn( "%s: %s", l.name, l.message ) } } else u = s[t] = n, ++e._eventsCount; return e } function h () { if ( !this.fired ) switch ( this.target.removeListener( this.type, this.wrapFn ), this.fired = !0, arguments.length ) { case 0: return this.listener.call( this.target ); case 1: return this.listener.call( this.target, arguments[0] ); case 2: return this.listener.call( this.target, arguments[0], arguments[1] ); case 3: return this.listener.call( this.target, arguments[0], arguments[1], arguments[2] ); default: for ( var e = new Array( arguments.length ), t = 0; t < e.length; ++t )e[t] = arguments[t]; this.listener.apply( this.target, e ) } } function d ( e, t, n ) { var r = { fired: !1, wrapFn: void 0, target: e, type: t, listener: n }, i = o.call( h, r ); return i.listener = n, r.wrapFn = i, i } function _ ( e, t, n ) { var r = e._events; if ( !r ) return []; var i = r[t]; return i ? "function" == typeof i ? n ? [i.listener || i] : [i] : n ? function ( e ) { for ( var t = new Array( e.length ), n = 0; n < t.length; ++n )t[n] = e[n].listener || e[n]; return t }( i ) : v( i, i.length ) : [] } function p ( e ) { var t = this._events; if ( t ) { var n = t[e]; if ( "function" == typeof n ) return 1; if ( n ) return n.length } return 0 } function v ( e, t ) { for ( var n = new Array( t ), r = 0; r < t; ++r )n[r] = e[r]; return n } u ? Object.defineProperty( s, "defaultMaxListeners", { enumerable: !0, get: function () { return l }, set: function ( e ) { if ( "number" != typeof e || e < 0 || e != e ) throw new TypeError( '"defaultMaxListeners" must be a positive number' ); l = e } } ) : s.defaultMaxListeners = l, s.prototype.setMaxListeners = function ( e ) { if ( "number" != typeof e || e < 0 || isNaN( e ) ) throw new TypeError( '"n" argument must be a positive number' ); return this._maxListeners = e, this }, s.prototype.getMaxListeners = function () { return c( this ) }, s.prototype.emit = function ( e ) { var t, n, r, i, o, s, u = "error" === e; if ( s = this._events ) u = u && null == s.error; else if ( !u ) return !1; if ( u ) { if ( arguments.length > 1 && ( t = arguments[1] ), t instanceof Error ) throw t; var l = new Error( 'Unhandled "error" event. (' + t + ")" ); throw l.context = t, l } if ( !( n = s[e] ) ) return !1; var a = "function" == typeof n; switch ( r = arguments.length ) { case 1: !function ( e, t, n ) { if ( t ) e.call( n ); else for ( var r = e.length, i = v( e, r ), o = 0; o < r; ++o )i[o].call( n ) }( n, a, this ); break; case 2: !function ( e, t, n, r ) { if ( t ) e.call( n, r ); else for ( var i = e.length, o = v( e, i ), s = 0; s < i; ++s )o[s].call( n, r ) }( n, a, this, arguments[1] ); break; case 3: !function ( e, t, n, r, i ) { if ( t ) e.call( n, r, i ); else for ( var o = e.length, s = v( e, o ), u = 0; u < o; ++u )s[u].call( n, r, i ) }( n, a, this, arguments[1], arguments[2] ); break; case 4: !function ( e, t, n, r, i, o ) { if ( t ) e.call( n, r, i, o ); else for ( var s = e.length, u = v( e, s ), l = 0; l < s; ++l )u[l].call( n, r, i, o ) }( n, a, this, arguments[1], arguments[2], arguments[3] ); break; default: for ( i = new Array( r - 1 ), o = 1; o < r; o++ )i[o - 1] = arguments[o]; !function ( e, t, n, r ) { if ( t ) e.apply( n, r ); else for ( var i = e.length, o = v( e, i ), s = 0; s < i; ++s )o[s].apply( n, r ) }( n, a, this, i ) }return !0 }, s.prototype.addListener = function ( e, t ) { return f( this, e, t, !1 ) }, s.prototype.on = s.prototype.addListener, s.prototype.prependListener = function ( e, t ) { return f( this, e, t, !0 ) }, s.prototype.once = function ( e, t ) { if ( "function" != typeof t ) throw new TypeError( '"listener" argument must be a function' ); return this.on( e, d( this, e, t ) ), this }, s.prototype.prependOnceListener = function ( e, t ) { if ( "function" != typeof t ) throw new TypeError( '"listener" argument must be a function' ); return this.prependListener( e, d( this, e, t ) ), this }, s.prototype.removeListener = function ( e, t ) { var n, i, o, s, u; if ( "function" != typeof t ) throw new TypeError( '"listener" argument must be a function' ); if ( !( i = this._events ) ) return this; if ( !( n = i[e] ) ) return this; if ( n === t || n.listener === t ) 0 == --this._eventsCount ? this._events = r( null ) : ( delete i[e], i.removeListener && this.emit( "removeListener", e, n.listener || t ) ); else if ( "function" != typeof n ) { for ( o = -1, s = n.length - 1; s >= 0; s-- )if ( n[s] === t || n[s].listener === t ) { u = n[s].listener, o = s; break } if ( o < 0 ) return this; 0 === o ? n.shift() : function ( e, t ) { for ( var n = t, r = n + 1, i = e.length; r < i; n += 1, r += 1 )e[n] = e[r]; e.pop() }( n, o ), 1 === n.length && ( i[e] = n[0] ), i.removeListener && this.emit( "removeListener", e, u || t ) } return this }, s.prototype.removeAllListeners = function ( e ) { var t, n, o; if ( !( n = this._events ) ) return this; if ( !n.removeListener ) return 0 === arguments.length ? ( this._events = r( null ), this._eventsCount = 0 ) : n[e] && ( 0 == --this._eventsCount ? this._events = r( null ) : delete n[e] ), this; if ( 0 === arguments.length ) { var s, u = i( n ); for ( o = 0; o < u.length; ++o )"removeListener" !== ( s = u[o] ) && this.removeAllListeners( s ); return this.removeAllListeners( "removeListener" ), this._events = r( null ), this._eventsCount = 0, this } if ( "function" == typeof ( t = n[e] ) ) this.removeListener( e, t ); else if ( t ) for ( o = t.length - 1; o >= 0; o-- )this.removeListener( e, t[o] ); return this }, s.prototype.listeners = function ( e ) { return _( this, e, !0 ) }, s.prototype.rawListeners = function ( e ) { return _( this, e, !1 ) }, s.listenerCount = function ( e, t ) { return "function" == typeof e.listenerCount ? e.listenerCount( t ) : p.call( e, t ) }, s.prototype.listenerCount = p, s.prototype.eventNames = function () { return this._eventsCount > 0 ? Reflect.ownKeys( this._events ) : [] } }, {}], 30: [function ( e, t, n ) { ( function ( r ) { n.log = function ( ...e ) { return "object" == typeof console && console.log && console.log( ...e ) }, n.formatArgs = function ( e ) { if ( e[0] = ( this.useColors ? "%c" : "" ) + this.namespace + ( this.useColors ? " %c" : " " ) + e[0] + ( this.useColors ? "%c " : " " ) + "+" + t.exports.humanize( this.diff ), !this.useColors ) return; const n = "color: " + this.color; e.splice( 1, 0, n, "color: inherit" ); let r = 0, i = 0; e[0].replace( /%[a-zA-Z%]/g, e => { "%%" !== e && ( r++, "%c" === e && ( i = r ) ) } ), e.splice( i, 0, n ) }, n.save = function ( e ) { try { e ? n.storage.setItem( "debug", e ) : n.storage.removeItem( "debug" ) } catch ( e ) { } }, n.load = function () { let e; try { e = n.storage.getItem( "debug" ) } catch ( e ) { } return !e && void 0 !== r && "env" in r && ( e = r.env.DEBUG ), e }, n.useColors = function () { return !( "undefined" == typeof window || !window.process || "renderer" !== window.process.type && !window.process.__nwjs ) || ( "undefined" == typeof navigator || !navigator.userAgent || !navigator.userAgent.toLowerCase().match( /(edge|trident)\/(\d+)/ ) ) && ( "undefined" != typeof document && document.documentElement && document.documentElement.style && document.documentElement.style.WebkitAppearance || "undefined" != typeof window && window.console && ( window.console.firebug || window.console.exception && window.console.table ) || "undefined" != typeof navigator && navigator.userAgent && navigator.userAgent.toLowerCase().match( /firefox\/(\d+)/ ) && parseInt( RegExp.$1, 10 ) >= 31 || "undefined" != typeof navigator && navigator.userAgent && navigator.userAgent.toLowerCase().match( /applewebkit\/(\d+)/ ) ) }, n.storage = function () { try { return localStorage } catch ( e ) { } }(), n.colors = ["#0000CC", "#0000FF", "#0033CC", "#0033FF", "#0066CC", "#0066FF", "#0099CC", "#0099FF", "#00CC00", "#00CC33", "#00CC66", "#00CC99", "#00CCCC", "#00CCFF", "#3300CC", "#3300FF", "#3333CC", "#3333FF", "#3366CC", "#3366FF", "#3399CC", "#3399FF", "#33CC00", "#33CC33", "#33CC66", "#33CC99", "#33CCCC", "#33CCFF", "#6600CC", "#6600FF", "#6633CC", "#6633FF", "#66CC00", "#66CC33", "#9900CC", "#9900FF", "#9933CC", "#9933FF", "#99CC00", "#99CC33", "#CC0000", "#CC0033", "#CC0066", "#CC0099", "#CC00CC", "#CC00FF", "#CC3300", "#CC3333", "#CC3366", "#CC3399", "#CC33CC", "#CC33FF", "#CC6600", "#CC6633", "#CC9900", "#CC9933", "#CCCC00", "#CCCC33", "#FF0000", "#FF0033", "#FF0066", "#FF0099", "#FF00CC", "#FF00FF", "#FF3300", "#FF3333", "#FF3366", "#FF3399", "#FF33CC", "#FF33FF", "#FF6600", "#FF6633", "#FF9900", "#FF9933", "#FFCC00", "#FFCC33"], t.exports = e( "./common" )( n ); const { formatters: i } = t.exports; i.j = function ( e ) { try { return JSON.stringify( e ) } catch ( e ) { return "[UnexpectedJSONParseError]: " + e.message } } } ).call( this, e( "_process" ) ) }, { "./common": 31, _process: 33 }], 31: [function ( e, t, n ) { t.exports = function ( t ) { function n ( e ) { let t = 0; for ( let n = 0; n < e.length; n++ )t = ( t << 5 ) - t + e.charCodeAt( n ), t |= 0; return r.colors[Math.abs( t ) % r.colors.length] } function r ( e ) { let t; function s ( ...e ) { if ( !s.enabled ) return; const n = s, i = Number( new Date ), o = i - ( t || i ); n.diff = o, n.prev = t, n.curr = i, t = i, e[0] = r.coerce( e[0] ), "string" != typeof e[0] && e.unshift( "%O" ); let u = 0; e[0] = e[0].replace( /%([a-zA-Z%])/g, ( t, i ) => { if ( "%%" === t ) return t; u++; const o = r.formatters[i]; if ( "function" == typeof o ) { const r = e[u]; t = o.call( n, r ), e.splice( u, 1 ), u-- } return t } ), r.formatArgs.call( n, e ), ( n.log || r.log ).apply( n, e ) } return s.namespace = e, s.enabled = r.enabled( e ), s.useColors = r.useColors(), s.color = n( e ), s.destroy = i, s.extend = o, "function" == typeof r.init && r.init( s ), r.instances.push( s ), s } function i () { const e = r.instances.indexOf( this ); return -1 !== e && ( r.instances.splice( e, 1 ), !0 ) } function o ( e, t ) { const n = r( this.namespace + ( void 0 === t ? ":" : t ) + e ); return n.log = this.log, n } function s ( e ) { return e.toString().substring( 2, e.toString().length - 2 ).replace( /\.\*\?$/, "*" ) } return r.debug = r, r.default = r, r.coerce = function ( e ) { return e instanceof Error ? e.stack || e.message : e }, r.disable = function () { const e = [...r.names.map( s ), ...r.skips.map( s ).map( e => "-" + e )].join( "," ); return r.enable( "" ), e }, r.enable = function ( e ) { let t; r.save( e ), r.names = [], r.skips = []; const n = ( "string" == typeof e ? e : "" ).split( /[\s,]+/ ), i = n.length; for ( t = 0; t < i; t++ )n[t] && ( "-" === ( e = n[t].replace( /\*/g, ".*?" ) )[0] ? r.skips.push( new RegExp( "^" + e.substr( 1 ) + "$" ) ) : r.names.push( new RegExp( "^" + e + "$" ) ) ); for ( t = 0; t < r.instances.length; t++ ) { const e = r.instances[t]; e.enabled = r.enabled( e.namespace ) } }, r.enabled = function ( e ) { if ( "*" === e[e.length - 1] ) return !0; let t, n; for ( t = 0, n = r.skips.length; t < n; t++ )if ( r.skips[t].test( e ) ) return !1; for ( t = 0, n = r.names.length; t < n; t++ )if ( r.names[t].test( e ) ) return !0; return !1 }, r.humanize = e( "ms" ), Object.keys( t ).forEach( e => { r[e] = t[e] } ), r.instances = [], r.names = [], r.skips = [], r.formatters = {}, r.selectColor = n, r.enable( r.load() ), r } }, { ms: 32 }], 32: [function ( e, t, n ) { var r = 1e3, i = 6e4, o = 36e5, s = 24 * o; function u ( e, t, n, r ) { var i = t >= 1.5 * n; return Math.round( e / n ) + " " + r + ( i ? "s" : "" ) } t.exports = function ( e, t ) { t = t || {}; var n = typeof e; if ( "string" === n && e.length > 0 ) return function ( e ) { if ( !( ( e = String( e ) ).length > 100 ) ) { var t = /^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec( e ); if ( t ) { var n = parseFloat( t[1] ); switch ( ( t[2] || "ms" ).toLowerCase() ) { case "years": case "year": case "yrs": case "yr": case "y": return 315576e5 * n; case "weeks": case "week": case "w": return 6048e5 * n; case "days": case "day": case "d": return n * s; case "hours": case "hour": case "hrs": case "hr": case "h": return n * o; case "minutes": case "minute": case "mins": case "min": case "m": return n * i; case "seconds": case "second": case "secs": case "sec": case "s": return n * r; case "milliseconds": case "millisecond": case "msecs": case "msec": case "ms": return n; default: return } } } }( e ); if ( "number" === n && isFinite( e ) ) return t.long ? function ( e ) { var t = Math.abs( e ); return t >= s ? u( e, t, s, "day" ) : t >= o ? u( e, t, o, "hour" ) : t >= i ? u( e, t, i, "minute" ) : t >= r ? u( e, t, r, "second" ) : e + " ms" }( e ) : function ( e ) { var t = Math.abs( e ); return t >= s ? Math.round( e / s ) + "d" : t >= o ? Math.round( e / o ) + "h" : t >= i ? Math.round( e / i ) + "m" : t >= r ? Math.round( e / r ) + "s" : e + "ms" }( e ); throw new Error( "val is not a non-empty string or a valid number. val=" + JSON.stringify( e ) ) } }, {}], 33: [function ( e, t, n ) { var r, i, o = t.exports = {}; function s () { throw new Error( "setTimeout has not been defined" ) } function u () { throw new Error( "clearTimeout has not been defined" ) } function l ( e ) { if ( r === setTimeout ) return setTimeout( e, 0 ); if ( ( r === s || !r ) && setTimeout ) return r = setTimeout, setTimeout( e, 0 ); try { return r( e, 0 ) } catch ( t ) { try { return r.call( null, e, 0 ) } catch ( t ) { return r.call( this, e, 0 ) } } } !function () { try { r = "function" == typeof setTimeout ? setTimeout : s } catch ( e ) { r = s } try { i = "function" == typeof clearTimeout ? clearTimeout : u } catch ( e ) { i = u } }(); var a, c = [], f = !1, h = -1; function d () { f && a && ( f = !1, a.length ? c = a.concat( c ) : h = -1, c.length && _() ) } function _ () { if ( !f ) { var e = l( d ); f = !0; for ( var t = c.length; t; ) { for ( a = c, c = []; ++h < t; )a && a[h].run(); h = -1, t = c.length } a = null, f = !1, function ( e ) { if ( i === clearTimeout ) return clearTimeout( e ); if ( ( i === u || !i ) && clearTimeout ) return i = clearTimeout, clearTimeout( e ); try { i( e ) } catch ( t ) { try { return i.call( null, e ) } catch ( t ) { return i.call( this, e ) } } }( e ) } } function p ( e, t ) { this.fun = e, this.array = t } function v () { } o.nextTick = function ( e ) { var t = new Array( arguments.length - 1 ); if ( arguments.length > 1 ) for ( var n = 1; n < arguments.length; n++ )t[n - 1] = arguments[n]; c.push( new p( e, t ) ), 1 !== c.length || f || l( _ ) }, p.prototype.run = function () { this.fun.apply( null, this.array ) }, o.title = "browser", o.browser = !0, o.env = {}, o.argv = [], o.version = "", o.versions = {}, o.on = v, o.addListener = v, o.once = v, o.off = v, o.removeListener = v, o.removeAllListeners = v, o.emit = v, o.prependListener = v, o.prependOnceListener = v, o.listeners = function ( e ) { return [] }, o.binding = function ( e ) { throw new Error( "process.binding is not supported" ) }, o.cwd = function () { return "/" }, o.chdir = function ( e ) { throw new Error( "process.chdir is not supported" ) }, o.umask = function () { return 0 } }, {}], 34: [function ( e, t, n ) { var r = t.exports = { v: [{ name: "version", reg: /^(\d*)$/ }], o: [{ name: "origin", reg: /^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/, names: ["username", "sessionId", "sessionVersion", "netType", "ipVer", "address"], format: "%s %s %d %s IP%d %s" }], s: [{ name: "name" }], i: [{ name: "description" }], u: [{ name: "uri" }], e: [{ name: "email" }], p: [{ name: "phone" }], z: [{ name: "timezones" }], r: [{ name: "repeats" }], t: [{ name: "timing", reg: /^(\d*) (\d*)/, names: ["start", "stop"], format: "%d %d" }], c: [{ name: "connection", reg: /^IN IP(\d) (\S*)/, names: ["version", "ip"], format: "IN IP%d %s" }], b: [{ push: "bandwidth", reg: /^(TIAS|AS|CT|RR|RS):(\d*)/, names: ["type", "limit"], format: "%s:%s" }], m: [{ reg: /^(\w*) (\d*) ([\w/]*)(?: (.*))?/, names: ["type", "port", "protocol", "payloads"], format: "%s %d %s %s" }], a: [{ push: "rtp", reg: /^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/, names: ["payload", "codec", "rate", "encoding"], format: function ( e ) { return e.encoding ? "rtpmap:%d %s/%s/%s" : e.rate ? "rtpmap:%d %s/%s" : "rtpmap:%d %s" } }, { push: "fmtp", reg: /^fmtp:(\d*) ([\S| ]*)/, names: ["payload", "config"], format: "fmtp:%d %s" }, { name: "control", reg: /^control:(.*)/, format: "control:%s" }, { name: "rtcp", reg: /^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/, names: ["port", "netType", "ipVer", "address"], format: function ( e ) { return null != e.address ? "rtcp:%d %s IP%d %s" : "rtcp:%d" } }, { push: "rtcpFbTrrInt", reg: /^rtcp-fb:(\*|\d*) trr-int (\d*)/, names: ["payload", "value"], format: "rtcp-fb:%d trr-int %d" }, { push: "rtcpFb", reg: /^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/, names: ["payload", "type", "subtype"], format: function ( e ) { return null != e.subtype ? "rtcp-fb:%s %s %s" : "rtcp-fb:%s %s" } }, { push: "ext", reg: /^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/, names: ["value", "direction", "encrypt-uri", "uri", "config"], format: function ( e ) { return "extmap:%d" + ( e.direction ? "/%s" : "%v" ) + ( e["encrypt-uri"] ? " %s" : "%v" ) + " %s" + ( e.config ? " %s" : "" ) } }, { name: "extmapAllowMixed", reg: /^(extmap-allow-mixed)/ }, { push: "crypto", reg: /^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/, names: ["id", "suite", "config", "sessionConfig"], format: function ( e ) { return null != e.sessionConfig ? "crypto:%d %s %s %s" : "crypto:%d %s %s" } }, { name: "setup", reg: /^setup:(\w*)/, format: "setup:%s" }, { name: "connectionType", reg: /^connection:(new|existing)/, format: "connection:%s" }, { name: "mid", reg: /^mid:([^\s]*)/, format: "mid:%s" }, { name: "msid", reg: /^msid:(.*)/, format: "msid:%s" }, { name: "ptime", reg: /^ptime:(\d*(?:\.\d*)*)/, format: "ptime:%d" }, { name: "maxptime", reg: /^maxptime:(\d*(?:\.\d*)*)/, format: "maxptime:%d" }, { name: "direction", reg: /^(sendrecv|recvonly|sendonly|inactive)/ }, { name: "icelite", reg: /^(ice-lite)/ }, { name: "iceUfrag", reg: /^ice-ufrag:(\S*)/, format: "ice-ufrag:%s" }, { name: "icePwd", reg: /^ice-pwd:(\S*)/, format: "ice-pwd:%s" }, { name: "fingerprint", reg: /^fingerprint:(\S*) (\S*)/, names: ["type", "hash"], format: "fingerprint:%s %s" }, { push: "candidates", reg: /^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/, names: ["foundation", "component", "transport", "priority", "ip", "port", "type", "raddr", "rport", "tcptype", "generation", "network-id", "network-cost"], format: function ( e ) { var t = "candidate:%s %d %s %d %s %d typ %s"; return t += null != e.raddr ? " raddr %s rport %d" : "%v%v", t += null != e.tcptype ? " tcptype %s" : "%v", null != e.generation && ( t += " generation %d" ), ( t += null != e["network-id"] ? " network-id %d" : "%v" ) + ( null != e["network-cost"] ? " network-cost %d" : "%v" ) } }, { name: "endOfCandidates", reg: /^(end-of-candidates)/ }, { name: "remoteCandidates", reg: /^remote-candidates:(.*)/, format: "remote-candidates:%s" }, { name: "iceOptions", reg: /^ice-options:(\S*)/, format: "ice-options:%s" }, { push: "ssrcs", reg: /^ssrc:(\d*) ([\w_-]*)(?::(.*))?/, names: ["id", "attribute", "value"], format: function ( e ) { var t = "ssrc:%d"; return null != e.attribute && ( t += " %s", null != e.value && ( t += ":%s" ) ), t } }, { push: "ssrcGroups", reg: /^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/, names: ["semantics", "ssrcs"], format: "ssrc-group:%s %s" }, { name: "msidSemantic", reg: /^msid-semantic:\s?(\w*) (\S*)/, names: ["semantic", "token"], format: "msid-semantic: %s %s" }, { push: "groups", reg: /^group:(\w*) (.*)/, names: ["type", "mids"], format: "group:%s %s" }, { name: "rtcpMux", reg: /^(rtcp-mux)/ }, { name: "rtcpRsize", reg: /^(rtcp-rsize)/ }, { name: "sctpmap", reg: /^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/, names: ["sctpmapNumber", "app", "maxMessageSize"], format: function ( e ) { return null != e.maxMessageSize ? "sctpmap:%s %s %s" : "sctpmap:%s %s" } }, { name: "xGoogleFlag", reg: /^x-google-flag:([^\s]*)/, format: "x-google-flag:%s" }, { push: "rids", reg: /^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/, names: ["id", "direction", "params"], format: function ( e ) { return e.params ? "rid:%s %s %s" : "rid:%s %s" } }, { push: "imageattrs", reg: new RegExp( "^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?" ), names: ["pt", "dir1", "attrs1", "dir2", "attrs2"], format: function ( e ) { return "imageattr:%s %s %s" + ( e.dir2 ? " %s %s" : "" ) } }, { name: "simulcast", reg: new RegExp( "^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$" ), names: ["dir1", "list1", "dir2", "list2"], format: function ( e ) { return "simulcast:%s %s" + ( e.dir2 ? " %s %s" : "" ) } }, { name: "simulcast_03", reg: /^simulcast:[\s\t]+([\S+\s\t]+)$/, names: ["value"], format: "simulcast: %s" }, { name: "framerate", reg: /^framerate:(\d+(?:$|\.\d+))/, format: "framerate:%s" }, { name: "sourceFilter", reg: /^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/, names: ["filterMode", "netType", "addressTypes", "destAddress", "srcList"], format: "source-filter: %s %s %s %s %s" }, { name: "bundleOnly", reg: /^(bundle-only)/ }, { name: "label", reg: /^label:(.+)/, format: "label:%s" }, { name: "sctpPort", reg: /^sctp-port:(\d+)$/, format: "sctp-port:%s" }, { name: "maxMessageSize", reg: /^max-message-size:(\d+)$/, format: "max-message-size:%s" }, { push: "tsRefClocks", reg: /^ts-refclk:([^\s=]*)(?:=(\S*))?/, names: ["clksrc", "clksrcExt"], format: function ( e ) { return "ts-refclk:%s" + ( null != e.clksrcExt ? "=%s" : "" ) } }, { name: "mediaClk", reg: /^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/, names: ["id", "mediaClockName", "mediaClockValue", "rateNumerator", "rateDenominator"], format: function ( e ) { var t = "mediaclk:"; return t += null != e.id ? "id=%s %s" : "%v%s", t += null != e.mediaClockValue ? "=%s" : "", ( t += null != e.rateNumerator ? " rate=%s" : "" ) + ( null != e.rateDenominator ? "/%s" : "" ) } }, { name: "keywords", reg: /^keywds:(.+)$/, format: "keywds:%s" }, { name: "content", reg: /^content:(.+)/, format: "content:%s" }, { name: "bfcpFloorCtrl", reg: /^floorctrl:(c-only|s-only|c-s)/, format: "floorctrl:%s" }, { name: "bfcpConfId", reg: /^confid:(\d+)/, format: "confid:%s" }, { name: "bfcpUserId", reg: /^userid:(\d+)/, format: "userid:%s" }, { name: "bfcpFloorId", reg: /^floorid:(.+) (?:m-stream|mstrm):(.+)/, names: ["id", "mStream"], format: "floorid:%s mstrm:%s" }, { push: "invalid", names: ["value"] }] }; Object.keys( r ).forEach( ( function ( e ) { r[e].forEach( ( function ( e ) { e.reg || ( e.reg = /(.*)/ ), e.format || ( e.format = "%s" ) } ) ) } ) ) }, {}], 35: [function ( e, t, n ) { var r = e( "./parser" ), i = e( "./writer" ); n.write = i, n.parse = r.parse, n.parseParams = r.parseParams, n.parseFmtpConfig = r.parseFmtpConfig, n.parsePayloads = r.parsePayloads, n.parseRemoteCandidates = r.parseRemoteCandidates, n.parseImageAttributes = r.parseImageAttributes, n.parseSimulcastStreamList = r.parseSimulcastStreamList }, { "./parser": 36, "./writer": 37 }], 36: [function ( e, t, n ) { var r = function ( e ) { return String( Number( e ) ) === e ? Number( e ) : e }, i = function ( e, t, n ) { var i = e.name && e.names; e.push && !t[e.push] ? t[e.push] = [] : i && !t[e.name] && ( t[e.name] = {} ); var o = e.push ? {} : i ? t[e.name] : t; !function ( e, t, n, i ) { if ( i && !n ) t[i] = r( e[1] ); else for ( var o = 0; o < n.length; o += 1 )null != e[o + 1] && ( t[n[o]] = r( e[o + 1] ) ) }( n.match( e.reg ), o, e.names, e.name ), e.push && t[e.push].push( o ) }, o = e( "./grammar" ), s = RegExp.prototype.test.bind( /^([a-z])=(.*)/ ); n.parse = function ( e ) { var t = {}, n = [], r = t; return e.split( /(\r\n|\r|\n)/ ).filter( s ).forEach( ( function ( e ) { var t = e[0], s = e.slice( 2 ); "m" === t && ( n.push( { rtp: [], fmtp: [] } ), r = n[n.length - 1] ); for ( var u = 0; u < ( o[t] || [] ).length; u += 1 ) { var l = o[t][u]; if ( l.reg.test( s ) ) return i( l, r, s ) } } ) ), t.media = n, t }; var u = function ( e, t ) { var n = t.split( /=(.+)/, 2 ); return 2 === n.length ? e[n[0]] = r( n[1] ) : 1 === n.length && t.length > 1 && ( e[n[0]] = void 0 ), e }; n.parseParams = function ( e ) { return e.split( /;\s?/ ).reduce( u, {} ) }, n.parseFmtpConfig = n.parseParams, n.parsePayloads = function ( e ) { return e.toString().split( " " ).map( Number ) }, n.parseRemoteCandidates = function ( e ) { for ( var t = [], n = e.split( " " ).map( r ), i = 0; i < n.length; i += 3 )t.push( { component: n[i], ip: n[i + 1], port: n[i + 2] } ); return t }, n.parseImageAttributes = function ( e ) { return e.split( " " ).map( ( function ( e ) { return e.substring( 1, e.length - 1 ).split( "," ).reduce( u, {} ) } ) ) }, n.parseSimulcastStreamList = function ( e ) { return e.split( ";" ).map( ( function ( e ) { return e.split( "," ).map( ( function ( e ) { var t, n = !1; return "~" !== e[0] ? t = r( e ) : ( t = r( e.substring( 1, e.length ) ), n = !0 ), { scid: t, paused: n } } ) ) } ) ) } }, { "./grammar": 34 }], 37: [function ( e, t, n ) { var r = e( "./grammar" ), i = /%[sdv%]/g, o = function ( e, t, n ) { var r = [e + "=" + ( t.format instanceof Function ? t.format( t.push ? n : n[t.name] ) : t.format )]; if ( t.names ) for ( var o = 0; o < t.names.length; o += 1 ) { var s = t.names[o]; t.name ? r.push( n[t.name][s] ) : r.push( n[t.names[o]] ) } else r.push( n[t.name] ); return function ( e ) { var t = 1, n = arguments, r = n.length; return e.replace( i, ( function ( e ) { if ( t >= r ) return e; var i = n[t]; switch ( t += 1, e ) { case "%%": return "%"; case "%s": return String( i ); case "%d": return Number( i ); case "%v": return "" } } ) ) }.apply( null, r ) }, s = ["v", "o", "s", "i", "u", "e", "p", "c", "b", "t", "r", "z", "a"], u = ["i", "c", "b", "a"]; t.exports = function ( e, t ) { t = t || {}, null == e.version && ( e.version = 0 ), null == e.name && ( e.name = " " ), e.media.forEach( ( function ( e ) { null == e.payloads && ( e.payloads = "" ) } ) ); var n = t.outerOrder || s, i = t.innerOrder || u, l = []; return n.forEach( ( function ( t ) { r[t].forEach( ( function ( n ) { n.name in e && null != e[n.name] ? l.push( o( t, n, e ) ) : n.push in e && null != e[n.push] && e[n.push].forEach( ( function ( e ) { l.push( o( t, n, e ) ) } ) ) } ) ) } ) ), e.media.forEach( ( function ( e ) { l.push( o( "m", r.m[0], e ) ), i.forEach( ( function ( t ) { r[t].forEach( ( function ( n ) { n.name in e && null != e[n.name] ? l.push( o( t, n, e ) ) : n.push in e && null != e[n.push] && e[n.push].forEach( ( function ( e ) { l.push( o( t, n, e ) ) } ) ) } ) ) } ) ) } ) ), l.join( "\r\n" ) + "\r\n" } }, { "./grammar": 34 }], 38: [function ( e, t, n ) { t.exports = { name: "jssip", title: "JsSIP", description: "the Javascript SIP library", version: "3.3.11", homepage: "https://jssip.net", author: "José Luis Millán <jmillan@aliax.net> (https://github.com/jmillan)", contributors: ["Iñaki Baz Castillo <ibc@aliax.net> (https://github.com/ibc)"], main: "lib-es5/JsSIP.js", keywords: ["sip", "websocket", "webrtc", "node", "browser", "library"], license: "MIT", repository: { type: "git", url: "https://github.com/versatica/JsSIP.git" }, bugs: { url: "https://github.com/versatica/JsSIP/issues" }, dependencies: { debug: "^4.1.1", events: "^3.0.0", "sdp-transform": "^2.7.0" }, devDependencies: { "@babel/core": "^7.4.3", "@babel/preset-env": "^7.4.3", "ansi-colors": "^3.2.4", browserify: "^16.2.3", eslint: "^5.16.0", "fancy-log": "^1.3.3", gulp: "^4.0.0", "gulp-babel": "^8.0.0", "gulp-eslint": "^5.0.0", "gulp-expect-file": "^1.0.1", "gulp-header": "^2.0.7", "gulp-nodeunit-runner": "^0.2.2", "gulp-plumber": "^1.2.1", "gulp-rename": "^1.4.0", "gulp-uglify-es": "^1.0.4", pegjs: "^0.7.0", "vinyl-buffer": "^1.0.1", "vinyl-source-stream": "^2.0.0" }, scripts: { lint: "gulp lint", test: "gulp test", build: "gulp dist", prepublishOnly: "gulp babel" } } }, {}] }, {}, [8] )( 8 ) }, function ( e, t, n ) { "use strict"; var r, i = "object" == typeof Reflect ? Reflect : null, o = i && "function" == typeof i.apply ? i.apply : function ( e, t, n ) { return Function.prototype.apply.call( e, t, n ) }; r = i && "function" == typeof i.ownKeys ? i.ownKeys : Object.getOwnPropertySymbols ? function ( e ) { return Object.getOwnPropertyNames( e ).concat( Object.getOwnPropertySymbols( e ) ) } : function ( e ) { return Object.getOwnPropertyNames( e ) }; var s = Number.isNaN || function ( e ) { return e != e }; function u () { u.init.call( this ) } e.exports = u, u.EventEmitter = u, u.prototype._events = void 0, u.prototype._eventsCount = 0, u.prototype._maxListeners = void 0; var l = 10; function a ( e ) { if ( "function" != typeof e ) throw new TypeError( 'The "listener" argument must be of type Function. Received type ' + typeof e ) } function c ( e ) { return void 0 === e._maxListeners ? u.defaultMaxListeners : e._maxListeners } function f ( e, t, n, r ) { var i, o, s, u; if ( a( n ), void 0 === ( o = e._events ) ? ( o = e._events = Object.create( null ), e._eventsCount = 0 ) : ( void 0 !== o.newListener && ( e.emit( "newListener", t, n.listener ? n.listener : n ), o = e._events ), s = o[t] ), void 0 === s ) s = o[t] = n, ++e._eventsCount; else if ( "function" == typeof s ? s = o[t] = r ? [n, s] : [s, n] : r ? s.unshift( n ) : s.push( n ), ( i = c( e ) ) > 0 && s.length > i && !s.warned ) { s.warned = !0; var l = new Error( "Possible EventEmitter memory leak detected. " + s.length + " " + String( t ) + " listeners added. Use emitter.setMaxListeners() to increase limit" ); l.name = "MaxListenersExceededWarning", l.emitter = e, l.type = t, l.count = s.length, u = l, console && console.warn && console.warn( u ) } return e } function h () { if ( !this.fired ) return this.target.removeListener( this.type, this.wrapFn ), this.fired = !0, 0 === arguments.length ? this.listener.call( this.target ) : this.listener.apply( this.target, arguments ) } function d ( e, t, n ) { var r = { fired: !1, wrapFn: void 0, target: e, type: t, listener: n }, i = h.bind( r ); return i.listener = n, r.wrapFn = i, i } function _ ( e, t, n ) { var r = e._events; if ( void 0 === r ) return []; var i = r[t]; return void 0 === i ? [] : "function" == typeof i ? n ? [i.listener || i] : [i] : n ? function ( e ) { for ( var t = new Array( e.length ), n = 0; n < t.length; ++n )t[n] = e[n].listener || e[n]; return t }( i ) : v( i, i.length ) } function p ( e ) { var t = this._events; if ( void 0 !== t ) { var n = t[e]; if ( "function" == typeof n ) return 1; if ( void 0 !== n ) return n.length } return 0 } function v ( e, t ) { for ( var n = new Array( t ), r = 0; r < t; ++r )n[r] = e[r]; return n } Object.defineProperty( u, "defaultMaxListeners", { enumerable: !0, get: function () { return l }, set: function ( e ) { if ( "number" != typeof e || e < 0 || s( e ) ) throw new RangeError( 'The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received ' + e + "." ); l = e } } ), u.init = function () { void 0 !== this._events && this._events !== Object.getPrototypeOf( this )._events || ( this._events = Object.create( null ), this._eventsCount = 0 ), this._maxListeners = this._maxListeners || void 0 }, u.prototype.setMaxListeners = function ( e ) { if ( "number" != typeof e || e < 0 || s( e ) ) throw new RangeError( 'The value of "n" is out of range. It must be a non-negative number. Received ' + e + "." ); return this._maxListeners = e, this }, u.prototype.getMaxListeners = function () { return c( this ) }, u.prototype.emit = function ( e ) { for ( var t = [], n = 1; n < arguments.length; n++ )t.push( arguments[n] ); var r = "error" === e, i = this._events; if ( void 0 !== i ) r = r && void 0 === i.error; else if ( !r ) return !1; if ( r ) { var s; if ( t.length > 0 && ( s = t[0] ), s instanceof Error ) throw s; var u = new Error( "Unhandled error." + ( s ? " (" + s.message + ")" : "" ) ); throw u.context = s, u } var l = i[e]; if ( void 0 === l ) return !1; if ( "function" == typeof l ) o( l, this, t ); else { var a = l.length, c = v( l, a ); for ( n = 0; n < a; ++n )o( c[n], this, t ) } return !0 }, u.prototype.addListener = function ( e, t ) { return f( this, e, t, !1 ) }, u.prototype.on = u.prototype.addListener, u.prototype.prependListener = function ( e, t ) { return f( this, e, t, !0 ) }, u.prototype.once = function ( e, t ) { return a( t ), this.on( e, d( this, e, t ) ), this }, u.prototype.prependOnceListener = function ( e, t ) { return a( t ), this.prependListener( e, d( this, e, t ) ), this }, u.prototype.removeListener = function ( e, t ) { var n, r, i, o, s; if ( a( t ), void 0 === ( r = this._events ) ) return this; if ( void 0 === ( n = r[e] ) ) return this; if ( n === t || n.listener === t ) 0 == --this._eventsCount ? this._events = Object.create( null ) : ( delete r[e], r.removeListener && this.emit( "removeListener", e, n.listener || t ) ); else if ( "function" != typeof n ) { for ( i = -1, o = n.length - 1; o >= 0; o-- )if ( n[o] === t || n[o].listener === t ) { s = n[o].listener, i = o; break } if ( i < 0 ) return this; 0 === i ? n.shift() : function ( e, t ) { for ( ; t + 1 < e.length; t++ )e[t] = e[t + 1]; e.pop() }( n, i ), 1 === n.length && ( r[e] = n[0] ), void 0 !== r.removeListener && this.emit( "removeListener", e, s || t ) } return this }, u.prototype.off = u.prototype.removeListener, u.prototype.removeAllListeners = function ( e ) { var t, n, r; if ( void 0 === ( n = this._events ) ) return this; if ( void 0 === n.removeListener ) return 0 === arguments.length ? ( this._events = Object.create( null ), this._eventsCount = 0 ) : void 0 !== n[e] && ( 0 == --this._eventsCount ? this._events = Object.create( null ) : delete n[e] ), this; if ( 0 === arguments.length ) { var i, o = Object.keys( n ); for ( r = 0; r < o.length; ++r )"removeListener" !== ( i = o[r] ) && this.removeAllListeners( i ); return this.removeAllListeners( "removeListener" ), this._events = Object.create( null ), this._eventsCount = 0, this } if ( "function" == typeof ( t = n[e] ) ) this.removeListener( e, t ); else if ( void 0 !== t ) for ( r = t.length - 1; r >= 0; r-- )this.removeListener( e, t[r] ); return this }, u.prototype.listeners = function ( e ) { return _( this, e, !0 ) }, u.prototype.rawListeners = function ( e ) { return _( this, e, !1 ) }, u.listenerCount = function ( e, t ) { return "function" == typeof e.listenerCount ? e.listenerCount( t ) : p.call( e, t ) }, u.prototype.listenerCount = p, u.prototype.eventNames = function () { return this._eventsCount > 0 ? r( this._events ) : [] } }, function ( e, t, n ) { const r = n( 7 ).default; e.exports = r }, function ( e, t ) { var n; n = function () { return this }(); try { n = n || new Function( "return this" )() } catch ( e ) { "object" == typeof window && ( n = window ) } e.exports = n }, function ( e, t ) { e.exports = function ( e ) { return e.webpackPolyfill || ( e.deprecate = function () { }, e.paths = [], e.children || ( e.children = [] ), Object.defineProperty( e, "loaded", { enumerable: !0, get: function () { return e.l } } ), Object.defineProperty( e, "id", { enumerable: !0, get: function () { return e.i } } ), e.webpackPolyfill = 1 ), e } }, function ( e ) { e.exports = JSON.parse( '{"name":"piopiyjs","title":"PIOPIY","version":"0.5.0","description":"PIOPIY javascript browser sdk","main":"index.js","directories":{"lib":"lib"},"scripts":{"test":"echo \\"Error: no test specified\\" && exit 1","build":"webpack","start":"webpack-dev-server --watch"},"repository":{"type":"git","url":"git+https://github.com/telecmi/piopiy_client_js.git"},"keywords":["piopiy","voice","sdk"],"author":"TeleCMI","license":"ISC","bugs":{"url":"https://github.com/telecmi/piopiy_client_js/issues"},"homepage":"https://github.com/telecmi/piopiy_client_js#readme","devDependencies":{"webpack":"^4.42.0","webpack-cli":"^3.3.11","webpack-dev-server":"^3.10.3"},"dependencies":{"lodash":"^4.17.15"}}' ) }, function ( e, t, n ) { "use strict"; n.r( t ); var r = n( 0 ), i = n.n( r ), o = n( 2 ); let s = {}; var u = n( 1 ), l = n.n( u ); let a = {}, c = new class { make ( e, t, n ) { i.a.isEmpty( t._sessions ) ? s = t.call( e, { mediaConstraints: { audio: !0, video: !1 } } ) : n.emit( "error", { code: 1002, status: "already in call" } ) } invite ( e, t ) { s = e.session, "local" != e.originator && t.emit( "inComingCall", { from: e.request.from._display_name || "unknown" } ), this.initSession( s, t ) } answer ( e, t ) { i.a.isEmpty( e._sessions ) ? t.emit( "error", { code: 1002, status: "call not found" } ) : s.isEstablished() ? t.emit( "error", { code: 1002, status: "call already  answered" } ) : s.answer( { mediaConstraints: { audio: !0, video: !1 } } ) } reject ( e, t ) { i.a.isEmpty( e._sessions ) ? t.emit( "error", { code: 1002, status: "call not found" } ) : s.isEnded() ? t.emit( "error", { code: 1002, status: "call already ended" } ) : s.terminate() } terminate ( e, t ) { i.a.isEmpty( e._sessions ) ? t.emit( "error", { code: 1002, status: "call not found" } ) : s.isEnded() ? t.emit( "error", { code: 1002, status: "call already ended" } ) : s.terminate() } hangup ( e, t ) { i.a.isEmpty( e.sessions ) ? t.emit( "error", { code: 1002, status: "call not found" } ) : s.bye() } terminate ( e, t ) { i.a.isEmpty( e._sessions ) ? t.emit( "error", { code: 1002, status: "call not found" } ) : s.isEnded() ? t.emit( "error", { code: 1002, status: "call already ended" } ) : s.terminate() } dtmf ( e, t, n ) { i.a.isEmpty( t._sessions ) ? n.emit( "error", { code: 1002, status: "call not found" } ) : s.isEstablished() ? s.sendDTMF( e ) : n.emit( "error", { code: 1002, status: "dtmf not allowed" } ) } hold ( e, t ) { i.a.isEmpty( e._sessions ) ? t.emit( "error", { code: 1002, status: "call not found" } ) : s.isEstablished() ? s.isOnHold().local ? t.emit( "error", { code: 1002, status: "call already in hold" } ) : s.hold() : t.emit( "error", { code: 1002, status: "hold not allowed" } ) } unhold ( e, t ) { i.a.isEmpty( e._sessions ) ? t.emit( "error", { code: 1002, status: "call not found" } ) : s.isEstablished() ? s.isOnHold().local ? s.unhold() : t.emit( "error", { code: 1002, status: "call not in hold" } ) : t.emit( "error", { code: 1002, status: "hold not allowed" } ) } mute ( e, t ) { i.a.isEmpty( e._sessions ) ? t.emit( "error", { code: 1002, status: "call not found" } ) : s.isEstablished() ? s.isMuted().audio ? t.emit( "error", { code: 1002, status: "call already in mute" } ) : s.mute() : t.emit( "error", { code: 1002, status: "mute not allowed" } ) } unmute ( e, t ) { i.a.isEmpty( e._sessions ) ? t.emit( "error", { code: 1002, status: "call not found" } ) : s.isEstablished() ? s.isMuted().audio ? s.unmute() : t.emit( "error", { code: 1002, status: "call not in mute" } ) : t.emit( "error", { code: 1002, status: "mute not allowed" } ) } initSession ( e, t ) { e.on( "failed", e => { "local" == e.originator ? t.emit( "hangup", { code: 200, status: "call hangup" } ) : t.emit( "ended", { code: 200, status: e.cause || "call ended" } ) } ), e._connection && ( e._connection.onaddstream = e => { if ( t.piopiyOption.autoplay && e.stream ) { var n = document.getElementById( "telecmi_audio_tag" ); n.srcObject = e.stream, n.play() } t.emit( "callStream", { code: 200, status: e.stream } ) } ), e.on( "sending", e => { var n = "local" == e.originator ? "incoming" : "outgoing"; t.emit( "trying", { code: 100, status: "trying", type: n } ) } ), e.on( "peerconnection", e => { e.peerconnection.onaddstream = e => { if ( t.piopiyOption.autoplay && e.stream ) { var n = document.getElementById( "telecmi_audio_tag" ); n.srcObject = e.stream, n.play() } t.emit( "callStream", { code: 200, status: e.stream } ) } } ), e.on( "progress", e => { var n = "local" == e.originator ? "incoming" : "outgoing"; t.emit( "ringing", { code: 183, status: "ringing", type: n } ) } ), e.on( "accepted", e => { if ( "local" != e.originator ) { e.originator; t.emit( "answered", { code: 200, status: "answered" } ) } } ), e.on( "confirmed", e => { if ( "local" != e.originator ) { e.originator; t.emit( "answered", { code: 200, status: "answered" } ) } } ), e.on( "getusermediafailed", e => { t.emit( "mediaFailed", { code: 200, status: e || "user media failed" } ) } ), e.on( "newDTMF", e => { var n = "local" == e.originator ? "incoming" : "outgoing"; t.emit( "dtmf", { code: 200, dtmf: e.dtmf._tone, type: n } ) } ), e.on( "hold", e => { var n = "local" == e.originator ? "myself" : "other"; t.emit( "hold", { code: 200, status: "call on hold", whom: n } ) } ), e.on( "unhold", e => { var n = "local" == e.originator ? "myself" : "other"; t.emit( "unhold", { code: 200, status: "call on active", whom: n } ) } ), e.on( "ended", e => { "local" == e.originator ? t.emit( "hangup", { code: 200, status: "call hangup" } ) : t.emit( "ended", { code: 200, status: "call ended" } ) } ) } }, f = new class { start ( e ) { _.isEmpty( e ) || ( _.isEmpty( e._sessions ) || e.terminateSessions(), e.isRegistered() && ( e.unregister(), e.stop() ) ) } }, h = new l.a.WebSocketInterface( "wss://sbc.telecmi.com" ); window.onbeforeunload = function () { f.start( a ) }; const d = n( 6 ); let p = new class { start ( e, t ) { if ( !i.a.isEmpty( a ) ) { if ( a.isRegistered() ) return void t.emit( "error", { code: 1001, status: "Please logout before you login" } ); a.isConnected() && a.stop() } !0 === e.debug ? l.a.debug.enable( "PIOPIY:*" ) : l.a.debug.disable( "PIOPIY:*" ), e.sockets = [h], e.user_agent = "PIOPIYJS", e.use_preloaded_route = !0, a = new l.a.UA( e ), a.on( "registered", e => { t.emit( "login", { code: 200, status: "login successfully" } ) } ), a.on( "unregistered", e => { t.emit( "logout", { code: 200, status: "logout successfully" } ) } ), a.on( "registrationFailed", e => { console.log( e ), t.emit( "loginFailed", { code: e.response.status_code || 407, status: "invalid user" } ) } ), a.on( "newRTCSession", e => { "local" != e.originator && !i.a.isEmpty( a._sessions ) && Object.keys( a._sessions ).length > 1 ? e.session.terminate() : c.invite( e, t ) } ), a.start() } stop ( e ) { if ( a ) { if ( !a.isRegistered() ) return void e.emit( "error", { code: 1002, status: "Please login" } ); a.isRegistered() && ( a.unregister(), a.stop() ) } } make ( e, t ) { i.a.isEmpty( a ) || a.isRegistered() ? c.make( e, a, t ) : t.emit( "error", { code: 1002, status: "Please login to call" } ) } terminate ( e ) { i.a.isEmpty( a ) || a.isRegistered() ? c.terminate( a, e ) : e.emit( "error", { code: 1002, status: "Please login " } ) } hangup ( e ) { i.a.isEmpty( a ) || a.isRegistered() ? c.hangup( a, e ) : e.emit( "error", { code: 1002, status: "Please login " } ) } answer ( e ) { i.a.isEmpty( a ) || a.isRegistered() ? c.answer( a, e ) : e.emit( "error", { code: 1002, status: "Please login " } ) } reject ( e ) { i.a.isEmpty( a ) || a.isRegistered() ? c.reject( a, e ) : e.emit( "error", { code: 1002, status: "Please login " } ) } dtmf ( e, t ) { i.a.isEmpty( a ) || a.isRegistered() ? i.a.isNumber( e ) ? c.dtmf( e, a, t ) : t.emit( "error", { code: 1005, status: "invalid dtmf type " } ) : t.emit( "error", { code: 1002, status: "Please login " } ) } hold ( e ) { i.a.isEmpty( a ) || a.isRegistered() ? c.hold( a, e ) : e.emit( "error", { code: 1002, status: "Please login " } ) } unhold ( e ) { i.a.isEmpty( a ) || a.isRegistered() ? c.unhold( a, e ) : e.emit( "error", { code: 1002, status: "Please login " } ) } mute ( e ) { i.a.isEmpty( a ) || a.isRegistered() ? c.mute( a, e ) : e.emit( "error", { code: 1002, status: "Please login " } ) } unmute ( e ) { i.a.isEmpty( a ) || a.isRegistered() ? c.unmute( a, e ) : e.emit( "error", { code: 1002, status: "Please login " } ) } }, v = new class { audioTag () { var e = document.createElement( "AUDIO" ); e.setAttribute( "autoplay", !0 ), e.setAttribute( "hidden", !0 ), e.setAttribute( "id", "telecmi_audio_tag" ), document.body.appendChild( e ) } }; t.default = class extends o.EventEmitter { constructor( e ) { super(), this.piopiyOption = {}, this.ua = {}; let t = e || {}; o.EventEmitter.bind( this ), this.name = d.title, this.version = d.version, this.piopiyOption.debug = !!i.a.isBoolean( t.debug ) && t.debug, this.piopiyOption.autoplay = !i.a.isBoolean( t.autoplay ) || t.autoplay, this.piopiyOption.autoReboot = !i.a.isBoolean( t.autoReboot ) || t.autoReboot, this.piopiyOption.ringTime = i.a.isNumber( t.ringTime ) ? t.ringTime : 60, this.piopiyOption.displayName = i.a.isString( t.name ) ? t.name : null, this.piopiyOption.autoplay && v.audioTag() } login ( e, t ) { let n = this; if ( !i.a.isString( e ) || !i.a.isString( t ) ) throw new Error( "invalid user_id or password" ); var r = { uri: e + "@sbc.telecmi.com", authorization_user: e, password: t, debug: this.piopiyOption.debug, display_name: this.piopiyOption.displayName, no_answer_timeout: this.piopiyOption.ringTime, register: !0, register_expires: 300, connection_recovery_min_interval: 2, connection_recovery_max_interval: 3, session_timers: !1 }; p.start( r, n ) } logout () { p.stop( this ) } call ( e ) { let t = this; i.a.isString( e ) ? p.make( e, t ) : t.emit( "error", { code: 1002, status: "Invalid type to call" } ) } terminate () { p.terminate( this ) } answer () { p.answer( this ) } reject () { p.reject( this ) } sendDtmf ( e ) { p.dtmf( e, this ) } hold () { p.hold( this ) } unHold () { p.unhold( this ) } mute () { p.mute( this ) } unMute () { p.unmute( this ) } } }] );